;----------------------------------- secondary RohanCitadel -------------------------------------------------------
Object RohanCampKeep

	SelectPortrait = BPRCamp_Citadel

  ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes


    DefaultModelConditionState  
      Model = RBCCenter
;                    ParticleSysBone   = glowbone01 TorchGlow
;                    ParticleSysBone   = glowbone02 TorchGlow
;                    ParticleSysBone   = glowbone03 TorchGlow
;                    ParticleSysBone   = glowbone04 TorchGlow
    End
    
	IdleAnimationState
		;BeginScript
		;	Prev = CurDrawablePrevAnimationState()
		;	if Prev == "BeingConstructed" then 
			    ; Don't play completed sound when canceling build-in-progress or when
			    ; destroyed halfway
		;	    if not CurDrawableModelcondition( "DYING" ) then 
		;			CurDrawablePlaySound("CampSoldierCompleteGeneric")
		;		end
		;	end
		;EndScript
	End

;------------Build Up States
    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED
      Model               = RBCCenter_A
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  

	AnimationState          = ACTIVELY_BEING_CONSTRUCTED
		Animation
			AnimationName	= RBCCenter_A.RBCCenter_A
			AnimationMode   = MANUAL
		End
		BeginScript
			;CurDrawableHideSubObject("FIRE02")
			CurDrawablePlaySound("GondorBarracksBeginConstruction")
			CurDrawablePlaySound("BuildingTopple")
		EndScript
	End

;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCCenter_A
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  

	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCCenter_A.RBCCenter_A
			AnimationMode = ONCE
			AnimationBlendTime = 0			
			AnimationSpeedFactorRange = 2.0 2.0 ; 300 frame anim, but need to shrink down to 5 seconds
		End
		BeginScript
			CurDrawablePlaySound("GondorBarracksBeginConstruction")
			CurDrawablePlaySound("BuildingTopple")
		EndScript
	End

    ModelConditionState   = JUST_BUILT
      Model               = RBCCenter_A
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCCenter_A.RBCCenter_A
			AnimationMode = MANUAL			
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
		BeginScript
;			CurDrawableHideSubObject("FIRE02")
		EndScript
	End

    ModelConditionState  = DAMAGED
      Model         = RBCCenter_D1  
	ParticleSysBone NONE BuildingDamaged
      ParticleSysBone dustbone01 TrebuchetImpactDebris
;                    ParticleSysBone   = glowbone01 TorchGlow
;                    ParticleSysBone   = glowbone02 TorchGlow
;                    ParticleSysBone   = glowbone03 TorchGlow
;                    ParticleSysBone   = glowbone04 TorchGlow
    End
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCCenter_D2  
      ParticleSysBone dustbone01 TrebuchetImpactDebris
      ParticleSysBone NONE SmokeBuildingMediumRubble
	
    End
    AnimationState = REALLYDAMAGED
	EnteringStateFX	= FX_BuildingReallyDamaged
    End
    
    ModelConditionState  = RUBBLE
      Model         = RBCCenter_D2  
      ParticleSysBone dustbone01 BuildingChunkBitsTrail
      ParticleSysBone NONE Explosion5
    End
    AnimationState = RUBBLE
    End

  	ModelConditionState  = POST_RUBBLE
		Model         = GBGenRubble
		ParticleSysBone NONE SmokeBuildingMediumRubble
	End
    AnimationState = POST_RUBBLE
    End
	
	ModelConditionState  = POST_COLLAPSE
		Model         = GBGenRubble
		ParticleSysBone NONE SmokeBuildingMediumRubble
	End
    AnimationState = POST_COLLAPSE
    End

  End


	; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect				= RohanCitadelSelect

	SoundOnDamaged			= BuildingLightDamageWood
	SoundOnReallyDamaged		= BuildingHeavyDamageWood

	VoiceSelectUnderConstruction	= BuildingGoodVoiceSelectUnderConstruction

	UnitSpecificSounds
		UnderConstruction		= BuildingBigConstructionLoop		; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= BuildingBigConstructionLoop		; Repaired from completely destroyed (not used???)
	End
	EvaEventDieOwner = CitadelDie

	CampnessValue = CAMPNESS_FORTRESS


	; ***DESIGN parameters ***

	DisplayName      = OBJECT:RohanCampKeep
	Side = Obsolete
	EditorSorting   = STRUCTURE
	ThreatLevel = 1.0
	BuildCost           = 1000
	BuildTime           = 30.0           ; in seconds
	CommandSet			= GenericKeepCommandSet

	ArmorSet
		Conditions        = None
		Armor             = CitadelArmor
		DamageFX          = None
	End

	; *** ENGINEERING Parameters ***  
	KindOf					= VITAL_FOR_BASE_SURVIVAL STRUCTURE SELECTABLE IMMOBILE CASTLE_KEEP MP_COUNT_FOR_VICTORY FS_FACTORY AUTO_RALLYPOINT MADE_OF_WOOD SCORE
	RadarPriority			= STRUCTURE
	KeepSelectableWhenDead	= Yes

	Body              = ActiveBody ModuleTag_02
		MaxHealth       = ROHAN_CENTRAL_CAMP_KEEP_HEALTH
	End

  Behavior = GettingBuiltBehavior ModuleTag_04
    SelfBuildingLoop = BuildingBigConstructionLoop			; Only played if we DON'T spawn a worker
	SelfRepairFromDamageLoop  = NoSound					; This doesn't cause an animation, so don't bother playing a sound
	SelfRepairFromRubbleLoop  = BuildingBigConstructionLoop
  End

  Behavior = CastleMemberBehavior ModuleTag_CMB
	BeingBuiltSound = BuildingBigConstructionLoop
  End 

  	;-----------------------------------------------
	;Used for hero revival and initial construction     
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		; nothing, but is required if we have any Object-level Upgrades!
	End
	Behavior = QueueProductionExitUpdate ModuleTag_QueuePEU
		UnitCreatePoint   = X:0.0 Y:-20.0 Z:0.0
		NaturalRallyPoint = X:28.8 Y:-80.0 Z:0.0;NaturalRallyPointX must always match GeometryMajorRadius! 
		ExitDelay = 300 ;Handles delays between units if multiple produced at a time. 
	End  
	;-----------------------------------------------

	Behavior = AutoDepositUpdate AutoDepositModuleTag
		DepositTiming			= GENERIC_KEEP_MONEY_TIME		; in milliseconds
		DepositAmount			= GENERIC_KEEP_MONEY_AMOUNT		; cash amount to deposit every DepositTiming
		InitialCaptureBonus		= 0  ; no initial bonus
	End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = KeepObjectDie ModuleTag_IWantRubble
  End
  
     Behavior                  = StructureCollapseUpdate ModuleTag_06
       MinCollapseDelay        = 000
       MaxCollapseDelay        = 000
       CollapseDamping         = .5
       MaxShudder              = 0.6
       MinBurstDelay           = 250
       MaxBurstDelay           = 800
       BigBurstFrequency       = 4
       FXList                  = INITIAL FX_StructureMediumCollapse
     End

	Behavior                  = RubbleRiseUpdate ModuleTag_07
		MinRubbleRiseDelay      = 000
		MaxRubbleRiseDelay      = 000
		;RubbleRiseDamping       = .5
		RubbleHeight            = 4.0
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
		FXList                  = INITIAL FX_StructureMediumPostCollapse		;FX_StructureMediumCollapse
	End  
  
  Geometry              = CYLINDER
  GeometryMajorRadius   = 37.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 16.0
  
  AdditionalGeometry    = CYLINDER
  GeometryMajorRadius   = 12.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 95.0
  
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:-0.489		Y:1.954		Z:133.674		Swoop
  AttackContactPoint	= X:0			Y:0			Z:0
End

;------------------------------------------------------------------------------


Object RBCampFloor

  ; *** ART Parameters ***
  Draw = W3DFloorDraw ModuleTag_01
      ModelName = RBCampFloor
      ForceToBack = Yes
  End

  ; *** AUDIO Parameters ***

	VoiceSelect		= Gui_PlotSelect


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:CampFloor
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  ArmorSet
    Conditions        = None
    Armor             = NoArmor
    DamageFX          = None
  End

  ; *** ENGINEERING Parameters ***  
  ; The STRUCTURE KindOf is needed so this object will be given to the base
  ; owner when it's unpacked and show up in the right color on the radar map.

  KindOf                = STRUCTURE IMMOBILE NO_COLLIDE UNATTACKABLE INERT 
  RadarPriority = NOT_ON_RADAR
  Body                  = ImmortalBody ModuleTag_03
    MaxHealth       = 2000.0
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
      DestructionDelay  = 1000
  End
  
  Geometry              = BOX
  GeometryMajorRadius   = 0.8
  GeometryMinorRadius   = 0.8
  GeometryHeight        = 0.8
  GeometryIsSmall       = Yes
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
End

;------------------------------------------------------------------------------


Object RBCastleFloor

  ; *** ART Parameters ***
  Draw = W3DFloorDraw ModuleTag_01
      ModelName = RBCastFloor
      ForceToBack = Yes
  End

  ; *** AUDIO Parameters ***

	;VoiceSelect		= Gui_PlotSelect


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:CastFloor
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  ArmorSet
    Conditions        = None
    Armor             = NoArmor
    DamageFX          = None
  End

  ; *** ENGINEERING Parameters ***  
  ; The STRUCTURE KindOf is needed so this object will be given to the base
  ; owner when it's unpacked and show up in the right color on the radar map.

  KindOf                = STRUCTURE IMMOBILE NO_COLLIDE UNATTACKABLE INERT 
  RadarPriority = NOT_ON_RADAR
  Body                  = ImmortalBody ModuleTag_03
    MaxHealth       = 2000.0
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
      DestructionDelay  = 1000
  End
  
  Geometry              = BOX
  GeometryMajorRadius   = 0.8
  GeometryMinorRadius   = 0.8
  GeometryHeight        = 0.8
  GeometryIsSmall       = Yes
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
End

;------------------------------------------------------------------------------


Object RBCampFence

SelectPortrait = BPRCampWall

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD  
    OkToChangeModelColor = Yes
    DefaultModelConditionState
      Model = RBCFence
    End

		ModelConditionState = WORLD_BUILDER
  			Model = RBCFenceW
  		End

	IdleAnimationState
		Animation
			AnimationName     = RBCFence.RBCFence
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCFence
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCFence.RBCFence
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCFence.RBCFence
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCFence_D1
      ParticleSysBone emberBone01 SmokeBuildingLarge
	
    End
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCFence_D2
      ParticleSysBone emberBone01 SmokeBuildingLarge
    End
    AnimationState = REALLYDAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End	
    
    ModelConditionState  = RUBBLE
      Model         = RBCFence_D3  
	  ParticleSysBone emberBone01 CatapultDestroyDebris
;      ParticleSysBone emberBone02 SmokeBuildingLarge
      ParticleSysBone emberBone03 PCTMediumDust
    End
    AnimationState = RUBBLE
		EnteringStateFX	= FX_WallWoodDie
;		EnteringStateFX	= FX_BuildingReallyDamaged
    End

  	ModelConditionState  = POST_RUBBLE
		Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
	End
	ModelConditionState  = POST_COLLAPSE
		Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
	End

  End

  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	CampnessValue = CAMPNESS_WALL

  ; ***DESIGN parameters ***
  DisplayName      = OBJECT:RBCampFence
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  ArmorSet
    Conditions        = None
    Armor             = RohanCampWallArmor
    DamageFX          = None
  End
  
  CommandSet = EmptyCommandSet

  ; *** ENGINEERING Parameters ***  
  KindOf                = STRUCTURE SELECTABLE IMMOBILE DEFENSIVE_WALL NOT_AUTOACQUIRABLE MADE_OF_WOOD
  RadarPriority = NOT_ON_RADAR
  Body                  = ActiveBody ModuleTag_03
    MaxHealth       = 2000.0
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

	Behavior                  = StructureCollapseUpdate ModuleTag_06
		MinCollapseDelay        = 000
		MaxCollapseDelay        = 000
		CollapseDamping         = .5
		MaxShudder              = 0.6
		MinBurstDelay           = 250
		MaxBurstDelay           = 800
		BigBurstFrequency       = 4
;		FXList                  = INITIAL   FX_StructureMediumCollapse
;		FXList                  = ALMOST_FINAL  FX_StructureAlmostCollapse
		DestroyObjectWhenDone	= Yes
		CollapseHeight			= 80
	End

  Behavior = CastleMemberBehavior ModuleTag_CMB
  End 
  
  Geometry              = BOX
  GeometryMajorRadius   = 26.0
  GeometryMinorRadius   = 4.0
  GeometryHeight        = 24.0
  GeometryOffset		= X:2 Y:0 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
End

;------------------------------------------------------------------------------


Object RBCampFence2

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    StaticModelLODMode = yes ; Will append M or L to the skin name depending on GameLOD  
    OkToChangeModelColor = Yes
    DefaultModelConditionState
      Model = RBCFence2
    End

		ModelConditionState = WORLD_BUILDER
  			Model = RBCFence2
  		End

	IdleAnimationState
		Animation
			AnimationName     = RBCFence2.RBCFence2
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCFence2
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCFence2.RBCFence2
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCFence2.RBCFence2
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCFence2_D1
      ParticleSysBone emberBone01 SmokeBuildingLarge
	
    End
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCFence2_D2
      ParticleSysBone emberBone01 SmokeBuildingLarge
	
    End
    AnimationState = REALLYDAMAGED
	EnteringStateFX	= FX_BuildingReallyDamaged
    End	
    
    ModelConditionState  = RUBBLE
      Model         = RBCFence2_D2  
      ParticleSysBone emberBone01 CatapultDestroyDebris
      ParticleSysBone emberBone02 SmokeBuildingLarge
      ParticleSysBone emberBone03 PCTMediumDust
    End
    AnimationState = RUBBLE
    End

  	ModelConditionState  = POST_RUBBLE
		Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
	End
	ModelConditionState  = POST_COLLAPSE
		Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
	End

  End

  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	CampnessValue = CAMPNESS_WALL

  ; ***DESIGN parameters ***
  DisplayName      = OBJECT:RBCampFence2
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  ArmorSet
    Conditions        = None
    Armor             = StructureArmor
    DamageFX          = None
  End

  ; *** ENGINEERING Parameters ***  
  KindOf                = STRUCTURE SELECTABLE IMMOBILE DEFENSIVE_WALL NOT_AUTOACQUIRABLE MADE_OF_WOOD
  RadarPriority = STRUCTURE
  Body                  = ActiveBody ModuleTag_03
    MaxHealth       = 2000.0
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
      DestructionDelay  = 5000
  End
  
  Geometry              = BOX
  GeometryMajorRadius   = 26.0
  GeometryMinorRadius   = 4.0
  GeometryHeight        = 24.0
  GeometryOffset		= X:2 Y:0 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
End


;--------------------------------------primary RohanCitadel ----------------------------------------------------
Object RohanCastleBaseKeep

	SelectPortrait = BPRohanCastle_Citadel

   ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes

	ExtraPublicBone = ARROWBONE01
	ExtraPublicBone = ARROWBONE02
	ExtraPublicBone = ARROWBONE03
	ExtraPublicBone = ARROWBONE04
	ExtraPublicBone = ARROWBONE05
	ExtraPublicBone = ARROWBONE06
	ExtraPublicBone = ARROWBONE07
	ExtraPublicBone = ARROWBONE08
	ExtraPublicBone = ARROWBONE09
	ExtraPublicBone = ARROWBONE10
	ExtraPublicBone = ARROWBONE11
	ExtraPublicBone = ARROWBONE12

    DefaultModelConditionState  
      Model = RBCastKeep
;      ParticleSysBone   = smokebone01 TorchGlow
;      ParticleSysBone   = smokebone01 TorchSmokeBlack
;      ParticleSysBone   = smokebone02 TorchGlow
;      ParticleSysBone   = smokebone02 TorchSmokeBlack
      WeaponLaunchBone	= PRIMARY ARROW_
      WeaponFireFXBone  = PRIMARY ARROW_
     End
    
	IdleAnimationState
		StateName = STATE_None
		;BeginScript
		;	Prev = CurDrawablePrevAnimationState()
		;	if Prev == "BeingConstructed" then 
			    ; Don't play completed sound when canceling build-in-progress or when
			    ; destroyed halfway
		;	    if not CurDrawableModelcondition( "DYING" ) then 
		;			CurDrawablePlaySound("CampSoldierCompleteGeneric")
		;		end
		;	end
		;EndScript
	End

;------------Build Up States
    ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED
      Model               = RBCastKeep_A
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  

	AnimationState          = ACTIVELY_BEING_CONSTRUCTED
		StateName = STATE_Constructing
		Animation
			AnimationName	= RBCastKeep_A.RBCastKeep_A
			AnimationMode   = MANUAL
		End
		BeginScript
			CurDrawablePlaySound("GondorBarracksBeginConstruction")
			CurDrawablePlaySound("BuildingTopple")
		EndScript
	End

    ModelConditionState   = DESTROYED_WHILST_BEING_CONSTRUCTED
		Model = RBCastKeep_A
		ParticleSysBone NONE Explosion3
		ParticleSysBone NONE ExplosiveMineSmoke02
    End  
	AnimationState	= DESTROYED_WHILST_BEING_CONSTRUCTED
		StateName = STATE_DetroyedConstructing
		Animation
			AnimationName		= RBCastKeep_A.RBCastKeep_A
			AnimationMode		= ONCE_BACKWARDS
			AnimationBlendTime	= 90	; 3 seconds * 30 frames
		End
		; Specifically no start last frame flag here.
		Flags = START_FRAME_FIRST
	End
	
;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastKeep_A
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  

	AnimationState		  = BASE_BUILD
		StateName = STATE_None
		Animation
			AnimationName = RBCastKeep_A.RBCastKeep_A
			AnimationMode = ONCE
			AnimationBlendTime = 0			
			AnimationSpeedFactorRange = 2.0 2.0 ; 300 frame anim, but need to shrink down to 5 seconds
		End
		BeginScript
			CurDrawablePlaySound("GondorBarracksBeginConstruction")
			CurDrawablePlaySound("BuildingTopple")
		EndScript
	End

    ModelConditionState   = JUST_BUILT
      Model               = RBCastKeep_A
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = JUST_BUILT
		StateName = STATE_None
		Animation
			AnimationName = RBCastKeep_A.RBCastKeep_A
			AnimationMode = MANUAL			
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End
	
    ModelConditionState  = DAMAGED
      Model         = RBCastKeep_D1  
	
    End
    
    AnimationState = DAMAGED
		StateName = STATE_None
		EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastKeep_D2
;      ParticleSysBone NONE furnaceSmoke
	
    End
	AnimationState = REALLYDAMAGED
		StateName = STATE_None
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastKeep_D2.RBCastKeep_D2
			AnimationMode		=	ONCE
		End
		EnteringStateFX	= FX_BuildingReallyDamaged
    End


	;-------RUBBLE--------------------------------------------------------------------------------
	TransitionState = TRANS_U_IntoRubble
		Animation = D3
			AnimationName		= RBCastKeep_D3.RBCastKeep_D3
			AnimationMode		= ONCE
			AnimationBlendTime = 0
		End
		ParticleSysBone NONE Explosion3
		ParticleSysBone NONE ExplosiveMineSmoke02
	End
    ModelConditionState  = RUBBLE
		Model         = RBCastKeep_D3
    End
    AnimationState = RUBBLE
		Flags = START_FRAME_LAST
		StateName = STATE_Rubble
		Animation				=	Death
			AnimationName		=	RBCastKeep_D3.RBCastKeep_D3
			AnimationMode		=	ONCE
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_None"
			then
				; Only play the rubble anim if we havn't come from another rubble.
				CurDrawableSetTransitionAnimState("TRANS_U_IntoRubble")
			end
		EndScript
    End      

  End


	; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect				= RohanCitadelSelect

	SoundOnDamaged			= BuildingLightDamageWood
	SoundOnReallyDamaged		= BuildingHeavyDamageWood

	VoiceSelectUnderConstruction	= BuildingGoodVoiceSelectUnderConstruction

	UnitSpecificSounds
		UnderConstruction		= BuildingBigConstructionLoop		; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= BuildingBigConstructionLoop		; Repaired from completely destroyed (not used???)
	End

	EvaEventDieOwner = CitadelDie
	CampnessValue = CAMPNESS_FORTRESS

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
 		AnimationSound = Sound:BuildingHeavyDamageWood	Animation:RBCastKeep_D3.RBCastKeep_D3	Frames:0
 		AnimationSound = Sound:BuildingSink			Animation:RBCastKeep_D3.RBCastKeep_D3	Frames:25
 		AnimationSound = Sound:BuildingLightDamageWood	Animation:RBCastKeep_D3.RBCastKeep_D3	Frames:105
	End


	; ***DESIGN parameters ***

	DisplayName      = OBJECT:RohanCastleBaseKeep
	Side = Obsolete
	EditorSorting   = STRUCTURE
	ThreatLevel = 1.0
	BuildCost           = 1000
	BuildTime           = 30.0           ; in seconds
	CommandSet			= RohanCastleBaseKeepCommandSet

	ArmorSet
		Conditions        = None
		Armor             = CitadelArmor
		DamageFX          = RohanWallDamageFX
	End

  ; *** ENGINEERING Parameters ***  
  KindOf					= VITAL_FOR_BASE_SURVIVAL STRUCTURE SELECTABLE IMMOBILE SCORE CASTLE_KEEP MP_COUNT_FOR_VICTORY FS_FACTORY MADE_OF_WOOD CAN_ATTACK AUTO_RALLYPOINT	;  GARRISONABLE_UNTIL_DESTROYED GARRISON
  RadarPriority				= STRUCTURE
  KeepSelectableWhenDead	= Yes
  
  Body              = ActiveBody ModuleTag_02
    MaxHealth       = 4000.0
  End

  Behavior = GettingBuiltBehavior ModuleTag_04
    SelfBuildingLoop = BuildingBigConstructionLoop				; Only played if we DON'T spawn a worker
	SelfRepairFromDamageLoop  = NoSound         				; This doesn't cause an animation, so don't bother playing a sound
	SelfRepairFromRubbleLoop  = BuildingBigConstructionLoop
  End

  Behavior = CastleMemberBehavior ModuleTag_CMB
	BeingBuiltSound = BuildingBigConstructionLoop
  End 

  	;-----------------------------------------------
	;Used for hero revival and initial construction     
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		; nothing, but is required if we have any Object-level Upgrades!
	End
	Behavior = QueueProductionExitUpdate ModuleTag_QueuePEU
		UnitCreatePoint   = X:0.0 Y:-20.0 Z:0.0
		NaturalRallyPoint = X:28.8 Y:-80.0 Z:0.0;NaturalRallyPointX must always match GeometryMajorRadius! 
		ExitDelay = 300 ;Handles delays between units if multiple produced at a time. 
	End  
	;-----------------------------------------------

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = KeepObjectDie ModuleTag_IWantRubble
  End
 
  
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 6500
;  End


;  Behavior                  = StructureCollapseUpdate ModuleTag_06
;    MinCollapseDelay        = 5000
;    MaxCollapseDelay        = 5000
;    CollapseDamping         = .5
;    MaxShudder              = 0.6
;    MinBurstDelay           = 250
;    MaxBurstDelay           = 800
;    BigBurstFrequency       = 4
;    FXList                  = INITIAL   FX_StructureMediumCollapse
;  End
  
  
  
  
	Behavior       = EvacuateDamage ModuleTag_evacuateDamage
		WeaponThatCausesEvacuation  = MordorCatapultHumanHeads
	End

;	Behavior = HordeGarrisonContain ModuleTag_hordeGarrison
;		ObjectStatusOfContained	= UNSELECTABLE CAN_ATTACK
;		ContainMax              = 4
;		DamagePercentToUnits    = 0%
;		PassengerFilter			= ANY +INFANTRY +HORDE -CAVALRY -SUMMONED -WildSpiderling -WildSpiderlingHorde
;		AllowEnemiesInside      = Yes
;		AllowNeutralInside      = Yes
;		NumberOfExitPaths       = 1 ; Defaults to 1.  Set 0 to not use ExitStart/ExitEnd, set higher than 1 to use ExitStart01-nn/ExitEnd01-nn
;		PassengerBonePrefix     = PassengerBone:ARROWBONE KindOf:INFANTRY
;		EntryOffset				= X:0.0 Y:-45.0 Z:0.0
;		ExitOffset				= X:0.0 Y:-45.0 Z:0.0
;		
;		;PassengersTestCollisionHeight = 80
;		;Slots                         = 1
;		;EnterSound                     = GarrisonEnter
;		;ExitSound                      = GarrisonExit
;		;ExitDelay               = 250
;		;GoAggressiveOnExit      = Yes ; AI Will tell people to set their mood to Aggressive on exiting
;		;ForceOrientationContainer = No  ; otherwise contained units can't orient themselves towards their targets...
;	End 

	Behavior = AutoDepositUpdate AutoDepositModuleTag
		DepositTiming			= GENERIC_KEEP_MONEY_TIME   ; in milliseconds
		DepositAmount			= GENERIC_KEEP_MONEY_AMOUNT   ; cash amount to deposit every DepositTiming
		InitialCaptureBonus		= 0  ; no initial bonus
	End


  Behavior                  = BuildingBehavior BuildingModuleTag
    NightWindowName         = WINDOW_N01
  ;  FireWindowName          = WINDOW_F01
  ;  GlowWindowName			= WINDOW_G01
  End
  
  Geometry				= BOX
  GeometryMajorRadius   = 21.0
  GeometryMinorRadius   = 41.0
  GeometryHeight        = 51.0
  
  AdditionalGeometry    = CYLINDER
  GeometryMajorRadius   = 57.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 7.0
  
  AdditionalGeometry    = BOX
  GeometryMajorRadius   = 12.0
  GeometryMinorRadius   = 12.0
  GeometryHeight        = 120.0
  GeometryOffset		= X:-1 Y:2 Z:0
  
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  
;  AttackContactPoint	= X:-1 Y:2 Z:117
;  AttackContactPoint	= X:-1 Y:2 Z:0

	GeometryContactPoint	= X:-1.538		Y:2.559		Z:149.812			Swoop
	GeometryContactPoint	= X:-1.538		Y:2.559		Z:0

End

;------------------------------------------------------------------------------------------
;Rohan Building Foundation -- the area where faction rohan buildings can be built on
Object RohanBuildingFoundation
 
	SelectPortrait = BPRCamp_Plot
  ; *** ART Parameters ***

  
	Draw = W3DScriptedModelDraw ModuleTag_Draw2
	    DefaultModelConditionState
			Model = OBBFoundationX
		End
		ModelConditionState = WORLD_BUILDER
  			Model = RBSizeTemplate
  		End
		
	End
   Draw = W3DFloorDraw ModuleTag_Draw
      ModelName = RBFoundationX
  End
 
  ;PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanBuildingFoundation
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  CommandSet = RohanFoundationCommandSet

  ; *** AUDIO Parameters ***

  VoiceSelect = Gui_PlotSelect


  ; *** ENGINEERING Parameters ***

  RadarPriority       = STRUCTURE
  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY NO_COLLIDE DO_NOT_CLASSIFY
 
  Behavior            = FoundationAIUpdate ModuleTag_foundationAI
  End

  Behavior = CastleMemberBehavior ModuleTag_CMB
  End 

  Body                = ImmortalBody ModuleTag_05
    MaxHealth         = 15000.0
  End
 
  Geometry              = BOX
  GeometryMajorRadius   = 24.0
  GeometryMinorRadius   = 24.0
  GeometryHeight        = 0.8
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  BuildCompletion		= PLACED_BY_PLAYER
End

;------------------------------------------------------------------------------



Object RohanCastleBend

  
  SelectPortrait = BRCastleWall
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    
    WallBoundsMesh = P1
    		
    DefaultModelConditionState
      Model = RBCastBend
    End


		ModelConditionState = WORLD_BUILDER
  			Model = RBCastBendW
  		End

	IdleAnimationState
		Animation
			AnimationName     = RBCastBend.RBCastBend
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastBend
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastBend.RBCastBend
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastBend.RBCastBend
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastBend_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastBend_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastBend_D2.RBCastBend_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastBend_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastBend_D3.RBCastBend_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
		;EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End


  End

  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged			= BuildingLightDamageStone
	SoundOnReallyDamaged		= BuildingHeavyDamageStone

	CampnessValue = CAMPNESS_WALL

  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleWall
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT
	BuildTime = CASTLE_WALL_REBUILD_TIME
	BuildCost = CASTLE_WALL_REBUILD_COST

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  

  ; *** ENGINEERING Parameters ***  
	KindOf					= STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
	RadarPriority			= NOT_ON_RADAR
	KeepSelectableWhenDead	= Yes
	CommandSet				= GenericSelfRepairCommandSet

  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End

 	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
	End
  
  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End
    
  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

    Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
    End 
      
 	Behavior = FireWeaponWhenDeadBehavior FireDeadTag2
		DeathTypes		= ALL
		StartsActive	= Yes
		DeathWeapon		= StandardWallDeath
		DelayTime		= 1					; Required so this happens even when constructing.
	End	
      
  Geometry              = BOX
  GeometryMajorRadius   = 55.0
  GeometryMinorRadius   = 55.0
  GeometryHeight        = 45.0

  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:3 Y:48 Z:27.5
  AttackContactPoint	= X:3 Y:3 Z:27.5
  AttackContactPoint	= X:48 Y:3 Z:27.5
End

;------------------------------------------------------------------------------

Object RohanCastleCorn
  
  SelectPortrait = BRCastleWall
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    
    WallBoundsMesh = P1
    		
    DefaultModelConditionState
      Model = RBCastCorn
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastCorn.RBCastCorn
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastCorn
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastCorn.RBCastCorn
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastCorn.RBCastCorn
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastCorn_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastCorn_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastCorn_D2.RBCastCorn_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastCorn_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastCorn_D3.RBCastCorn_D3
			AnimationMode		=	ONCE
		End
	EnteringStateFX = FX_WallDie
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End


  End

  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged			= BuildingLightDamageStone
	SoundOnReallyDamaged		= BuildingHeavyDamageStone

	CampnessValue = CAMPNESS_WALL

  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleWall
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT
	BuildTime = CASTLE_WALL_REBUILD_TIME
	BuildCost = CASTLE_WALL_REBUILD_COST

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  

  ; *** ENGINEERING Parameters ***  
	KindOf					= STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
	RadarPriority			= NOT_ON_RADAR
	KeepSelectableWhenDead	= Yes
	CommandSet				= GenericSelfRepairCommandSet

  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End

 	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End
  
  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End
    
  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

    Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
    End 
      
 	Behavior = FireWeaponWhenDeadBehavior FireDeadTag2
		DeathTypes		= ALL
		StartsActive	= Yes
		DeathWeapon		= StandardWallDeath
		DelayTime		= 1					; Required so this happens even when constructing.
	End	
      
  Geometry              = BOX
  GeometryMajorRadius   = 43.0
  GeometryMinorRadius   = 43.0
  GeometryHeight        = 55.0
  GeometryOffset		= X:7 Y:7 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:3 Y:48 Z:27.5
  AttackContactPoint	= X:3 Y:3 Z:27.5
  AttackContactPoint	= X:48 Y:3 Z:27.5
End

;------------------------------------------------------------------------------


Object RohanCastleTowr

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    DefaultModelConditionState
      Model = RBCastTowr
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastTowr.RBCastTowr
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastTowr
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastTowr.RBCastTowr
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastTowr.RBCastTowr
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
		ModelConditionState  = DAMAGED
			Model         = RBCastTOWR_D1  
		End
	    
		AnimationState = DAMAGED
			EnteringStateFX	= FX_BuildingDamaged
		End

	ModelConditionState  = REALLYDAMAGED
		Model         = RBCastTOWR_D2
	End
	AnimationState = REALLYDAMAGED
       		Animation				=	ReallyDamagedanimation
				AnimationName		=	 RBCastTOWR_D2.RBCastTOWR_D2
				AnimationMode		=	ONCE
   		End
		EnteringStateFX	= FX_BuildingReallyDamaged
	End

	ModelConditionState  = RUBBLE
		Model         = RBCastTOWR_D3
	End
	    
	AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastTOWR_D3.RBCastTOWR_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
	;        EnteringStateFX = FX_MinWallATransitionRubble
	End      

	ModelConditionState  = POST_RUBBLE
		Model         = None
	End

	ModelConditionState  = POST_COLLAPSE
		Model         = None
	End

  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

	CampnessValue = CAMPNESS_DEFENSIVE_TOWER

  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleTower
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  VisionRange         = 400.0          ; Shroud clearing distance
  ShroudClearingRange = 400

  ArmorSet
    Conditions        = None
    Armor             = StructureArmor
    DamageFX          = None
  End

  ; *** ENGINEERING Parameters ***  
  KindOf                = STRUCTURE SELECTABLE IMMOBILE MADE_OF_WOOD
  RadarPriority = STRUCTURE
  Body                  = ActiveBody ModuleTag_03
    MaxHealth       = 3000.0
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End
    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End  
  
  Geometry              = BOX
  GeometryMajorRadius   = 22.0
  GeometryMinorRadius   = 24.0
  GeometryHeight        = 119.0
  GeometryOffset		= X:-4 Y:-39 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
;  AttackContactPoint	= X:-4 Y:-39 Z:116
;  AttackContactPoint	= X:-4 Y:-39 Z:0

	GeometryContactPoint	= X:-20.675		Y:-58.257	Z:108.263	Swoop
	GeometryContactPoint	= X:-20.675		Y:-58.257	Z:0
End

;------------------------------------------------------------------------------


Object RohanCastleAngl01

SelectPortrait = BRCastleWall

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
        WallBoundsMesh = P1
    DefaultModelConditionState
      Model = RBCastAngl01
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastAngl01.RBCastAngl01
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastAngl01
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastAngl01.RBCastAngl01
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastAngl01.RBCastAngl01
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    

    ModelConditionState  = DAMAGED
      Model         = RBCastAngl01_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastAngl01_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastAngl01_D2.RBCastAngl01_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastAngl01_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastAngl01_D3.RBCastAngl01_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
;        EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End

  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
	CampnessValue = CAMPNESS_WALL


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleWall
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT
	BuildTime = CASTLE_WALL_REBUILD_TIME
	BuildCost = CASTLE_WALL_REBUILD_COST

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
	; *** ENGINEERING Parameters ***  
	KindOf					= STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
	RadarPriority			= NOT_ON_RADAR
	KeepSelectableWhenDead	= Yes
	CommandSet				= GenericSelfRepairCommandSet
  
  
  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End
  
  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

   Behavior = KeepObjectDie ModuleTag_IWantRubble
   End
   
   Behavior = CastleMemberBehavior ModuleTag_CMB
	    CountsForEvaCastleBreached = Yes
   End 

 	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End


  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

 	Behavior = FireWeaponWhenDeadBehavior FireDeadTag2
		DeathTypes		= ALL
		StartsActive	= Yes
		DeathWeapon		= StandardWallDeath
		DelayTime		= 1					; Required so this happens even when constructing.
	End	
  
  Geometry              = CYLINDER
  GeometryMajorRadius   = 13.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 57.0
  GeometryOffset		= X:-40 Y:-20 Z:0
  
  AdditionalGeometry	= CYLINDER
  GeometryMajorRadius   = 35.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 57.0
  GeometryOffset		= X:-15 Y:18 Z:0
  
  AdditionalGeometry	= CYLINDER
  GeometryMajorRadius   = 35.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 57.0
  GeometryOffset		= X:17 Y:52 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:27 Y:62 Z:28.5
  AttackContactPoint	= X:-40 Y:-20 Z:28.5
End

;------------------------------------------------------------------------------


Object RohanCastleAngl02

SelectPortrait = BRCastleWall
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_02
    OkToChangeModelColor = Yes
        WallBoundsMesh = P1
    DefaultModelConditionState
      Model = RBCastAngl02
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastAngl02.RBCastAngl02
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastAngl02
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastAngl02.RBCastAngl02
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastAngl02.RBCastAngl02
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastAngl02_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastAngl02_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastAngl02_D2.RBCastAngl02_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastAngl02_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastAngl02_D3.RBCastAngl02_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
;        EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End

  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
	CampnessValue = CAMPNESS_WALL


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleWall
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT
	BuildTime = CASTLE_WALL_REBUILD_TIME
	BuildCost = CASTLE_WALL_REBUILD_COST

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
	; *** ENGINEERING Parameters ***  
	KindOf					= STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
	RadarPriority			= NOT_ON_RADAR
	KeepSelectableWhenDead	= Yes
	CommandSet				= GenericSelfRepairCommandSet

  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End
  
  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

   Behavior = KeepObjectDie ModuleTag_IWantRubble
   End  

	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End
   
  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

   Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
   End 

 	Behavior = FireWeaponWhenDeadBehavior FireDeadTag2
		DeathTypes		= ALL
		StartsActive	= Yes
		DeathWeapon		= StandardWallDeath
		DelayTime		= 1					; Required so this happens even when constructing.
	End	
  
  Geometry              = CYLINDER
  GeometryMajorRadius   = 13.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 57.0
  GeometryOffset		= X:20 Y:40 Z:0
  
  AdditionalGeometry	= CYLINDER
  GeometryMajorRadius   = 35.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 57.0
  GeometryOffset		= X:-15 Y:22 Z:0
  
  AdditionalGeometry	= CYLINDER
  GeometryMajorRadius   = 35.0
  GeometryMinorRadius   = 0
  GeometryHeight        = 57.0
  GeometryOffset		= X:-47 Y:-12 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:-57 Y:-22 Z:28.5
  AttackContactPoint	= X:20 Y:40 Z:28.5
End

;------------------------------------------------------------------------------


Object RohanCastleGateR


SelectPortrait = BRCastleWall
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    WallBoundsMesh = P02
    DefaultModelConditionState
      Model = RBCastGateR
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastGateR.RBCastGateR
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastGateR
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastGateR.RBCastGateR
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastGateR.RBCastGateR
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastGateR_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastGateR_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastGateR_D2.RBCastGateR_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastGateR_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastGateR_D3.RBCastGateR_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
;        EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End
  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
	CampnessValue = CAMPNESS_WALL


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleGate
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
  ; *** ENGINEERING Parameters ***  
	KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
	RadarPriority = NOT_ON_RADAR
	BuildTime = CASTLE_WALL_REBUILD_TIME
	BuildCost = CASTLE_WALL_REBUILD_COST
	KeepSelectableWhenDead	= Yes
	CommandSet				= GenericSelfRepairCommandSet


  Body                  = ActiveBody ModuleTag_03
    MaxHealth       = ROHAN_CASTLE_WALL_HEALTH
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

   Behavior = KeepObjectDie ModuleTag_IWantRubble
   End
 
 	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End
  
  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End
  
  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 
  
  Geometry              = BOX
  GeometryMajorRadius   = 61.0
  GeometryMinorRadius   = 44.0
  GeometryHeight        = 56.0
  GeometryOffset		= X:39.0 Y:-7.0 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:92 Y:8 Z:28
  AttackContactPoint	= X:3 Y:8 Z:28
  AttackContactPoint	= X:3 Y:-32 Z:28
End

;------------------------------------------------------------------------------


Object RohanCastleGateRTower

SelectPortrait = BRCastleWall

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    WallBoundsMesh = P01
    RampMesh1 = Ramp01
    DefaultModelConditionState
      Model = RBCastGateRT
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastGateRT.RBCastGateRT
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastGateRT
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastGateRT.RBCastGateRT
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastGateRT.RBCastGateRT
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastGateRT_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastGateRT_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastGateRT_D2.RBCastGateRT_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged	
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastGateRT_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastGateRT_D3.RBCastGateRT_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
;        EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End

  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
	CampnessValue = CAMPNESS_WALL


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleGate
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
  KeepSelectableWhenDead	= Yes
  CommandSet				= GenericSelfRepairCommandSet

  ; *** ENGINEERING Parameters ***  
  KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
  RadarPriority = NOT_ON_RADAR

  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

 	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End
  
    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End
    
    
    Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = No  
    End   
  
  Geometry              = BOX
  GeometryMajorRadius   = 29.0
  GeometryMinorRadius   = 27.0
  GeometryHeight        = 79.0
  GeometryOffset		= X:6 Y:-73 Z:0
  
  AdditionalGeometry    = BOX
  GeometryMajorRadius   = 29.0
  GeometryMinorRadius   = 20.0
  GeometryHeight        = -30.0
  GeometryOffset		= X:6 Y:-29 Z:55

  GeometryFrontAngle    = -90.0    
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:6 Y:-73 Z:76
  AttackContactPoint	= X:6 Y:-73 Z:0
End


;------------------------------------------------------------------------------


Object RohanCastleGateL

SelectPortrait = BRCastleWall

  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    WallBoundsMesh = P01
    DefaultModelConditionState
      Model = RBCastGateL
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastGateL.RBCastGateL
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastGateL
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastGateL.RBCastGateL
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastGateL.RBCastGateL
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastGateL_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastGateL_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	 RBCastGateL_D2.RBCastGateL_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged	
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastGateL_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastGateL_D3.RBCastGateL_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
;        EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End

  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
	CampnessValue = CAMPNESS_WALL


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleGate
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
  CommandSet = EmptyCommandSet

  ; *** ENGINEERING Parameters ***  
	KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
	RadarPriority = NOT_ON_RADAR
	BuildTime = CASTLE_WALL_REBUILD_TIME
	BuildCost = CASTLE_WALL_REBUILD_COST
	KeepSelectableWhenDead	= Yes
	CommandSet				= GenericSelfRepairCommandSet

  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End
    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End
 
  	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End
 
  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 

  Geometry              = BOX
  GeometryMajorRadius   = 61.0
  GeometryMinorRadius   = 44.0
  GeometryHeight        = 56.0
  GeometryOffset		= X:-40.0 Y:-7.0 Z:0
  
  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:-95 Y:8 Z:28
  AttackContactPoint	= X:-5 Y:8 Z:28
  AttackContactPoint	= X:-5 Y:-46 Z:28
End

;------------------------------------------------------------------------------


Object RohanCastleGateLTower


SelectPortrait = BRCastleWall
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_01
    OkToChangeModelColor = Yes
    WallBoundsMesh = P02
    RampMesh1 = Ramp01
    DefaultModelConditionState
      Model = RBCastGateLT
    End

	IdleAnimationState
		Animation
			AnimationName     = RBCastGateLT.RBCastGateLT
			AnimationMode     = MANUAL
			AnimationBlendTime = 0
        End
        Flags = START_FRAME_LAST
	End    

    ;------------Build Up States
    ModelConditionState   = BASE_BUILD
      Model               = RBCastGateLT
;      ParticleSysBone	  = NONE BuildingDoughnutCloud
      ParticleSysBone     = NONE BuildingContructDust
    End  
	AnimationState		  = BASE_BUILD
		Animation
			AnimationName = RBCastGateLT.RBCastGateLT
			AnimationMode = ONCE
			AnimationSpeedFactorRange = 2.0 2.5 ; keep range wide to avoid lockstep anims
		End
	End

	AnimationState		  = JUST_BUILT
		Animation
			AnimationName = RBCastGateLT.RBCastGateLT
			AnimationMode = MANUAL
			AnimationBlendTime = 0
		End
        Flags = START_FRAME_FIRST
	End    
	
    ModelConditionState  = DAMAGED
      Model         = RBCastGateLT_D1  
    End
    
    AnimationState = DAMAGED
	EnteringStateFX	= FX_BuildingDamaged
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBCastGateLT_D2
    End
	AnimationState = REALLYDAMAGED
       	Animation				=	ReallyDamagedanimation
			AnimationName		=	RBCastGateLT_D2.RBCastGateLT_D2
			AnimationMode		=	ONCE
   		End
	EnteringStateFX	= FX_BuildingReallyDamaged
    End

    ModelConditionState  = RUBBLE
      Model         = RBCastGateLT_D3
    End
    
    AnimationState = RUBBLE
		Animation				=	Death
			AnimationName		=	RBCastGateLT_D3.RBCastGateLT_D3
			AnimationMode		=	ONCE
		End
		EnteringStateFX = FX_WallDie
;        EnteringStateFX = FX_RohanWallRubble
    End      

    ModelConditionState  = POST_RUBBLE
		Model         = None
    End

    ModelConditionState  = POST_COLLAPSE
		 Model         = None
    End

  End


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

	CampnessValue = CAMPNESS_WALL

  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleGate
  Side = Obsolete
  EditorSorting = STRUCTURE
; Browser = CINEMATICS UNIT

  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
  KeepSelectableWhenDead	= Yes
  CommandSet				= GenericSelfRepairCommandSet

  ; *** ENGINEERING Parameters ***  
  KindOf                = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL MADE_OF_WOOD SELECTABLE NOT_AUTOACQUIRABLE
  RadarPriority = NOT_ON_RADAR

  Body                = StructureBody ModuleTag_03
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
;  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
;      DestructionDelay  = 5000
;  End

 	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
		SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = CASTLE_WALL_REBUILD_TIME
	End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End

    Behavior = KeepObjectDie ModuleTag_IWantRubble
    End  

    Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = No   ; Towers don't actually give access to interior of castle
    End 
  

  Geometry              = BOX
  GeometryMajorRadius   = 29.0
  GeometryMinorRadius   = 27.0
  GeometryHeight        = 79.0
  GeometryOffset		= X:-5 Y:-73 Z:0
  
  AdditionalGeometry    = BOX
  GeometryMajorRadius   = 29.0
  GeometryMinorRadius   = 20.0
  GeometryHeight        = -30.0
  GeometryOffset		= X:-5 Y:-29 Z:55

  GeometryIsSmall       = No
  ;GeometryRotationAnchorOffset = X:1037.871 Y:0
  Shadow                = SHADOW_VOLUME
  
  AttackContactPoint	= X:-5 Y:-73 Z:76
  AttackContactPoint	= X:-5 Y:-73 Z:0
End

;------------------------------------------------------------------------------

;Rohan Buildable Wall Foundation -- the area where faction rohan walls can be built on
Object RohanWallFoundation
 
  ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    
    DefaultModelConditionState
      Model = GBFoundationL
    End
    
	ModelConditionState = WORLD_BUILDER
  	  Model = RBWalls
	End
  End
  
  ;PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWallFoundation
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  CommandSet = RohanWallFoundationCommandSet


  ; *** AUDIO Parameters ***

  VoiceSelect	= Gui_PlotSelect


  ; *** ENGINEERING Parameters ***

  RadarPriority       = STRUCTURE
  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY NO_COLLIDE DO_NOT_CLASSIFY
 
  Behavior            = FoundationAIUpdate ModuleTag_foundationAI
  End

  Behavior = CastleMemberBehavior ModuleTag_CMB
  End 

  Body                = StructureBody ModuleTag_05
    MaxHealth         = 15000.0
  End
 
  Geometry              = BOX
  GeometryMajorRadius   = 24.0
  GeometryMinorRadius   = 16.0
  GeometryHeight        = 0.8
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  BuildCompletion		= PLACED_BY_PLAYER
End

;------------------------------------------------------------------------------


Object RohanCastleKeep

	SelectPortrait = BPRCamp
 
  ; *** ART Parameters ***
  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBGoldHall
;      ParticleSysBone   = glowbone01 TorchSmokeBlack
;      ParticleSysBone   = glowbone01 TorchGlow
;      ParticleSysBone   = glowbone02 TorchSmokeBlack
;      ParticleSysBone   = glowbone02 TorchGlow
    End

     ;--damaged building
      ModelConditionState  = DESTROYED_FRONT
      Model         = RBGoldHall_D
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingSmall
		ParticleSysBone FireSmall03 FireBuildingSmall
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireMedium01 FireBuildingMedium
		ParticleSysBone FireMedium02 FireBuildingMedium
     	ParticleSysBone FireLarge01 FireBuildingLarge
     	ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = DESTROYED_FRONT
      BeginScript
        CurDrawableHideSubObject("RBGoldHall_01")
      EndScript
    End
    
        ModelConditionState  = DESTROYED_RIGHT
      Model         = RBGoldHall_D
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingSmall
		ParticleSysBone FireSmall03 FireBuildingSmall
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireMedium01 FireBuildingMedium
		ParticleSysBone FireMedium02 FireBuildingMedium
		ParticleSysBone FireLarge01 FireBuildingLarge
		ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = DESTROYED_RIGHT
      BeginScript
        CurDrawableHideSubObject("RBGoldHall_02")
      EndScript
    End
    

    ModelConditionState  = DESTROYED_BACK
      Model         = RBGoldHall_D
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingSmall
		ParticleSysBone FireSmall03 FireBuildingSmall
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireMedium01 FireBuildingMedium
		ParticleSysBone FireMedium02 FireBuildingMedium
		ParticleSysBone FireLarge01 FireBuildingLarge
		ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End

    AnimationState = DESTROYED_BACK
      BeginScript
        CurDrawableHideSubObject("RBGoldHall_03")
      EndScript
    End

	ModelConditionState  = DESTROYED_LEFT
      Model         = RBGoldHall_D
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingSmall
		ParticleSysBone FireSmall03 FireBuildingSmall
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireMedium01 FireBuildingMedium
		ParticleSysBone FireMedium02 FireBuildingMedium
		ParticleSysBone FireLarge01 FireBuildingLarge
		ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End
    
    AnimationState = DESTROYED_LEFT
      BeginScript
        CurDrawableHideSubObject("RBGoldHall_04")
      EndScript
    End
    
    
    ModelConditionState  = DAMAGED
      Model         = RBGoldHall_D
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingSmall
		ParticleSysBone FireSmall03 FireBuildingSmall
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireMedium01 FireBuildingMedium
		ParticleSysBone FireMedium02 FireBuildingMedium
		ParticleSysBone FireLarge01 FireBuildingLarge
		ParticleSysBone SmokeLarge01 SmokeBuildingLarge
	
    End

    ModelConditionState  = REALLYDAMAGED
      Model         = RBGoldHall_D
		ParticleSysBone FireSmall01 FireBuildingSmall
		ParticleSysBone FireSmall02 FireBuildingSmall
		ParticleSysBone FireSmall03 FireBuildingSmall
		ParticleSysBone FireSmall04 FireBuildingSmall
		ParticleSysBone FireMedium01 FireBuildingMedium
		ParticleSysBone FireMedium02 FireBuildingMedium
		ParticleSysBone FireLarge01 FireBuildingLarge
		ParticleSysBone SmokeLarge01 SmokeBuildingLarge
	
    End

    ModelConditionState  = RUBBLE
      Model         = RBGoldHall_D
      ParticleSysBone SmokeLarge01 SmokeBuildingLarge
    End
    
    AnimationState = RUBBLE
      BeginScript
        CurDrawableHideSubObject("RBGoldHall_01")
        CurDrawableHideSubObject("RBGoldHall_02")
        CurDrawableHideSubObject("RBGoldHall_03")
        CurDrawableHideSubObject("RBGoldHall_04")
      EndScript
    End

    ModelConditionState  = POST_RUBBLE
      Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
    End

    ModelConditionState  = POST_COLLAPSE
      Model         = None
		ParticleSysBone NONE SmokeBuildingMediumRubble
    End  
  End
  
 
	; ***DESIGN parameters ***
	DisplayName         = OBJECT:RohanGoldenHall
	Side                = Obsolete
	EditorSorting       = STRUCTURE
	ThreatLevel = 1.0
	CommandSet			= GenericKeepCommandSet
 
	BuildCost           = 1000
	BuildTime           = 90.0           ; in seconds
	VisionRange         = 160.0          ; Shroud clearing distance
	ShroudClearingRange = 160

	ArmorSet
		Armor     = CitadelArmor
	End


	; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect				= RohanCitadelSelect

	SoundOnDamaged			= BuildingLightDamageWood
	SoundOnReallyDamaged		= BuildingHeavyDamageWood

	VoiceSelectUnderConstruction	= BuildingGoodVoiceSelectUnderConstruction

	UnitSpecificSounds
		UnderConstruction		= BuildingConstructionLoop  ; Built first time
		; UnderRepairFromDamage	= NoSound					; Repaired No animation on the building, so don't bother playing sound
		UnderRepairFromRubble	= BuildingConstructionLoop	; Repaired from completely destroyed (not used???)
	End 
	EvaEventDieOwner = CitadelDie

	CampnessValue = CAMPNESS_FORTRESS

	; *** ENGINEERING Parameters ***

	RadarPriority       = STRUCTURE
	KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION CASTLE_KEEP MP_COUNT_FOR_VICTORY FS_FACTORY AUTO_RALLYPOINT MADE_OF_WOOD
	 
	Behavior            = GettingBuiltBehavior ModuleTag_04
      SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
	  SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
	  SelfRepairFromRubbleLoop  = BuildingConstructionLoop
	End

	Behavior = CastleMemberBehavior ModuleTag_CMB
	End 

  	;-----------------------------------------------
	;Used for hero revival and initial construction     
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		; nothing, but is required if we have any Object-level Upgrades!
	End
	Behavior = QueueProductionExitUpdate ModuleTag_QueuePEU
		UnitCreatePoint   = X:0.0 Y:-20.0 Z:0.0
		NaturalRallyPoint = X:28.8 Y:-80.0 Z:0.0;NaturalRallyPointX must always match GeometryMajorRadius! 
		ExitDelay = 300 ;Handles delays between units if multiple produced at a time. 
	End  
	;-----------------------------------------------

	Body                = StructureBody ModuleTag_05
		MaxHealth         = ROHAN_CENTRAL_GOLDENHALL_HEALTH
	    
		DamageCreationList = OCL_BuildingDamageList01 CATAPULT_ROCK
	    
		DamageCreationList = OCL_RBGoldHall_Chunk1 CATAPULT_ROCK FRONT_DESTROYED
		DamageCreationList = OCL_RBGoldHall_Chunk2 CATAPULT_ROCK RIGHT_DESTROYED
		DamageCreationList = OCL_RBGoldHall_Chunk3 CATAPULT_ROCK BACK_DESTROYED
		DamageCreationList = OCL_RBGoldHall_Chunk4 CATAPULT_ROCK LEFT_DESTROYED
	End
 
; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  
  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
      DestructionDelay  = 5000
  End

  Behavior                  = StructureCollapseUpdate ModuleTag_06
    MinCollapseDelay        = 000
    MaxCollapseDelay        = 000
    CollapseDamping         = .5
    MaxShudder              = 0.6
    MinBurstDelay           = 250
    MaxBurstDelay           = 800
    BigBurstFrequency       = 4
    FXList                  = INITIAL   FX_StructureMediumCollapse

  End

  
	Geometry				= BOX
	GeometryMajorRadius		= 27 
	GeometryMinorRadius		= 45 
	GeometryHeight			= 47 
	GeometryOffset			= X:0 Y:0 Z:0
  
	AdditionalGeometry		= BOX
	GeometryMajorRadius		= 60.0
	GeometryMinorRadius		= 20.0
	GeometryHeight			= 30
	
	AdditionalGeometry		= BOX
	GeometryMajorRadius		= 42.0
	GeometryMinorRadius		= 53.0
	GeometryHeight			= 7.0
	GeometryOffset			= X:0 Y:-6 Z:0
	
	AdditionalGeometry		= BOX
	GeometryMajorRadius		= 16.0
	GeometryMinorRadius		= 16.0
	GeometryHeight			= 100
	
	AdditionalGeometry		= BOX
	GeometryMajorRadius		= 7.0
	GeometryMinorRadius		= 7.0
	GeometryHeight			= 155
	
	GeometryIsSmall			= No
	Shadow					= SHADOW_VOLUME
	BuildCompletion			= PLACED_BY_PLAYER
End

;------------------------------------------------------------------------------
;Rohan Inner Wall
Object RohanInnerWall
 
  ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWalls
    End
  End
  
  PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWall
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160
;  ArmorSet
;    Conditions        = None
;    Armor             = StructureArmor
;    DamageFX          = StructureDamageFXNoShake
;  End


  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

;  VoiceSelect         = NuclearReactorSelect
 
;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
	CampnessValue = CAMPNESS_WALL

  ; *** ENGINEERING Parameters ***

  RadarPriority       = STRUCTURE
  KindOf              = PRELOAD STRUCTURE SELECTABLE IMMOBILE SCORE NEED_BASE_FOUNDATION MADE_OF_WOOD
 
  Behavior            = GettingBuiltBehavior GetBuiltBehaviorTag
    WorkerName		  = RohanWorker
  End

  Behavior = CastleMemberBehavior ModuleTag_CMB
  End 

  Body                = StructureBody ModuleTag_05
    MaxHealth         = 1500.0
  End

  Behavior            = DestroyDie ModuleTag_07
    ;nothing
  End

;  Behavior           = CreateObjectDie ModuleTag_08
;    CreationList     = OCL_SmallStructureDebris
;  End
 
;  Behavior = ProductionUpdate ModuleTag_10
;    ; nothing, but is required if we have any Object-level Upgrades!
;  End
 
;  Behavior = FlammableUpdate ModuleTag_14
;    AflameDuration = 5000         ; If I catch fire, I'll burn for this long...
;    AflameDamageAmount = 5       ; taking this much damage...
;    AflameDamageDelay = 500       ; this often.
;  End
 
;  Behavior = TransitionDamageFX ModuleTag_15
;    ;-------------DESIGNED FOR SMALL SIZED FACTION BUILDING TRANSITIONS-------------------
;    DamagedParticleSystem1       = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke
;    ;---------------------------------------------------------------------------------------
;    ReallyDamagedParticleSystem1 = Bone:None RandomBone:No PSys:StructureTransitionSmallSmoke
;    ReallyDamagedParticleSystem2 = Bone:None RandomBone:No PSys:StructureTransitionSmallExplosion
;    ReallyDamagedParticleSystem3 = Bone:None RandomBone:No PSys:StructureTransitionSmallShockwave
;  End
 
;  Behavior             = FXListDie ModuleTag_16
;    DeathFX       = FX_BuildingDie
;  End
 
  Geometry              = BOX
  GeometryMajorRadius   = 28.0
  GeometryMinorRadius   = 20.0
  GeometryHeight        = 24.0
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  BuildCompletion     = PLACED_BY_PLAYER
End

;------------------------------------------------------------------------------
;Rohan Wall
Object RohanWall
 
  ; *** ART Parameters ***
    SelectPortrait = BRCastleWall
;  ButtonImage            = SNReactor
  ;day

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWalls
    End
        
    WallBoundsMesh = wall1
        
  End
  
  PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWall
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160


  ArmorSet
    Armor = StructureArmor
  End
; For Testing Purposes


  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

;  VoiceSelect         = NuclearReactorSelect
 
;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
 
	CampnessValue = CAMPNESS_WALL

  ; *** ENGINEERING Parameters ***
 
  RadarPriority       = STRUCTURE
  KindOf              = PRELOAD STRUCTURE IMMOBILE SCORE WALK_ON_TOP_OF_WALL CHUNK_VENDOR NOT_AUTOACQUIRABLE MADE_OF_WOOD
 
  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 
   
  Behavior = SiegeDockingBehavior ModuleTag_SiegeDocking
  End
     
  Body                = StructureBody ModuleTag_05
    MaxHealth         = 1500.0
    
    GrabObject = EntThrownBuildingRock
	GrabFX = FX_WallGrab
	GrabDamage = 490
	GrabOffset = X:16 Y:0
  End

  Behavior            = DestroyDie ModuleTag_07
    ;nothing
  End
 
  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	

  Geometry              = BOX
  GeometryMajorRadius   = 50.0
  GeometryMinorRadius   = 35.0
  GeometryHeight        = 60.0
  
  GeometryContactPoint =	X:-50			Y:-40				Z:0 Grab
  GeometryContactPoint =	X:0				Y:-40				Z:40 Grab
  GeometryContactPoint =	X:50			Y:-40				Z:0 Grab
  GeometryContactPoint =	X:-50			Y:40				Z:0 Grab
  GeometryContactPoint =	X:0				Y:40				Z:40 Grab
  GeometryContactPoint =	X:50			Y:40				Z:0 Grab
  
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  BuildCompletion     = PLACED_BY_PLAYER
End

;------------------------------------------------------------------------------------------
Object RohanCastleDoor

SelectPortrait = BPRohanCastleGate

  ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes

    DefaultModelConditionState  
      Model = RBCASTDOOR
    End

	ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED 
		Model             = RBCASTDOOR_A
		ParticleSysBone   = DUSTBONE BuildingContructDust
	End
	AnimationState        = ACTIVELY_BEING_CONSTRUCTED 
		StateName				= STATE_None
			Animation           = RBCASTDOOR_A
				AnimationName   = RBCASTDOOR_A.RBCASTDOOR_A
				AnimationMode   = MANUAL
			End
		Flags					= START_FRAME_FIRST
    End

    ModelConditionState   = DESTROYED_WHILST_BEING_CONSTRUCTED
		Model			  = RBCASTDOOR_A
		ParticleSysBone   = DUSTBONE BuildingContructDust
    End  
	AnimationState	= DESTROYED_WHILST_BEING_CONSTRUCTED
		StateName		= STATE_DetroyedConstructing
		EnteringStateFX	= FX_GondorCastleGateDestroy
		Animation
			AnimationName		= RBCASTDOOR_A.RBCASTDOOR_A
			AnimationMode		= ONCE_BACKWARDS
			AnimationBlendTime	= 90	; 3 seconds * 30 frames
		End
		; Specifically no start last frame flag here.
		Flags = START_FRAME_FIRST
	End

	ModelConditionState  = RUBBLE DOOR_1_OPENING
		Model         = RBCASTDOOR_D4  
	End
	TransitionState = TRANS_IntoRubble4
		Animation = D3
			AnimationName		= RBCASTDOOR_D4.RBCASTDOOR_D4
			AnimationMode		= ONCE
			AnimationBlendTime = 0
		End
		EnteringStateFX	= FX_GondorCastleGateDestroy
	End
    AnimationState = RUBBLE DOOR_1_OPENING
		Flags = START_FRAME_LAST
		StateName = STATE_Rubble
		Animation				=	Death
			AnimationName		=	RBCASTDOOR_D4.RBCASTDOOR_D4
			AnimationMode		=	ONCE
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_None" or Prev == "STATE_Open" or Prev == "STATE_Closed" or Prev == "TRANS_Closed_To_Open" or Prev == "TRANS_Open_To_Closed"
			then
				; Only play the rubble anim if we havn't come from another rubble.
				CurDrawableSetTransitionAnimState("TRANS_IntoRubble4")
			end
		EndScript
    End      

	ModelConditionState  = RUBBLE DOOR_1_CLOSING
		Model         = RBCASTDOOR_D3
	End
	TransitionState = TRANS_IntoRubble3
		Animation = D4
			AnimationName		= RBCASTDOOR_D3.RBCASTDOOR_D3
			AnimationMode		= ONCE
			AnimationBlendTime = 0
		End
		EnteringStateFX	= FX_GondorCastleGateDestroy
	End
    AnimationState = RUBBLE DOOR_1_CLOSING
		Flags = START_FRAME_LAST
		StateName = STATE_Rubble
		Animation				=	Death
			AnimationName		=	RBCASTDOOR_D3.RBCASTDOOR_D3
			AnimationMode		=	ONCE
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_None" or Prev == "STATE_Open" or Prev == "STATE_Closed" or Prev == "TRANS_Closed_To_Open" or Prev == "TRANS_Open_To_Closed"
			then
				; Only play the rubble anim if we havn't come from another rubble.
				CurDrawableSetTransitionAnimState("TRANS_IntoRubble3")
			end
		EndScript
    End      

;    ModelConditionState  = RUBBLE DOOR_1_OPENING
;      Model         = RBCASTDOOR_D4  
;    End
;	AnimationState = RUBBLE DOOR_1_OPENING
;		Animation = Open 
;			AnimationName	=	RBCASTDOOR_D4.RBCASTDOOR_D4
;			AnimationMode	=	ONCE 
;		End
 ;   End
       
;	ModelConditionState  = RUBBLE
;		Model         = RBCASTDOOR_D3 
;		ParticleSysBone NONE CatapultDestroyDebris
;		ParticleSysBone NONE PCTMediumDust 
 ;   End
 ;	AnimationState = RUBBLE 
;		Animation = Open 
;			AnimationName	=	RBCASTDOOR_D3.RBCASTDOOR_D3
;			AnimationMode	=	ONCE 
;		End
 ;   End
    
	AnimationState = DOOR_1_OPENING
		StateName = STATE_Open   
		Animation = Open 
			AnimationName	=	RBCASTDOOR.RBCASTDOOR
			AnimationMode	=	ONCE 
			AnimationBlendTime = 0
		End
		Flags = START_FRAME_LAST
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Closed" then CurDrawableSetTransitionAnimState("TRANS_Closed_To_Open") end
		EndScript
    End
    TransitionState = TRANS_Closed_To_Open
		Animation = Open 
			AnimationName	=	RBCASTDOOR.RBCASTDOOR
			AnimationMode	=	ONCE 
		End
    End
        
	AnimationState = DOOR_1_CLOSING 
		StateName = STATE_Closed 
		Animation = Close 
			AnimationName	=	RBCASTDOOR.RBCASTDOOR
			AnimationMode	=	ONCE_BACKWARDS 
			AnimationBlendTime = 0
		End
		Flags = START_FRAME_FIRST
		BeginScript
			
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Open" then CurDrawableSetTransitionAnimState("TRANS_Open_To_Closed") end
		EndScript
    End
    TransitionState = TRANS_Open_To_Closed
		Animation = Open 
			AnimationName	=	RBCASTDOOR.RBCASTDOOR
			AnimationMode	=	ONCE_BACKWARDS 
		End
		Flags = START_FRAME_LAST
    End

  End

  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	VoiceSelect		= GateSelect

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
	CampnessValue = CAMPNESS_WALL


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleDoor
  Side = Obsolete
  EditorSorting   = STRUCTURE
  ThreatLevel = 1.0
	BuildTime           = 180.0           ; in seconds
        BuildCost           = 1000

  VisionRange         = 400.0          ; Shroud clearing distance

  ArmorSet
    Conditions        = None
    Armor             = CastleGateArmor
    DamageFX          = GateDamageFX
  End

	CommandSet = CastleGateCommandSet


	; *** ENGINEERING Parameters ***  
	KindOf					= STRUCTURE IMMOBILE SELECTABLE BLOCKING_GATE MADE_OF_WOOD
	RadarPriority			= NOT_ON_RADAR
	KeepSelectableWhenDead	= Yes


	Body                  = ActiveBody ModuleTag_02
		MaxHealth       = 3000.0
	End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = KeepObjectDie ModuleTag_IWantRubble
  End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound: MinisTirithGateDie Animation:GBMgatedoorSKL.GBMgatedoorA3 Frames: 1 
	End

	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
	    SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
		RebuildTimeSeconds = 120 ;30
	End

	Behavior = TransitionDamageFX ModleTag_hideBustedDoors
		PristineShowSubObject		RBCASTDRR RBCASTDRL
		PristineHideSubObject		RBCASTDRR_D1 RBCASTDRR_D2 RBCASTDRL_D1 RBCASTDRL_D2
		DamagedShowSubObject		RBCASTDRR_D1 RBCASTDRL_D1
		DamagedHideSubObject		RBCASTDRR_D2 RBCASTDRL_D2 RBCASTDRR RBCASTDRL
		ReallyDamagedShowSubObject	RBCASTDRR_D2 RBCASTDRL_D2
		ReallyDamagedHideSubObject  RBCASTDRR_D1  RBCASTDRL_D1 RBCASTDRR RBCASTDRL
        DamagedFXList1 = Loc: X:0 Y:0 Z:0			FXList:FX_BasicSevereScreenShake
 	    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0		FXList:FX_BasicSevereScreenShake
 	    RubbleFXList1 = Loc: X:0 Y:0 Z:0			FXList:FX_HelmsDeepGateRubble
	End

	Behavior = GateOpenAndCloseBehavior ModuleTag_GATE
		ResetTimeInMilliseconds = 12200 ;important! this must be longer than the gates animation, ir it will twitch
		OpenByDefault = Yes
		PercentOpenForPathing = 50
		SoundOpeningGateLoop = GateOpenStart
		SoundClosingGateLoop = GateCloseStart
		SoundFinishedOpeningGate = GateOpenEnd
		SoundFinishedClosingGate = GateCloseEnd
		TimeBeforePlayingOpenSound = 9500
		TimeBeforePlayingClosedSound = 9500
	End

    Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
    End 

	Geometry              = BOX
	GeometryMajorRadius   = 16.0
	GeometryMinorRadius   = 72.0
	GeometryHeight        = 59.0
	GeometryName          = Closed
	GeometryIsSmall       = No
	
	
	AdditionalGeometry    = BOX
	GeometryMajorRadius   = 28.0
	GeometryMinorRadius   = 7.0
	GeometryHeight        = 59.0	
	GeometryOffset		  = X:18 Y:70 Z:0
	GeometryName          = OpenLeft
	
	AdditionalGeometry    = BOX
	GeometryMajorRadius   = 28.0
	GeometryMinorRadius   = 7.0
	GeometryHeight        = 59.0	
	GeometryOffset		  = X:18 Y:-70 Z:0
	GeometryName          = OpenRight
	
	GeometryContactPoint = X:36		Y:-72	Z:0 Ram
	GeometryContactPoint = X:18		Y:-72	Z:59
	GeometryContactPoint = X:0		Y:-72	Z:0
	GeometryContactPoint = X:0		Y:-36	Z:59
	GeometryContactPoint = X:0		Y:0		Z:0 Ram
	GeometryContactPoint = X:0		Y:36	Z:59
	GeometryContactPoint = X:0		Y:72	Z:0
	GeometryContactPoint = X:18		Y:72	Z:59
	GeometryContactPoint = X:36		Y:72	Z:0 Ram

	Shadow                = SHADOW_VOLUME
End

;------------------------------------------------------------------------------------------
Object RohanEdorasDoor

SelectPortrait = BPRohanCastleGate

  ; *** ART Parameters ***

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes

    DefaultModelConditionState  
      Model = RBEdorDoor
    End

	ModelConditionState   = ACTIVELY_BEING_CONSTRUCTED 
		Model             = RBEdorDoor_A
		ParticleSysBone   = DUSTBONE BuildingContructDust
	End
	AnimationState        = ACTIVELY_BEING_CONSTRUCTED 
		StateName				= STATE_None
			Animation           = RBEdorDoor_A
				AnimationName   = RBEdorDoor_A.RBEdorDoor_A
				AnimationMode   = MANUAL
			End
		Flags					= START_FRAME_FIRST
    End

    ModelConditionState   = DESTROYED_WHILST_BEING_CONSTRUCTED
		Model			  = RBEdorDoor_A
		ParticleSysBone   = DUSTBONE BuildingContructDust
    End  
	AnimationState	= DESTROYED_WHILST_BEING_CONSTRUCTED
		StateName		= STATE_DetroyedConstructing
		EnteringStateFX	= FX_GondorCastleGateDestroy
		Animation
			AnimationName		= RBEdorDoor_A.RBEdorDoor_A
			AnimationMode		= ONCE_BACKWARDS
			AnimationBlendTime	= 90	; 3 seconds * 30 frames
		End
		; Specifically no start last frame flag here.
		Flags = START_FRAME_FIRST
	End

	ModelConditionState  = RUBBLE DOOR_1_OPENING
		Model         = RBEdorDoor_D4  
	End
	TransitionState = TRANS_IntoRubble4
		Animation = D3
			AnimationName		= RBEdorDoor_D4.RBEdorDoor_D4
			AnimationMode		= ONCE
			AnimationBlendTime = 0
		End
		EnteringStateFX	= FX_GondorCastleGateDestroy
	End
    AnimationState = RUBBLE DOOR_1_OPENING
		Flags = START_FRAME_LAST
		StateName = STATE_Rubble
		Animation				=	Death
			AnimationName		=	RBEdorDoor_D4.RBEdorDoor_D4
			AnimationMode		=	ONCE
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_None" or Prev == "STATE_Open" or Prev == "STATE_Closed" or Prev == "TRANS_Closed_To_Open" or Prev == "TRANS_Open_To_Closed"
			then
				; Only play the rubble anim if we havn't come from another rubble.
				CurDrawableSetTransitionAnimState("TRANS_IntoRubble4")
			end
		EndScript
    End      

	ModelConditionState  = RUBBLE DOOR_1_CLOSING
		Model         = RBEdorDoor_D3
	End
	TransitionState = TRANS_IntoRubble3
		Animation = D4
			AnimationName		= RBEdorDoor_D3.RBEdorDoor_D3
			AnimationMode		= ONCE
			AnimationBlendTime = 0
		End
		EnteringStateFX	= FX_GondorCastleGateDestroy
	End
    AnimationState = RUBBLE DOOR_1_CLOSING
		Flags = START_FRAME_LAST
		StateName = STATE_Rubble
		Animation				=	Death
			AnimationName		=	RBEdorDoor_D3.RBEdorDoor_D3
			AnimationMode		=	ONCE
		End
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_None" or Prev == "STATE_Open" or Prev == "STATE_Closed" or Prev == "TRANS_Closed_To_Open" or Prev == "TRANS_Open_To_Closed"
			then
				; Only play the rubble anim if we havn't come from another rubble.
				CurDrawableSetTransitionAnimState("TRANS_IntoRubble3")
			end
		EndScript
    End      

;    ModelConditionState  = RUBBLE DOOR_1_OPENING
;      Model         = RBEdorDoor_D4  
;    End
;	AnimationState = RUBBLE DOOR_1_OPENING
;		Animation = Open 
;			AnimationName	=	RBEdorDoor_D4.RBEdorDoor_D4
;			AnimationMode	=	ONCE 
;		End
 ;   End
       
;	ModelConditionState  = RUBBLE
;		Model         = RBEdorDoor_D3 
;		ParticleSysBone NONE CatapultDestroyDebris
;		ParticleSysBone NONE PCTMediumDust 
 ;   End
 ;	AnimationState = RUBBLE 
;		Animation = Open 
;			AnimationName	=	RBEdorDoor_D3.RBEdorDoor_D3
;			AnimationMode	=	ONCE 
;		End
 ;   End
    
	AnimationState = DOOR_1_OPENING
		StateName = STATE_Open   
		Animation = Open 
			AnimationName	=	RBEdorDoor.RBEdorDoor
			AnimationMode	=	ONCE 
			AnimationBlendTime = 0
		End
		Flags = START_FRAME_LAST
		BeginScript
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Closed" then CurDrawableSetTransitionAnimState("TRANS_Closed_To_Open") end
		EndScript
    End
    TransitionState = TRANS_Closed_To_Open
		Animation = Open 
			AnimationName	=	RBEdorDoor.RBEdorDoor
			AnimationMode	=	ONCE 
		End
    End
        
	AnimationState = DOOR_1_CLOSING 
		StateName = STATE_Closed 
		Animation = Close 
			AnimationName	=	RBEdorDoor.RBEdorDoor
			AnimationMode	=	ONCE_BACKWARDS 
			AnimationBlendTime = 0
		End
		Flags = START_FRAME_FIRST
		BeginScript
			
			Prev = CurDrawablePrevAnimationState()
			if Prev == "STATE_Open" then CurDrawableSetTransitionAnimState("TRANS_Open_To_Closed") end
		EndScript
    End
    TransitionState = TRANS_Open_To_Closed
		Animation = Open 
			AnimationName	=	RBEdorDoor.RBEdorDoor
			AnimationMode	=	ONCE_BACKWARDS 
		End
		Flags = START_FRAME_LAST
    End

  End

  ; *** AUDIO Parameters ***
;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"

	VoiceSelect		= GateSelect

	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

	CampnessValue = CAMPNESS_WALL

  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanCastleDoor
  Side = Obsolete
  EditorSorting   = STRUCTURE
  ThreatLevel = 1.0
	BuildTime           = 180.0           ; in seconds
        BuildCost           = 1000

  VisionRange         = 400.0          ; Shroud clearing distance

  ArmorSet
    Conditions        = None
    Armor             = CastleGateArmor
    DamageFX          = GateDamageFX
  End

	CommandSet = CastleGateCommandSet


	; *** ENGINEERING Parameters ***  
	KindOf					= STRUCTURE IMMOBILE SELECTABLE BLOCKING_GATE MADE_OF_WOOD
	RadarPriority			= NOT_ON_RADAR
	KeepSelectableWhenDead	= Yes


	Body                  = ActiveBody ModuleTag_02
		MaxHealth       = 3000.0
	End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = KeepObjectDie ModuleTag_IWantRubble
  End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound: MinisTirithGateDie Animation:GBMgatedoorSKL.GBMgatedoorA3 Frames: 1 
	End

	Behavior = GettingBuiltBehavior ModuleTag_GettingBuilt
	    SelfBuildingLoop = BuildingConstructionLoop ; Only played if we DON'T spawn a worker
		SelfRepairFromDamageLoop  = NoSound         ; This doesn't cause an animation, so don't bother playing a sound
		SelfRepairFromRubbleLoop  = BuildingConstructionLoop
		SpawnTimer = -1.0 ; Negative means no 'autoheal'
	End

	Behavior = TransitionDamageFX ModleTag_hideBustedDoors
		PristineShowSubObject		RBCASTDRR RBCASTDRL
		PristineHideSubObject		RBCASTDRR_D1 RBCASTDRR_D2 RBCASTDRL_D1 RBCASTDRL_D2
		DamagedShowSubObject		RBCASTDRR_D1 RBCASTDRL_D1
		DamagedHideSubObject		RBCASTDRR_D2 RBCASTDRL_D2 RBCASTDRR RBCASTDRL
		ReallyDamagedShowSubObject	RBCASTDRR_D2 RBCASTDRL_D2
		ReallyDamagedHideSubObject  RBCASTDRR_D1  RBCASTDRL_D1 RBCASTDRR RBCASTDRL
        DamagedFXList1 = Loc: X:0 Y:0 Z:0			FXList:FX_BasicSevereScreenShake
 	    ReallyDamagedFXList1 = Loc: X:0 Y:0 Z:0		FXList:FX_BasicSevereScreenShake
 	    RubbleFXList1 = Loc: X:0 Y:0 Z:0			FXList:FX_HelmsDeepGateRubble
	End

	Behavior = GateOpenAndCloseBehavior ModuleTag_GATE
		ResetTimeInMilliseconds = 12200 ;important! this must be longer than the gates animation, ir it will twitch
		OpenByDefault = Yes
		PercentOpenForPathing = 50
		SoundOpeningGateLoop = GateOpenStart
		SoundClosingGateLoop = GateCloseStart
		SoundFinishedOpeningGate = GateOpenEnd
		SoundFinishedClosingGate = GateCloseEnd
		TimeBeforePlayingOpenSound = 9500
		TimeBeforePlayingClosedSound = 9500
	End

    Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
    End 

	Geometry              = BOX
	GeometryMajorRadius   = 12.0
	GeometryMinorRadius   = 112.5
	GeometryHeight        = 70.0
	GeometryOffset		  = X:20.75 Y:0 Z:0
	GeometryName          = Closed
	GeometryIsSmall       = No
	
	
	AdditionalGeometry    = BOX
	GeometryMajorRadius   = 56.0
	GeometryMinorRadius   = 12.0
	GeometryHeight        = 70.0	
	GeometryOffset		  = X:72 Y:-110 Z:0
	GeometryName          = OpenLeft
	
	AdditionalGeometry    = BOX
	GeometryMajorRadius   = 56.0
	GeometryMinorRadius   = 12.0
	GeometryHeight        = 70.0	
	GeometryOffset		  = X:72 Y:110 Z:0
	GeometryName          = OpenRight
	
	GeometryContactPoint = X:36		Y:-72	Z:0 Ram
	GeometryContactPoint = X:18		Y:-72	Z:59
	GeometryContactPoint = X:0		Y:-72	Z:0
	GeometryContactPoint = X:0		Y:-36	Z:59
	GeometryContactPoint = X:0		Y:0		Z:0 Ram
	GeometryContactPoint = X:0		Y:36	Z:59
	GeometryContactPoint = X:0		Y:72	Z:0
	GeometryContactPoint = X:18		Y:72	Z:59
	GeometryContactPoint = X:36		Y:72	Z:0 Ram

	Shadow                = SHADOW_VOLUME
End

;------------------------------------------------------------------------------
;Rohan Gate
Object RohanGate
 
  ; *** ART Parameters ***
;  SelectPortrait         = SNReactor_L
;  ButtonImage            = SNReactor
  ;day

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBGate
    End
; remove this so the units can walk under the gate, but not on top of it    
;    WallBoundsMesh = wall1
    RampMesh1 = P1   
    RampMesh2 = P2 
	RaisedWallMesh = P3        
  End
 
  PlacementViewAngle  = 0
 

  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanGate
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 30.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Armor = StructureArmor
  End

  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

;  VoiceSelect         = NuclearReactorSelect
;  SoundOnDamaged        = BuildingDamagedStateLight
;  SoundOnReallyDamaged  = BuildingDestroy
 
;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
	CampnessValue = CAMPNESS_WALL


  ; *** ENGINEERING Parameters ***
  RadarPriority       = STRUCTURE
  KindOf              = STRUCTURE IMMOBILE CHUNK_VENDOR NOT_AUTOACQUIRABLE WALK_ON_TOP_OF_WALL MADE_OF_WOOD

  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 

  Body                = StructureBody ModuleTag_05
    MaxHealth         = 2500.0
    
    GrabObject = EntThrownBuildingRock
	GrabFX = FX_WallGrab
	GrabDamage = 490
	GrabOffset = X:16 Y:0
  End

  Behavior            = DestroyDie ModuleTag_07
    ;nothing
  End



  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	


  Geometry              = BOX
  GeometryMajorRadius   = 80.0
  GeometryMinorRadius   = 25.0
  GeometryHeight        = 40.0
  GeometryOffset		= X:0 Y:0 Z:72
    
  AdditionalGeometry    = BOX
  GeometryMajorRadius   = 30.0
  GeometryMinorRadius   = 70.0
  GeometryHeight        = 80	
  GeometryOffset		= X:100 Y:-10 Z:0

  AdditionalGeometry    = BOX
  GeometryMajorRadius   = 30.0
  GeometryMinorRadius   = 70.0
  GeometryHeight        = 80	
  GeometryOffset		= X:-100 Y:-10 Z:0

  
  GeometryContactPoint =	X:75		Y:-60				Z:0 
  GeometryContactPoint =	X:105		Y:-78				Z:0 Grab
  GeometryContactPoint =	X:75		Y:0					Z:60
  GeometryContactPoint =	X:-75		Y:0					Z:60
  GeometryContactPoint =	X:-105		Y:-78				Z:0 Grab
  GeometryContactPoint =	X:-75		Y:-60				Z:0 
  
  
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
End


;------------------------------------------------------------------------------
;Rohan Wall Junction I
Object RohanWallJntI
 
  ; *** ART Parameters ***
SelectPortrait = BRCastleWall
;  ButtonImage            = SNReactor
  ;day


  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWallJntI
    End
    
    WallBoundsMesh = wall1
    
  End


  
  PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWall
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Armor = StructureArmor
  End
  
  CommandSet = EmptyCommandSet


  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood
 

;  VoiceSelect         = NuclearReactorSelect
 
;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
	CampnessValue = CAMPNESS_WALL


  ; *** ENGINEERING Parameters ***

  RadarPriority       = STRUCTURE
  KindOf              = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR NOT_AUTOACQUIRABLE MADE_OF_WOOD

  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 

  Body                = StructureBody ModuleTag_05
    MaxHealth         = 3000.0
    
    GrabObject = EntThrownBuildingRock
	GrabFX = FX_WallGrab
	GrabDamage = 490
	GrabOffset = X:16 Y:0
  End

  Behavior            = DestroyDie ModuleTag_07
    ;nothing
  End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	

  Geometry              = BOX
  GeometryMajorRadius   = 45.6
  GeometryMinorRadius   = 37.6
  GeometryHeight        = 20.8
  GeometryIsSmall       = No
  
  GeometryContactPoint =	X:0			Y:0				Z:18 
  GeometryContactPoint =	X:0			Y:0				Z:0 
  GeometryContactPoint =	X:45		Y:0				Z:0 Grab
  GeometryContactPoint =	X:-45		Y:0				Z:0 Grab
  GeometryContactPoint =	X:0			Y:45			Z:0 Grab
  GeometryContactPoint =	X:0		Y:-45				Z:0 Grab
  
  Shadow                = SHADOW_VOLUME
  BuildCompletion     = PLACED_BY_PLAYER
End



;------------------------------------------------------------------------------
;Rohan Wall Junction 0
Object RohanWallJntO
 
  ; *** ART Parameters ***
SelectPortrait = BRCastleWall
;  ButtonImage            = SNReactor
  ;day

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWallJntO
    End
    
    WallBoundsMesh = wall1
        
  End


  
  PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWall
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Armor = StructureArmor
  End
  
  CommandSet = EmptyCommandSet


  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood


;  VoiceSelect         = NuclearReactorSelect
 
;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
	CampnessValue = CAMPNESS_WALL


  ; *** ENGINEERING Parameters ***

  RadarPriority       = STRUCTURE
  KindOf              = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE MADE_OF_WOOD
 
  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 

  Body                = StructureBody ModuleTag_05
    MaxHealth         = 3000.0
    
    GrabObject = EntThrownBuildingRock
	GrabFX = FX_WallGrab
	GrabDamage = 490
	GrabOffset = X:16 Y:0
  End

  Behavior            = DestroyDie ModuleTag_07
    ;nothing
  End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	

  Geometry              = BOX
  GeometryMajorRadius   = 35.0
  GeometryMinorRadius   = 35.0
  GeometryHeight        = 60.0
  
  GeometryContactPoint =	X:0			Y:0				Z:50 
  GeometryContactPoint =	X:0			Y:0				Z:0 
  GeometryContactPoint =	X:45		Y:0				Z:0 Grab
  GeometryContactPoint =	X:-45		Y:0				Z:0 Grab
  GeometryContactPoint =	X:0			Y:45			Z:0 Grab
  GeometryContactPoint =	X:0		Y:-45				Z:0 Grab
  GeometryIsSmall       = No
  
  Shadow                = SHADOW_VOLUME
  BuildCompletion     = PLACED_BY_PLAYER
End


;------------------------------------------------------------------------------
;Rohan Wall Elevator
Object RohanWallElev
 
  ; *** ART Parameters ***
SelectPortrait = BRCastleWall
;  ButtonImage            = SNReactor
  ;day

  Draw = W3DScriptedModelDraw ModuleTag_01

		ExtraPublicBone = Elev01
		ExtraPublicBone = Elev02
		ExtraPublicBone = Elev03
;		ExtraPublicBone = Elev04
;		ExtraPublicBone = Elev05

    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWallElev
    End
    
    WallBoundsMesh = P1
        
  End
 


  
  PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWall
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions = None
    Armor = StructureArmor
  End
  
  CommandSet = EmptyCommandSet


  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood


;  VoiceSelect         = NuclearReactorSelect

;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
	CampnessValue = CAMPNESS_WALL


  ; *** ENGINEERING Parameters ***

	KindOf				= STRUCTURE SELECTABLE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR NOT_AUTOACQUIRABLE MADE_OF_WOOD
	RadarPriority		= STRUCTURE
	
	Body				= ActiveBody ModuleTag_02
		MaxHealth		= 3000.0
		
		GrabObject = EntThrownBuildingRock
		GrabFX = FX_WallGrab
		GrabDamage = 490
		GrabOffset = X:16 Y:0
	End
	
	Behavior = DynamicPortalBehaviour Portal
		GenerateNow		= Yes
		ObjectFilter	= ANY +INFANTRY -MONSTER -MACHINE -CAVALRY -ARMY_OF_DEAD		
		BonePrefix		= Elev
		NumberOfBones	= 3
		
		WayPoint		= Index:0	Type:Walk		; 0
		WayPoint		= Index:1	Type:Walk		; 1
		WayPoint		= Index:2	Type:Walk		; 2
		WayPoint		= Index:3	Type:Walk		; 3	top right
		WayPoint		= Index:2	Type:Walk		; 4
		WayPoint		= Index:1	Type:Walk		; 5

;		WayPoint		= Index:0	Type:Walk		; 6
;		WayPoint		= Index:1	Type:Walk		; 7
;		WayPoint		= Index:2	Type:Walk		; 8
;		WayPoint		= Index:4	Type:Walk		; 9 top left
;		WayPoint		= Index:2	Type:Walk		; 10
;		WayPoint		= Index:1	Type:Walk		; 11

		Link			= From:0 Via:5 To:2	; up, to centre
		Link			= From:2 Via:1 To:0	; down, from centre

;		Link			= From:0 Via:4 Via:5 To:3	; up, to right
;		Link			= From:3 Via:1 Via:2 To:0	; down, from right

;		Link			= From:6 Via:10 Via:11 To:9	; up, to left
;		Link			= From:9 Via:7 Via:8 To:6	; down, from left
	End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	

	Geometry						= BOX
	GeometryMajorRadius				= 50.0
	GeometryMinorRadius				= 44.0
	GeometryHeight					= 76.0
	GeometryIsSmall					= No
	
	GeometryContactPoint =	X:0			Y:0				Z:70 
	GeometryContactPoint =	X:0			Y:0				Z:0 
	GeometryContactPoint =	X:45		Y:0				Z:0 Grab
	GeometryContactPoint =	X:-45		Y:0				Z:0 Grab
	GeometryContactPoint =	X:0			Y:55			Z:0 Grab
	GeometryContactPoint =	X:0		Y:-45				Z:0 Grab
  
	Shadow							= SHADOW_VOLUME
End

;------------------------------------------------------------------------------
;Rohan Wall Angl15
Object RohanWallAngl15
 
  ; *** ART Parameters ***
SelectPortrait = BRCastleWall
;  ButtonImage            = SNReactor
  ;day

  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    DefaultModelConditionState
      Model = RBWalls15
    End
    
    WallBoundsMesh = P1
        
  End


  
  PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanWall
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  ArmorSet
    Conditions        = None
    Armor             = RohanCastleWall
    DamageFX          = RohanWallDamageFX
  End
  
  CommandSet = EmptyCommandSet


; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood


;  VoiceSelect         = NuclearReactorSelect
 
;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End

 	CampnessValue = CAMPNESS_WALL

  ; *** ENGINEERING Parameters ***

  RadarPriority = NOT_ON_RADAR
  KindOf              = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE MADE_OF_WOOD
 
  Behavior = CastleMemberBehavior ModuleTag_CMB
		CountsForEvaCastleBreached = Yes
  End 

  Body                = StructureBody ModuleTag_05
    MaxHealth         = ROHAN_CASTLE_WALL_HEALTH
  End

  Behavior            = DestroyDie ModuleTag_07
    ;nothing
  End

  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	

  Geometry              = BOX
  GeometryMajorRadius   = 35.0
  GeometryMinorRadius   = 35.0
  GeometryHeight        = 60.0
	
  GeometryContactPoint =	X:0			Y:0				Z:18 
  GeometryContactPoint =	X:0			Y:0				Z:0 
  GeometryContactPoint =	X:0			Y:-45				Z:0 Grab
  GeometryContactPoint =	X:0			Y:45				Z:0 Grab
  	
	
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  BuildCompletion     = PLACED_BY_PLAYER
End

;------------------------------------------------------------------------------
Object RohanHelmsDeepKeep

	SelectPortrait = BPRHelmsDeep

	
  ; *** ART Parameters ***
;  Draw = W3DModelDraw ModuleTag_01
;    OkToChangeModelColor = Yes
;  
;    ConditionState = NONE
;      Model = GBFSTower
;    End
;    ExtraPublicBone = Ramp01
;    ExtraPublicBone = Ramp02
;    ExtraPublicBone = Ramp03
;    WallBoundsMesh = P1
;    EmbedPortal = ramp Ramp
;  End
  
  Draw = W3DScriptedModelDraw ModuleTag_Draw
    OkToChangeModelColor  = Yes
    UseStandardModelNames = Yes
    ExtraPublicBone = Ramp01
    ExtraPublicBone = Ramp02
    ExtraPublicBone = Ramp03
    WallBoundsMesh  = P1
    ;;;;EmbedPortal = ramp Ramp  ;;; not yet supported in W3DScriptedModelDraw 
    DefaultModelConditionState
      Model = GBFSTower
    End
  End


  ; *** AUDIO Parameters ***

;	#include "..\..\..\Includes\StandardBuildingEvaEvents.inc"
	SoundOnDamaged		= BuildingLightDamageWood
	SoundOnReallyDamaged	= BuildingHeavyDamageWood

;  UnitSpecificSounds
;  UnderConstruction     = UnderConstructionLoop
;  End
	CampnessValue = CAMPNESS_FORTRESS


  ; ***DESIGN parameters ***

  DisplayName      = OBJECT:RohanHelmsDeepKeep
  Side = Obsolete
  EditorSorting   = STRUCTURE
  ThreatLevel = 1.0

  ArmorSet
    Conditions        = None
    Armor             = NoArmor
    DamageFX          = None
  End

  ; *** ENGINEERING Parameters ***  
  KindOf            = STRUCTURE IMMOBILE WALK_ON_TOP_OF_WALL CHUNK_VENDOR  NOT_AUTOACQUIRABLE MADE_OF_STONE
  RadarPriority		= STRUCTURE
  Body              = ActiveBody ModuleTag_02
		MaxHealth       = 2000.0
    
		GrabObject = EntThrownBuildingRock
		GrabFX = FX_WallGrab
		GrabDamage = 490
		GrabOffset = X:16 Y:0
  End

  ; Note that structures with "RUBBLE" states should not use DestroyDie; such buildings are 
  ; never truly destroyed, even when reduced to zero health. Also note that garrisonable
  ; buildings automatically stick around because GarrisonContain has it's own DieModule
  Behavior = SlowDeathBehavior ModuleTag_SlowDeathWithoutRubble
      DestructionDelay  = 5000
  End
  
  	Behavior = AttributeModifierAuraUpdate ModuleTag_WallBonus
		StartsActive	= Yes ;If no, requires upgrade to turn on.
		BonusName		= WallBonus
		RefreshDelay	= 2000
		;Range			= 120		; Range is overridden to affect people on us since we are a wall
		;TargetEnemy		= Yes	; Alliances are ignored to affect people on us since we are a wall
	End	

  Geometry              = BOX
  GeometryMajorRadius   = 36.0
  GeometryMinorRadius   = 36.0
  GeometryHeight        = 88.0
  GeometryIsSmall       = No
  GeometryRotationAnchorOffset = X:372.9936 Y:0.0
  Shadow                = SHADOW_VOLUME
End

;Rohan Base Defence Foundation -- the area where faction rohan buildings can be built on
Object RohanBaseDefenceFoundation
 
	SelectPortrait = BPRCamp_Plot
  ; *** ART Parameters ***

	Scale = 0.7
  
	Draw = W3DScriptedModelDraw ModuleTag_Draw2
	    DefaultModelConditionState
			Model = OBBFoundationX
		End
		ModelConditionState = WORLD_BUILDER
  			Model = RBWatchTowM
  		End
		
	End
   Draw = W3DFloorDraw ModuleTag_Draw
      ModelName = RBFoundationM
  End
 
  ;PlacementViewAngle  = 0
 
  ; ***DESIGN parameters ***
  DisplayName         = OBJECT:RohanBaseDefenseFoundation
  Side                = Obsolete
  EditorSorting       = STRUCTURE
  ThreatLevel = 1.0
 
  BuildCost           = 1
  BuildTime           = 5.0           ; in seconds
  VisionRange         = 160.0          ; Shroud clearing distance
  ShroudClearingRange = 160

  CommandSet = RohanBaseDefenceFoundationCommandSet

  ; *** AUDIO Parameters ***
	
	VoiceSelect		= Gui_PlotSelect


  ; *** ENGINEERING Parameters ***

  RadarPriority       = STRUCTURE
  KindOf              = STRUCTURE SELECTABLE IMMOBILE BASE_FOUNDATION BASE_DEFENSE_FOUNDATION UNATTACKABLE MP_COUNT_FOR_VICTORY NO_COLLIDE DO_NOT_CLASSIFY
 
  Behavior            = FoundationAIUpdate ModuleTag_foundationAI
  End

  Behavior = CastleMemberBehavior ModuleTag_CMB
  End 

  Body                = ImmortalBody ModuleTag_05
    MaxHealth         = 15000.0
  End
 
  Geometry              = BOX
  GeometryMajorRadius   = 24.0
  GeometryMinorRadius   = 24.0
  GeometryHeight        = 0.8
  GeometryIsSmall       = No
  Shadow                = SHADOW_VOLUME
  BuildCompletion		= PLACED_BY_PLAYER
End
