;//------------------------------------------------------------------------------
;//
;//	AngmarHordes.ini
;// 
;//------------------------------------------------------------------------------
Object AngmarDarkDunedainHorde

	// This is required for garrisoned objects - please put in all objects.
	ButtonImage		= WOR_DarkNumenorianIcon   ;Needs new art
	SelectPortrait		= KUDarkDunedainPortrait    ;Needs new art

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING EMOTION_POINTING SELECTED
		DefaultModelConditionState
			Model = None //InvisHrdeTmp5x2
		End

		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkGUSol
		End		
	End
	
	Side = Angmar
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeAngmarDarkDunedain
	DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarDarkDunedainHorde
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarDarkDunedainHorde
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End

	// *** AUDIO Parameters ***//
	// Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	// are always passed through to members
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	UnitSpecificSounds
		VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge ;needs angmar voice
	End

	BuildCost 		= ANGMAR_DARKDUNEDAIN_BUILDCOST
	BuildTime 		= ANGMAR_DARKDUNEDAIN_BUILDTIME
	ShroudClearingRange 	= ANGMAR_DARKDUNEDAIN_HORDE_SHROUD_RANGE       
	VisionRange 		= ANGMAR_DARKDUNEDAIN_HORDE_VISION_RANGE
	VisionSide 		= 50%
	VisionRear 		= 25%
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	CommandPoints 		= 80	; originally 60
	
	FormationWidth = 2 // Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 // Depth it occupies in formations. Current choices are 1 or 2.
	
 	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 1 
	
	CrushOnlyWhileCharging = YES ; // the guardian is only supposed to crush during his special charge ability
	
	MinCrushVelocityPercent = 50% ; Has to be moving at least xx% of full speed
	CrushDecelerationPercent = 90% ; Lose xx% max velocity when crushing -- thus they only crush 1 row of infantry
	
	CrushKnockback = 40  ; how hard we knock back crushed units.
	CrushZFactor = 1.0  ; How much we knock upwards.
	 
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND //UNATTACKABLE 

	ThreatLevel = GONDOR_FIGHTER_HORDE_THREAT
	ThreatBreakdown GondorFighterHorde_DetailedThreat
		AIKindOf = INFANTRY
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	#include "..\..\..\includes\CaptureBuilding.inc"
    
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End
    
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AILuaEventsList			= InfantryFunctions
		AttackPriority			= AttackPriority_Infantry
	End

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 			= 270
		FlankedDelay 			= 2000
		ObjectStatusOfContained 	= 
		InitialPayload 			= AngmarDarkDunedain 10
		Slots 				= 10			; originally 15
		PassengerFilter			= NONE +INFANTRY
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset			= X:0 Y:0
		MeleeBehavior 			= Amoeba
		End

		// Banner Carrier info		
		BannerCarriersAllowed		= AngmarInfantryBanner						// types of units that are allowed as banner carriers
		BannerCarrierPosition		= UnitType:AngmarDarkDunedain   Pos:X:70.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain Position:X:50 Y:0			Position:X:50 Y:20				Position:X:50 Y:-20				Position:X:50 Y:40				Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		//RankInfo = RankNumber:3 UnitType:AngmarDarkDunedain Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking 	= 1 2

		AlternateFormation 		= GondorFighterHordeBlock
		MeleeAttackLeashDistance 	= 1   		//How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		= 1		//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		= 3000		//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		= 1		//The minimum number of	cells to backup
		BackUpMaxDistance		= 3		//The maximum number of	cells to backup
		BackupPercentage		= 80%		//The amount of	chance that	a unit will	back up.
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
	End
  
   	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance	 	= INFANTRY_TAUNT_POINT_RADIUS	   	// max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	= 1000		   			// how often	scan (milliseconds)
		TauntAndPointExcluded	 	= NONE
		AfraidOf			= EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			= EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				= EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		= 150
		FearScanDistance		= INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion			= Terror_Base
		AddEmotion			= Doom_Base				//OVERRIDE
			//StartFXList		= FX_GondorSoldierDoom			//these have been hooked up in the FXList.INI
			//End

		AddEmotion			= BraceForBeingCrushed_Base
		
		AddEmotion			= UncontrollableFear_Base		//OVERRIDE
			//StartFXList		= FX_GondorSoldierFear
			//End
		
		AddEmotion			= FearIdle_Base				//OVERRIDE
			//StartFXList		= FX_GondorSoldierFear
			//End
		
		AddEmotion			= FearBusy_Base				//OVERRIDE
			//StartFXList		= FX_GondorSoldierFear
			//End
	
		AddEmotion			= Point_Base				//OVERRIDE
			//Duration		= 13980
			//StartFXList		= FX_GondorSoldierPoint
			//End
		
		AddEmotion			= Taunt_Base				//OVERRIDE
 			//AttributeModifier	= GondorFighterTaunt
 			//End		
 		
 		AddEmotion		=	CheerIdle_Base
		AddEmotion		=	CheerBusy_Base
		AddEmotion		=	HeroCheerIdle_Base
		AddEmotion		=	HeroCheerBusy_Base
		AddEmotion		=	Alert_Base
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly 		= Yes
		StuffToPickUp 		= NONE +CRATE
		ScanRange 		= 200
		ScanIntervalSeconds 	= 0.5
	End
  
	LocomotorSet
		Locomotor     = NormalChargeMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_MED_HORDE_SPEED
	End

;	LocomotorSet
;		Locomotor     = NormalMeleeHordeLocomotor
;		Condition     = SET_NORMAL
;		Speed         = NORMAL_GOOD_FAST_HORDE_SPEED
;	End
	
	LocomotorSet
		Locomotor     = ScaredMeleeHordeLocomotor
		Condition     = SET_SCARED
		Speed         = NORMAL_FOOT_MED_HORDE_SPEED
	End
	
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_AngmarBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_AngmarDarkIronBlades
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_AngmarDarkIronArmor
	End
	
	
	/////////////////////
	// AISpecialPowers
	/////////////////////
	Behavior = AISpecialPowerUpdate AngmarCharge
		CommandButtonName = Command_AngmarChargeAttack
		SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	
;--------------------Death Mask Power--------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeathMaskUnpause
		SpecialPowerTemplate      = SpecialAbilityFakeLeadership
		TriggeredBy		  = Upgrade_ObjectLevel4
	End

	Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
		UpdateModuleStartsAttack	= Yes
		StartsPaused			= Yes
	End
	
	Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
		StartsActive			= No ;If no, requires upgrade to turn on.
		TriggeredBy		  	= Upgrade_ObjectLevel4
		BonusName			= DeathMaskModifier
		RefreshDelay			= 2000
		Range				= ANGMAR_NECRO_DEATH_MASK_RANGE
		TargetEnemy			= Yes
		AntiCategory			= LEADERSHIP BUFF ; This means cancel all previous leadership bonuses
		ObjectFilter			= ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
	End
;-------------------------Angmar Charge--------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
		SpecialPowerTemplate      = SpecialAbilityAngmarCharge
		TriggeredBy		  = Upgrade_ObjectLevel2
	End
	
  	Behavior = SpecialPowerModule ModuleTag_ChargeStarter                      
		SpecialPowerTemplate      = SpecialAbilityAngmarCharge
		UpdateModuleStartsAttack  = Yes
		StartsPaused		= Yes
	End
	#include "..\..\..\includes\AngmarChargeUpdate.inc"
	
	CommandSet = AngmarDarkDunedainHordeCommandSet

	Geometry = BOX
	GeometryMajorRadius = 30.0
	GeometryMinorRadius = 45.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
	
	
	//-------------------------------------------------------------------------------------------------
	// World Map specific data
	//-------------------------------------------------------------------------------------------------
	
	// *** AUTO RESOLVE DATA ***
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain
	
	AutoResolveBody = AutoResolve_GondorFighterHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_GondorSoldierHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_GondorSoldierArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_GondorSoldierUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_GondorSoldierWeapon
	End

	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarDarkIronBlades Upgrade_AngmarDarkIronArmor
End

ChildObject AngmarDarkDunedainHorde_Summoned AngmarDarkDunedainHorde
	IsTrainable	= No
	CommandPoints 	= 0
	CommandSet	= AngmarDarkDunedainHordeCommandSet_Summoned
	EquivalentTo  	= AngmarDarkDunedainHorde

	DisplayName  =  OBJECT:HordeAngmarDarkDunedain

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 	= 270
		FlankedDelay 	= 2000
		ObjectStatusOfContained = 
		InitialPayload 	= AngmarDarkDunedain_Summoned 10
		Slots 		= 10				// originally 15
		PassengerFilter	= NONE +INFANTRY
		ShowPips 	= No
		ThisFormationIsTheMainFormation = Yes		//Used to determine which armorset to use (and anything else we want!)
		RandomOffset	= X:0 Y:0
		MeleeBehavior 	= Amoeba
		End

		RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain_Summoned Position:X:50 Y:0			Position:X:50 Y:20				Position:X:50 Y:-20				Position:X:50 Y:40				Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarDarkDunedain_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 

		AlternateFormation = GondorFighterHordeBlock
		MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		 = 1	//The minimum number of	cells to backup
		BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
		BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one displays the timer, but the one in the uint does the work 
		MinLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End	

End

//------------------------------------------------------------------------------
ChildObject AngmarDarkDunedainHordeBlock AngmarDarkDunedainHorde

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module. 
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle			= 270
		FlankedDelay			= 2000
		ObjectStatusOfContained		= 
		InitialPayload			= AngmarDarkDunedain GOOD_MEN_GIANT_HORDE_SIZE
		Slots				= 10	// originally 15
		PassengerFilter			= NONE +INFANTRY
		ShowPips			= No
		ThisFormationIsTheMainFormation = No	//Used to determine which armorset to use (and anything else we want!)
		AttributeModifiers		= GondorFighterBlock
		RandomOffset			= X:0 Y:0
		MeleeBehavior 			= Amoeba
		End
		
		// Banner Carrier info		
		BannerCarriersAllowed	= AngmarBanner							// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarDarkDunedain	Pos:X:46.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:AngmarDarkDunedain Position:X:34 Y:0			Position:X:34 Y:10				Position:X:34 Y:-10				Position:X:34 Y:20				Position:X:34 Y:-20
		RankInfo = RankNumber:2 UnitType:AngmarDarkDunedain Position:X:22 Y:0 Leader 1 0	Position:X:22 Y:10 Leader 1 1	Position:X:22 Y:-10 Leader 1 2	Position:X:22 Y:20 Leader 1 3	Position:X:22 Y:-20 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarDarkDunedain Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:10 Leader 2 1	Position:X:10 Y:-10 Leader 2 2	Position:X:10 Y:20 Leader 2 3	Position:X:10 Y:-20 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 2
				
		AlternateFormation 		= AngmarDarkDunedainHorde
		MeleeAttackLeashDistance 	= 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		= 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		= 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		= 1	//The minimum number of	cells to backup
		BackUpMaxDistance		= 3	//The maximum number of	cells to backup
		BackupPercentage		= 80%	//The amount of	chance that	a unit will	back up.		
	End
End

;//--------------------------------------------------------------------------------------------------
Object AngmarDarkRangerHorde

ButtonImage		= WOR_DarkRangersIcon
	SelectPortrait	= KUDarkRangerPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY EMOTION_TAUNTING
		DefaultModelConditionState
			Model = None //InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkGURan
		End
	End
	
	Side 			= Angmar
	EditorSorting 		= UNIT
	EmotionRange 		= 240
	DisplayName 		= OBJECT:HordeAngmarDarkRanger
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_AngmarDarkRangerHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_AngmarDarkRangerHorde
	
	WeaponSet
		Conditions 	= None 
		Weapon 		= PRIMARY    GondorRangerMissileHordeRangefinder
		Weapon 		= TERTIARY   GondorRangerMissileHordeRangefinderBombard
		AutoChooseSources = TERTIARY FROM_PLAYER FROM_SCRIPT				; Not AI.
	End

	// *** AUDIO Parameters ***
	// Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	// are always passed through to members
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"


	BuildCost 		= ANGMAR_RANGER_BUILDCOST
	BuildTime 		= ANGMAR_RANGER_BUILDTIME
	VisionRange 		= ANGMAR_RANGER_HORDE_VISION_RANGE
	ShroudClearingRange 	= ANGMAR_RANGER_HORDE_SHROUD_RANGE
	VisionSide 		= 50%
	VisionRear 		= 25%
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	CommandPoints 		= 72		; originally 60
		
 	CrushableLevel 		= 0  		//What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 		= 0
	UseCrushAttack 		= No		;Archer hordes cannot crush or Bombard will not work

	FormationWidth 		= 2 		// Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth 		= 1 		// Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND//UNATTACKABLE 
	CamouflageDetectionMultiplier 	= CAMOUFLAGE_DETECTION_DISTANCE_LONG
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	ThreatLevel = GONDOR_RANGER_HORDE_THREAT
	ThreatBreakdown GondorRangerHorde_DetailedThreat
		AIKindOf = ARCHER
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS STEALTHED
		MoodAttackCheckRate        	= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		CanAttackWhileContained    	= Yes  						// Can fire out of garrisoned building		
        AILuaEventsList				= InfantryFunctions
        AttackPriority				= AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 			= 270
		FlankedDelay 			= 2000
		ObjectStatusOfContained 	= 
		InitialPayload 			= AngmarDarkRanger 12	; GOOD_MEN_HORDE_SIZE
		Slots 				= 12						// originally 10
		PassengerFilter 		= NONE +INFANTRY
		ShowPips 			= No
		ThisFormationIsTheMainFormation = Yes						//Used to determine which armorset to use (and anything else we want!)
		RandomOffset			= X:4 Y:4
		MeleeBehavior 			= Amoeba
		End
		
		// Banner Carrier info		
		BannerCarriersAllowed		= AngmarInfantryBanner						// types of units that are allowed as banner carriers
		BannerCarrierPosition		= UnitType:AngmarDarkRanger	Pos:X:30.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		// Positions for 5
		//RankInfo = RankNumber:1 UnitType:AngmarDarkRanger Position:X:20 Y:0			Position:X:20 Y:25		Position:X:20 Y:-25		Position:X:20 Y:50		Position:X:20 Y:-50 
		//RankInfo = RankNumber:2 UnitType:AngmarDarkRanger Position:X:0 Y:0	Leader 1 0 	Position:X:0 Y:25 Leader 1 1	Position:X:0 Y:-25 Leader 1 2	Position:X:0 Y:50 Leader 1 3	Position:X:0 Y:-50 Leader 1 4

		; Positions for 6
		RankInfo = RankNumber:1 UnitType:AngmarDarkRanger Position:x:20 Y:10			Position:X:20 Y:-10		Position:X:20 Y:30		Position:X:20 Y:-30		Position:X:20 Y:50		Position:X:20 Y:-50
		RankInfo = RankNumber:2 UnitType:AngmarDarkRanger Position:X:0 Y:10 Leader 1 0		Position:X:0 Y:-10 Leader 1 1	Position:X:0 Y:30 Leader 1 2	Position:X:0 Y:-30 Leader 1 3	Position:X:0 Y:50 Leader 1 4	Position:X:0 Y:-50 Leader 1 5

		RanksToReleaseWhenAttacking 	= 1 2 
				
		MeleeAttackLeashDistance 	= 1   			// How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		= 1			// The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		= 3000			// The maximum amount of	time to	delay before backing up
		BackUpMinDistance		= 1			// The minimum number of	cells to backup
		BackUpMaxDistance		= 3			// The maximum number of	cells to backup
		BackupPercentage		= 80%			// The amount of	chance that	a unit will	back up.
	End

	#include "..\..\..\includes\DefaultInvisibilityUpdate.inc"

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
   	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		// max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000		// how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
 		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
 		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	ARCHER_FEAR_SCAN_RADIUS

		AddEmotion		=	Terror_Base
		AddEmotion		=	Doom_Base
		AddEmotion		=   	BraceForBeingCrushed_Base
		AddEmotion		=	UncontrollableFear_Base
		AddEmotion		=	FearIdle_Base
		AddEmotion		=	FearBusy_Base
		AddEmotion		=	Point_Base
		
		//Rangers are very stoic and do not taunt. - 
		//AddEmotion		=	OVERRIDE Taunt_Base	
 		//AttributeModifier	=	GondorFighterTaunt
 		//End		
 		
 		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	
		
	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_MED_HORDE_SPEED
	End

	CommandSet = AngmarDarkRangerHordeCommandSet

	Behavior = OCLSpecialPower ModuleTag_ArrowVolleyEvil
		SpecialPowerTemplate		= SpecialAbilityMenLongShot ;?? does this need unique ability assigned in SpecialAbility.INI #
		OCL				= OCL_LongIceShotAbility ;OCL_LongShotAbility
		CreateLocation			= CREATE_AT_LOCATION
		UpdateModuleStartsAttack	= No
		
		;// Need to set a model condition (unused by the horde anyway) in order to
		;// freeze the horde for the duration of the spell
		SetModelCondition		= ModelConditionState:USER_1
		SetModelConditionTime		= 5.0
		DisableDuringAnimDuration	= Yes
	End
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_FireballUpdate   
		SpecialPowerTemplate    = SpecialAbilityMenLongShot
		PackTime		= 5000						// returning to flap
		MustFinishAbility	= Yes
		SpecialWeapon		= MenLongShotWeapon
		NeedLivingTargets	= No
		;PackSound		= LongshotRangerCall	;this worked!
		;UnpackSound		= LongshotRangerCall	;this didn't work
		;PrepSoundLoop		= LongshotRangerCall	;this worked!
		TriggerSound		= RangerVoiceLongShot
		ApproachRequiresLOS	= No
	End
	
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_AngmarBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_AngmarIceArrows
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End
	
	/////////////////////
	// AISpecialPowers
	/////////////////////
	
	Behavior = AISpecialPowerUpdate GondorRangerHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	
;--------------------Death Mask Power--------------------------------
;	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_DeathMaskUnpause
;		SpecialPowerTemplate      = SpecialAbilityFakeLeadership
;		TriggeredBy		  = Upgrade_ObjectLevel4
;	End
;
;	Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
;		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
;		UpdateModuleStartsAttack	= Yes
;		StartsPaused			= Yes
;	End
;		
;	Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
;		StartsActive			= Yes ;If no, requires upgrade to turn on.
;		BonusName			= DeathMaskModifier
;		RefreshDelay			= 2000
;		Range				= ANGMAR_NECRO_DEATH_MASK_RANGE
;		TargetEnemy			= Yes
;		AntiCategory			= LEADERSHIP BUFF ; This means cancel all previous leadership bonuses
;		ObjectFilter			= ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
;	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 60.0
	GeometryHeight = 10.0
	GeometryIsSmall = No
	
	
	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Archer
	AutoResolveCombatChain = AutoResolve_ArcherCombatChain
	
	AutoResolveBody = AutoResolve_GondorRangerHordeBody

	AutoResolveArmor
		Armor = AutoResolve_GondorRangerArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_AngmarIceArrows
		Weapon = AutoResolve_GondorRangerUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_AngmarIceArrows
		Weapon = AutoResolve_GondorRangerWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarIceArrows
End

//////////////////////////////////////////////////////////////////////////////////
ChildObject AngmarDarkRangerHorde_Summoned AngmarDarkRangerHorde
	IsTrainable = No
	CommandPoints = 0
	CommandSet = AngmarDarkRangerHordeCommandSet_Summoned
	EquivalentTo = AngmarDarkRangerHorde

	DisplayName  =  OBJECT:HordeAngmarDarkRanger
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND SUMMONED

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload 		= AngmarDarkRanger_Summoned GOOD_MEN_HORDE_SIZE
		Slots 			= 10
		PassengerFilter 	= NONE +INFANTRY
		ShowPips 		= No
		ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset		= X:4 Y:4
		
		// Positions for 5
		RankInfo = RankNumber:1 UnitType:AngmarDarkRanger_Summoned Position:X:0 Y:0	Position:X:0 Y:20	Position:X:0 Y:-20	Position:X:0 Y:40	Position:X:0 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarDarkRanger_Summoned Position:X:15 Y:0	Position:X:15 Y:20	Position:X:15 Y:-20	Position:X:15 Y:40	Position:X:15 Y:-40 

		RanksToReleaseWhenAttacking = 1 2 
				
		MeleeAttackLeashDistance = 25// How far the hordes can move from the center of the horde when melee attacking.
	End
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		// This one displays the timer, but the one in the uint does the work 
		MinLifetime		= DUNEDAIN_ALLIES_LIFETIME
		MaxLifetime		= DUNEDAIN_ALLIES_LIFETIME
		DeathType		= FADED
	End	

	//Summoned Rangers can detect Stealthed Units	
	Behavior = StealthDetectorUpdate StealthDetectorUpdateModuleTag
		DetectionRange		= 100	// range to detect
		DetectionRate		= 500   // how often to rescan for stealthed things in my sight (msec)
		CancelOneRingEffect 	= Yes	// forces uses of one-ring to pop out of it
	End
End

;//--------------------------------------------------------------------------

;////////////////////////////////////////////////////////////////////////////////
Object AngmarDireWolfHorde

  	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = WOR_DireWolvesIcon
	SelectPortrait = KUDireWolfPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x1
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkIUWar
		End
	End
	
	Side 			= Angmar
	EditorSorting 		= UNIT
	EmotionRange 		= 240
	DisplayName 		= OBJECT:HordeAngmarDireWolf
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_AngmarDireWolfHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_AngmarDireWolfHorde
	
	WeaponSet
		Conditions 	= None 
		Weapon		= PRIMARY	NormalMeleeHordeRangefinder	; Spear
		Weapon		= SECONDARY	NormalMissileHordeRangefinder	; Bow
	End


	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


	BuildCost = ANGMAR_DIREWOLF_BUILDCOST			
	BuildTime = ANGMAR_DIREWOLF_BUILDTIME			
	VisionRange = ANGMAR_DIREWOLF_VISION_RANGE
	
	ShroudClearingRange = ANGMAR_DIREWOLF_SHROUD_RANGE       
	
	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	
	 		
	CommandPoints = 40 	; originally 48
	
	CommandSet = AngmarDireWolfHordeCommandSet
		  
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
	CrushableLevel 			= 2  			; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
;	CrusherLevel 			= 1 			; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
;	MinCrushVelocityPercent 	= 50 			; Has to be moving at at least 50% of full speed.
;	CrushDecelerationPercent 	= 50 			; Lose 20 percent of max velocity when crushing.
;	CrushKnockback 			= 40  			; how hard we knock back crushed units.
;	CrushZFactor 			= 1.0  			; How much we knock upwards.
		
	
	TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND;UNATTACKABLE 
	
	ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
	ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
		AIKindOf = INFANTRY
	End
	
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Cavalry
	End

    Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	CAVALRY_FEAR_SCAN_RADIUS ;250

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   	BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
		AddEmotion	=   CheerForAboutToCrush_Base
	End	
	
	Behavior = HorseHordeContain ModuleTag_HordeContain
	FrontAngle = 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload 		= AngmarDireWolf  8
		Slots 			= 8					; originally 10
		PassengerFilter 	= NONE +INFANTRY +AngmarDireWolf
		ShowPips 		= No
		RandomOffset 		= X:2 y:3
		
		MeleeBehavior 		= Amoeba
		End
		
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarBannerDireSnowTroll					; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarDireWolf	Pos:X:60.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo	= RankNumber:1 UnitType:AngmarDireWolf Position:X:30 Y:-35	Position:X:42 Y:-15	Position:X:50 Y:15	Position:X:30 Y:42		Position:X:-5 Y:-25	Position:X:-28 Y:0	Position:X:5 Y:5	Position:X:-10 Y:30	;	

		; RankInfo	= RankNumber:1 UnitType:AngmarDireWolf Position:X:20 Y:0	Position:X:-16.18 Y:11.76	Position:X:6.18 Y:-19.02	Position:X:6.18 Y:19.02		Position:X:-16.18 Y:-11.76	Position:X:30.54 Y:16.27	Position:X:-39.13 Y:8.32	Position:X:26.77 Y:-29.73	Position:X:-4.18 Y:39.78	Position:X:-20 Y:-34.64		Position:X:26.77 Y:29.73	Position:X:-39.13 Y:-8.32	Position:X:36.54 Y:-16.27	Position:X:-20 Y:34.64	Position:X:-4.18 Y:-39.78

		//RankInfo = RankNumber:1 UnitType:AngmarDireWolf Position:X:40 Y:0		Position:X:40 Y:15		Position:X:40 Y:-15		Position:X:40 Y:30		Position:X:40 Y:-30 
		//RankInfo = RankNumber:2 UnitType:AngmarDireWolf Position:X:10 Y:0 Leader 1 0	Position:X:10 Y:15 Leader 1 1	Position:X:10 Y:-15 Leader 1 2	Position:X:10 Y:30 Leader 1 3	Position:X:10 Y:-30 Leader 1 4
		
		RanksToReleaseWhenAttacking = 1
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
		AttributeModifiers = IsengardWargSkirmish		
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
		ScanWidth = 40.0 ; A little less than the width of the horde (which is 2 * 24 = 48)
	End

	Behavior = SpecialPowerModule ModuleTag_HowlUpdate   
		SpecialPowerTemplate      	= SpecialAbilityWargHowl
		UpdateModuleStartsAttack  	= No
		AttributeModifier 		= IsengardWargHowl 	
;		AttributeModifierRange 		= 200
		AttributeModifierAffectsSelf 	= Yes
;		AttributeModifierAffects 	= ANY +CAVALRY 
		AttributeModifierFX 		= FX_WargHowl
	End
	
	LocomotorSet
		Locomotor     = NormalCavalryHordeLocomotor ;WargCavalryHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_AngmarBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_AngmarSpikedCollar
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly 		= Yes
		StuffToPickUp 		= NONE +CRATE
		ScanRange		= 200
		ScanIntervalSeconds 	= 0.5
	End
	
;	#include "..\..\..\includes\CaptureBuilding.inc"
	
	;///////////////////
	; AISpecialPowers
	;///////////////////

	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	
	Geometry 		= BOX
	GeometryMajorRadius 	= 30.0
	GeometryMinorRadius 	= 40.0
	GeometryHeight 		= 20.0
	GeometryIsSmall 	= No


	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain

	AutoResolveBody = AutoResolve_GondorKnightHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_AngmarSpikedCollar
		Armor = AutoResolve_IsengardWargRiderHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_AngmarSpikedCollar
		Armor = AutoResolve_IsengardWargRiderArmor
	End

	AutoResolveWeapon
;		ExcludedUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_IsengardWargRiderWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarSpikedCollar 
End


;------------------------------------------------------------------------------------------------------------------
;
;	SnowTrollHorde
;
;------------------------------------------------------------------------------------------------------------------
Object AngmarSnowTrollHorde
  	;// This is required for garrisoned objects - please put in all objects.
	ButtonImage		= WOR_SnowTrollIcon
	SelectPortrait		= KUSnowTrollPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkIUPik
		End
	End
	
	Side			= Angmar
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= OBJECT:AngmarSnowTrollHorde
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_AngmarSnowTrollHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_AngmarSnowTrollHorde
	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    RohanRohirrimSpear
	End

	BuildCost		= ANGMAR_SNOWTROLL_BUILDCOST			
	BuildTime		= ANGMAR_SNOWTROLL_BUILDTIME	
	CommandPoints 		= 78 	; originally 60		

	ShroudClearingRange 	= ANGMAR_SNOWTROLL_SHROUD_RANGE       
	VisionRange 		= ANGMAR_SNOWTROLL_HORDE_VISION_RANGE
	
	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%	
	
		
	CrushableLevel 			= 2  	//What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 			= 1 
	MinCrushVelocityPercent 	= 50% 	// Has to be moving at at least 25% of full speed.
	CrushDecelerationPercent 	= 30% 	// Lose 10 percent (100/5 horde members) of max velocity when crushing.
	CrushKnockback 			= 40  	// how hard we knock back crushed units.
	CrushZFactor 			= 1.0  	// How much we knock upwards.
		
	CommandSet  = AngmarSnowTrollHordeCommandSet
		
	FormationWidth = 2 	;// Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 	;// Depth it occupies in formations. Current choices are 1 or 2.
	
	TransportSlotCount	= TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND TROLL	;//UNATTACKABLE 
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"
	
	ThreatLevel = ROHAN_ROHIRRIM_HORDE_THREAT
	ThreatBreakdown RohanRohirrimHorde_DetailedThreat
		AIKindOf = CAVALRY
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		AILuaEventsList			= CavalryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Cavalry
	End

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload		= AngmarSnowTroll 6
		PassengerFilter		= NONE +CAVALRY 
		Slots			= 6
		ShowPips		= No

		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarBannerSnowTroll					; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarSnowTroll	Pos:X:60.0 Y:0		; (DEFAULT) position of banner carrier for fighter horde		
		
		RankInfo		= RankNumber:1 UnitType:AngmarSnowTroll Position:X:30 Y:-25			Position:X:30 Y:0			Position:X:30 Y:25			;Position:X:30 Y:50			Position:X:25 Y:-50
		RankInfo		= RankNumber:2 UnitType:AngmarSnowTroll Position:X:0  Y:-25	Leader 1 0 	Position:X:0  Y:0 	Leader 1 1	Position:X:0  Y:25 	Leader 1 2	;Position:X:0 Y:-30 Leader 1 3		Position:X:0 Y:-30 Leader 1 4

		RanksToReleaseWhenAttacking = 1 2
		
		UseSlowHordeMovement = Yes
		MeleeAttackLeashDistance = 150 ;// How far the hordes can move from the center of the horde when melee attacking.

	End
	
;//	Behavior = SpecialEnemySenseUpdate ModuleTag_EnemySenseUpdate
;//		SpecialEnemyFilter = NONE +CAVALRY +INFANTRY
;//		ScanRange = 300
;//		ScanInterval = 2000
;//	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000					; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	NONE +GondorGwaihir +MordorBalrog +MordorFellBeast +AngmarWitchking +MordorWitchKingOnFellBeast +MordorMumakil +MordorGateWatchersExpansion +SpellBookArrowVolley +TomBombadil +TomBombadil_Summoned +EvilMenBlackRider +CreateAHero
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		//AddEmotion	=   	BraceForBeingCrushed_Base		// Pikemen don't fear getting crushed
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base

		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	

	#include "..\..\..\includes\CaptureBuilding.inc"
	
	LocomotorSet
		Locomotor = HumanSpecialChargeLocomotor
		Condition = SET_NORMAL 
		Speed     = NORMAL_MOUNTED_SLOW_HORDE_SPEED
	End

;	LocomotorSet
;		Locomotor     = NormalMeleeHordeLocomotor
;		Condition     = SET_NORMAL
;		Speed         = NORMAL_WILD_PIKEMEN_HORDE_SPEED
;	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy		= Upgrade_AngmarBasicTraining
		LevelsToGain		= 1
		LevelCap		= 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_AngmarDarkIronArmor
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_AngmarDarkIronBlades
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End
	
	;///////////////////
	; AISpecialPowers
	;///////////////////

	Behavior = AISpecialPowerUpdate AngmarCharge
		CommandButtonName = Command_AngmarChargeAttack
		SpecialPowerAIType = AI_SPECIAL_POWER_CHARGE
	End
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	
;-------------------------Angmar Charge--------------------------------------
	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_ChargeUnpause
		SpecialPowerTemplate      = SpecialAbilityAngmarCharge
		TriggeredBy		  = Upgrade_ObjectLevel2
	End
	
  	Behavior = SpecialPowerModule ModuleTag_ChargeStarter                      
		SpecialPowerTemplate      = SpecialAbilityAngmarCharge
		UpdateModuleStartsAttack  = Yes
		StartsPaused		= Yes
	End
	#include "..\..\..\includes\AngmarChargeUpdate.inc"



	Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Geometry			= BOX
	GeometryMajorRadius = 55 ;30.4
	GeometryMinorRadius = 55 ;30.4
	GeometryHeight		= 8.0
	GeometryIsSmall		= No
	
	
	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Cavalry
	AutoResolveCombatChain = AutoResolve_CavalryCombatChain
	
	AutoResolveBody = AutoResolve_WildMarauderHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_WildMarauderHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_WildMarauderArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_WildMarauderUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_WildMarauderWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarDarkIronBlades Upgrade_AngmarDarkIronArmor
End

;------------------------------------------------------------------------------------------------------------------
;
;	AngmarHillTrollHorde
;
;------------------------------------------------------------------------------------------------------------------
Object AngmarHillTrollHorde
  	;// This is required for garrisoned objects - please put in all objects.
	ButtonImage		= WOR_HillTrollIcon
	SelectPortrait		= KUHillTrollPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model 	= None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model 	= None
		End		
		ModelConditionState = WORLD_BUILDER
			Model 	= HordeMarkIUPik
		End
	End
	
	Side			= Angmar
	EditorSorting		= UNIT
	EmotionRange		= 240
	DisplayName		= OBJECT:AngmarHillTrollHorde
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_AngmarHillTrollHorde
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_AngmarHillTrollHorde
	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY    TowerGuardHordeRangefinder
	End

	BuildCost		= ANGMAR_HILLTROLL_BUILDCOST			
	BuildTime		= ANGMAR_HILLTROLL_BUILDTIME			

	ShroudClearingRange 	= ANGMAR_HILLTROLL_SHROUD_RANGE       
	VisionRange 		= ANGMAR_HILLTROLL_HORDE_VISION_RANGE
	
	VisionSide 		= 50%
	VisionRear 		= 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%	
	
		
	CrushableLevel		= 0 	;//What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel		= 0 	;//What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles 
	CommandPoints		= 80	; originally 48
		
	CommandSet  		= AngmarHillTrollHordeCommandSet
		
	FormationWidth 		= 2 	;// Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth 		= 2 	;// Depth it occupies in formations. Current choices are 1 or 2.
	
	TransportSlotCount	= TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf			= SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE  ARMY_SUMMARY URUK PIKE LARGE_RECTANGLE_PATHFIND TROLL;//UNATTACKABLE 
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"
	
	ThreatLevel = WILD_MAURADER_HORDE_THREAT
	ThreatBreakdown WildMauraderHorde_DetailedThreat
		AIKindOf = PIKEMAN
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		AILuaEventsList			= InfantryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Spearman
	End

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 		= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload		= AngmarHillTroll 8
		PassengerFilter		= NONE +INFANTRY
		Slots			= 8
		ShowPips		= No

		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarBannerHillTroll								; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarHillTroll	Pos:X:60.0 Y:6.5	; (DEFAULT) position of banner carrier for fighter horde		
		
		RankInfo		= RankNumber:1 UnitType:AngmarHillTroll Position:X:30 Y:-25		Position:X:30 Y:0		Position:X:30 Y:25		Position:X:30 Y:50			;Position:X:25 Y:-50
		RankInfo		= RankNumber:2 UnitType:AngmarHillTroll Position:X:0 Y:-5  Leader 1 0	Position:X:0 Y:20 Leader 1 1	Position:X:0 Y:45 Leader 1 2	Position:X:0 Y:-30 Leader 1 3		;Position:X:0 Y:-30 Leader 1 4

		RanksToReleaseWhenAttacking = 1 2
		
		UseSlowHordeMovement 	= Yes
		MeleeAttackLeashDistance = 150 ;// How far the hordes can move from the center of the horde when melee attacking.

		AlternateFormation 	= AngmarHillTrollPorcupine
	End
	
;//	Behavior 			= SpecialEnemySenseUpdate ModuleTag_EnemySenseUpdate
;//		SpecialEnemyFilter 	= NONE +CAVALRY +INFANTRY
;//		ScanRange 		= 300
;//		ScanInterval 		= 2000
;//	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	NONE +GondorGwaihir +MordorBalrog +MordorFellBeast +AngmarWitchking +MordorWitchKingOnFellBeast +MordorMumakil +MordorGateWatchersExpansion +SpellBookArrowVolley +TomBombadil +TomBombadil_Summoned +EvilMenBlackRider +CreateAHero
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		//	AddEmotion	=   BraceForBeingCrushed_Base		// Pikemen don't fear getting crushed
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base

		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	

	#include "..\..\..\includes\CaptureBuilding.inc"
	
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy	= Upgrade_AngmarBasicTraining
		LevelsToGain	= 1
		LevelCap	= 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_AngmarDarkIronArmor
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_AngmarDarkIronBlades
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End
	
	;///////////////////
	; AISpecialPowers
	;///////////////////
	

	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	Behavior = AISpecialPowerUpdate WildMarauderHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Geometry			= BOX
	GeometryMajorRadius = 25 ;30.4
	GeometryMinorRadius = 50 ;30.4
	GeometryHeight		= 8.0
	GeometryIsSmall		= No
	
	
	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Pikemen
	AutoResolveCombatChain = AutoResolve_PikemenCombatChain
	
	AutoResolveBody = AutoResolve_WildMarauderHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_WildMarauderHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_WildMarauderArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_WildMarauderUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_WildMarauderWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarDarkIronBlades Upgrade_AngmarDarkIronArmor
End

ChildObject AngmarHillTrollPorcupine AngmarHillTrollHorde

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module. 
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle 				= 360			//	Can't be flanked
		FlankedDelay 				= 2000
		ObjectStatusOfContained 		= 
		InitialPayload				= AngmarHillTroll 8
		Slots					= 8
		PassengerFilter				= NONE +INFANTRY
		ShowPips				= No
		ThisFormationIsTheMainFormation 	= No			//Used to determine which armorset to use (and anything else we want!)
		RandomOffset				= X:2 Y:1
		RanksToReleaseWhenAttacking		= 0
		RanksToJustFreeWhenAttacking   		= 0
		AttributeModifiers			= WildMarauderHordePorcupine
		IsPorcupineFormation			= Yes
		MinimumHordeSize			= 4

		AlternateFormation			= AngmarHillTrollHorde
		VisionRearOverride			= 100%
		VisionSideOverride			= 100%
		NotComboFormation			= Yes 			// this formation is not suitable for combo, so it will switch out of this when combo-ing

		// Banner Carrier info		
		BannerCarriersAllowed			= AngmarBannerHillTroll					// types of units that are allowed as banner carriers
		BannerCarrierPosition			= UnitType:AngmarHillTroll	Pos:X:0.0 Y:0.0		// (DEFAULT) position of banner carrier
		
		RankInfo	= RankNumber:1 UnitType:AngmarHillTroll Position:X:30 Y:0	Position:X:-30 Y:0		Position:X:0 Y:30	Position:X:0 Y:-30	Position:X:21.21 Y:21.21	Position:X:-21.21 Y:-21.21	Position:X:-21.21 Y:21.21	Position:X:21.21 Y:-21.21
	End
End


;-------------------------------------------------------------------------------------------------------
Object AngmarOrcWarriors
  	; This is required for garrisoned objects - please put in all objects.
	ButtonImage		= KUSummonOrcIcon
	SelectPortrait	= KUThrallMasterPortrait
	
 

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY SIEGE_CONTAIN
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkMUOrc
		End
	End
	
	Side = Angmar
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeAngmarOrcWarriors
	DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarOrcWarriors
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarOrcWarriors
	
	IsAutoBuilt = Yes;

	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End

	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members
	
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"


	BuildCost 		= ANGMAR_GUNDABAD_ORC_BUILDCOST
	BuildTime 		= MORDOR_FIGHTER_BUILDTIME	   
	ShroudClearingRange 	= MORDOR_FIGHTER_HORDE_SHROUDCLEAR_RANGE
	VisionRange 		= MORDOR_FIGHTER_HORDE_VISION_RANGE 
	VisionSide 		= 50%
	VisionRear 		= 25%
	VisionBonusPercentPerFoot = 1.0%
	CrushableLevel 		= 0  		; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 		= 0 		; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles 
	CommandPoints 		= 0
	CommandSet 		= AngmarWildSpearCommandSet
	FormationWidth 		= 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth 		= 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND ;BUILD_FOR_FREE - not anymore you dont.
	
	ThreatLevel = MORDOR_FIGHTER_HORDE_THREAT
	ThreatBreakdown MordorFighterHorde_DetailedThreat
		AIKindOf = INFANTRY
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = FighterHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		AILuaEventsList			= InfantryFunctions
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Infantry
	End

	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload = AngmarOrcWarrior 20
		Slots = 20
		PassengerFilter = ANY +INFANTRY +MONSTER
		ShowPips = No
		
		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarThrallMasterBanner		; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarOrcWarrior	Pos:X:-35.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde
		BannerCarrierMinLevel   = 0
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RandomOffset=X:5 Y:3	
		
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:AngmarOrcWarrior Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarOrcWarrior Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior Position:X:-10 Y:0 Leader 3 0	Position:X:-10 Y:20 Leader 3 1	Position:X:-10 Y:-20 Leader 3 2	Position:X:-10 Y:40 Leader 3 3	Position:X:-10 Y:-40 Leader 3 4
		
		RanksToReleaseWhenAttacking = 1
		
		MeleeAttackLeashDistance = 1; How far the hordes can move from the center of the horde when melee attacking.
        LivingWorldOverloadTemplate = AngmarThrallMaster
	End
	
	
	Behavior = SiegeDeployHordeSpecialPower SiegeDeployHordeSpecialPowerModuleTag
		SpecialPowerTemplate = SpecialAbilitySiegeDeploy
	End
	
	Behavior = BloodthirstyUpdate ModuleTag_Bloodthirsty
		;In order to sacrifice or be sacrificed, you must have a BloodthirstyUpdate
		SacrificeFilter			= ALL	;Hordes with BloodthirstyUpdates I can sacrifice (hint: use template names)
		ExperienceModifier	= 1.95	;Balance this so that a level 1 orc horde eating a level 1 orc horde gets enough exp to get to level 2
		InitiateVoice			= EVA:BloodthirstySacrificOfOrcs
	End
	
	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = LargeGroupBonusUpdate ModuleTag_LargeGroupBonus
		UpdateRate		= 1000
		HordeMemberFilter	= NONE +AngmarOrcWarrior	
		Count			= 100
		Radius			= 160.0
		RubOffRadius		= 160.0
		AlliesOnly		= Yes
		AttributeModifier	= MordorLargeGroupBonus
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
 		
 		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS; 350		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS ;250

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   	BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		
		AddEmotion	=	OVERRIDE Taunt_Base	
 		;AttributeModifier	=	GondorFighterTaunt
 		End	
		
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
 		QuarrelProbability	=	0.0002%
 		AddEmotion	=	Quarrel_Base
		AddEmotion	=	Alert_Base
	End		
	
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_VERYFAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_MordorBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End
	
	;///////////////////
	; AISpecialPowers
	;///////////////////
	

	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	Behavior = AISpecialPowerUpdate MordorFighterHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Geometry = BOX
	GeometryMajorRadius = 40.0
	GeometryMinorRadius = 50.0
	GeometryHeight = 20.0
	GeometryIsSmall = No


	// *** AUTO RESOLVE DATA ***
	AutoResolveUnitType = AutoResolveUnit_Soldier
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain
	
	AutoResolveBody = AutoResolve_MordorFighterHordeBody

	AutoResolveArmor
		Armor = AutoResolve_MordorFighterArmor
	End

	AutoResolveWeapon
		Weapon = AutoResolve_MordorFighterWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_MordorBasicTraining
End

ChildObject AngmarOrcWarriors_Summoned AngmarOrcWarriors

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module.
	
	// This is to create 

	IsTrainable = No
	CommandPoints = 0
	EquivalentTo = AngmarOrcWarriors
	
	Side = Neutral
	KindOf = SELECTABLE SUMMONED CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND ;BUILD_FOR_FREE - not anymore you dont.
	
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload = AngmarOrcWarrior_Summoned 20
		Slots = 20
		PassengerFilter = ANY +INFANTRY +MONSTER
		ShowPips = No
		
		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarBannerOrcWarrior		; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarOrcWarrior_Summoned	Pos:X:-35.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde
		BannerCarrierMinLevel   = 6
		BannerCarrierDestroyHordeOnDeath = No
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RandomOffset=X:5 Y:3	
		
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:AngmarOrcWarrior_Summoned Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarOrcWarrior_Summoned Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior_Summoned Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		RankInfo = RankNumber:4 UnitType:AngmarOrcWarrior_Summoned Position:X:-10 Y:0 Leader 3 0	Position:X:-10 Y:20 Leader 3 1	Position:X:-10 Y:-20 Leader 3 2	Position:X:-10 Y:40 Leader 3 3	Position:X:-10 Y:-40 Leader 3 4
		
		RanksToReleaseWhenAttacking = 1 2 3 4
		
		MeleeAttackLeashDistance = 3; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one displays the timer, but the one in the uint does the work 
		MinLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End	
End



;////////////////////////////////////////////////////////////////////////////////
ChildObject AngmarOrcWarriors_Placed AngmarOrcWarriors

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module.
	
	// This is to create 

	IsTrainable = No
	CommandPoints = 0
	EquivalentTo = AngmarOrcWarriors
	
	Side = Neutral
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_USE_SIEGE_TOWER INFANTRY HORDE ORC MELEE_HORDE ARMY_SUMMARY  LARGE_RECTANGLE_PATHFIND ;BUILD_FOR_FREE - not anymore you dont.
	
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 270
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload = AngmarOrcWarrior 20
		Slots = 20
		PassengerFilter = ANY +INFANTRY +MONSTER
		ShowPips = No
		
		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarBannerOrcWarrior		; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarOrcWarrior	Pos:X:-35.0 Y:0.0	; (DEFAULT) position of banner carrier for fighter horde
		BannerCarrierMinLevel   = 6
		BannerCarrierDestroyHordeOnDeath = No
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RandomOffset=X:5 Y:3	
		
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:AngmarOrcWarrior Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarOrcWarrior Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		RankInfo = RankNumber:3 UnitType:AngmarOrcWarrior Position:X:-10 Y:0 Leader 3 0	Position:X:-10 Y:20 Leader 3 1	Position:X:-10 Y:-20 Leader 3 2	Position:X:-10 Y:40 Leader 3 3	Position:X:-10 Y:-40 Leader 3 4
		
		RanksToReleaseWhenAttacking = 1
		
		MeleeAttackLeashDistance = 1; How far the hordes can move from the center of the horde when melee attacking.
	End

End
;-----------------------------------------------------------------------------------
;//----------------------------Angmar Orc Warriors Summon---------------------------
;-----------------------------------------------------------------------------------
Object AngmarSummonOrcEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 2000
		OCL = FINAL OCL_SpawnAngmarOrcWarriors
	End
End

;////////////////////////////////////////////////////////////////////////////////
Object AngmarWolfRiders

  	; This is required for garrisoned objects - please put in all objects.
	ButtonImage		= WOR_WolfRider
	SelectPortrait	= KUThrallMasterPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x1
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkIUWar
		End
	End
	
	Side = Angmar
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:AngmarWolfRiders
	DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarWolfRiders
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarWolfRiders
	
	WeaponSet
		Conditions = None 
		Weapon		= PRIMARY	NormalMeleeHordeRangefinder		; Spear
		Weapon		= SECONDARY	NormalMissileHordeRangefinder	; Bow
	End


	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


	BuildCost 		= ANGMAR_WOLFRIDER_BUILDCOST			
	BuildTime 		= ANGMAR_WOLFRIDER_BUILDTIME			
	VisionRange 		= ISENGARD_WARGRIDER_HORDE_VISION_RANGE
	
	ShroudClearingRange 	= ISENGARD_WARGRIDER_SHROUD_RANGE       
	
	VisionSide 		= 50%
	VisionRear 		= 25%
	
	MaxVisionBonusPercent 	= 300%
	VisionBonusTestRadius 	= 200
	VisionBonusPercentPerFoot = 1.0%
	
	 		
	CommandPoints 		= 20
	
	CommandSet 		= AngmarWildSpearCommandSet
		  
	FormationWidth 		= 2 		; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth 		= 1 		; Depth it occupies in formations. Current choices are 1 or 2.
	
	CrushableLevel 		= 2  		; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 		= 1 		; What can I crush?: 0 = small animals, 1 = infantry, 2 = trees, 3 = vehicles
	MinCrushVelocityPercent = 50 		; Has to be moving at at least 50% of full speed.
	CrushDecelerationPercent = 50 		; Lose 20 percent of max velocity when crushing.
	CrushKnockback 		= 40  		; how hard we knock back crushed units.
	CrushZFactor 		= 1.0  		; How much we knock upwards.
		
	
	TransportSlotCount = TRANSPORTSLOTCOUNT_LARGE_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND;UNATTACKABLE 
	
	ThreatLevel = ISENGARD_WARGRIDER_HORDE_THREAT
	ThreatBreakdown IsengardWargRiderHorde_DetailedThreat
		AIKindOf = CAVALRY
	End
	
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = CavalryHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle 	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        	= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000
		AttackPriority			= AttackPriority_Cavalry
	End

    Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	CAVALRY_FEAR_SCAN_RADIUS ;250

		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=   	BraceForBeingCrushed_Base
		AddEmotion	=	UncontrollableFear_Base_Evil
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
		AddEmotion	=   	CheerForAboutToCrush_Base
	End	
	
	Behavior = HorseHordeContain ModuleTag_HordeContain
	FrontAngle		 	= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload 		= AngmarWolfRider  10
		Slots 			= 10
		PassengerFilter 	= NONE +CAVALRY +AngmarThrallMasterBanner
		ShowPips 		= No
		RandomOffset 		= X:2 y:3
		
		MeleeBehavior 		= Amoeba
		End
		
		
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarThrallMasterWolfBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarWolfRider	Pos:X:-35.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		BannerCarrierMinLevel 	= 0
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RankInfo = RankNumber:1 UnitType:AngmarWolfRider Position:X:40 Y:0		Position:X:40 Y:25		Position:X:40 Y:-25		Position:X:40 Y:50		Position:X:40 Y:-50 
		RankInfo = RankNumber:2 UnitType:AngmarWolfRider Position:X:10 Y:0 Leader 1 0	Position:X:10 Y:25 Leader 1 1	Position:X:10 Y:-25 Leader 1 2	Position:X:10 Y:50 Leader 1 3	Position:X:10 Y:-50 Leader 1 4
		
		RanksToReleaseWhenAttacking = 1 2
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
		AttributeModifiers = IsengardWargSkirmish 
        LivingWorldOverloadTemplate = AngmarThrallMaster
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
		ScanWidth = 40.0 ; A little less than the width of the horde (which is 2 * 24 = 48)
	End

	Behavior = SpecialPowerModule ModuleTag_HowlUpdate   
		SpecialPowerTemplate      	= SpecialAbilityWargHowl
		UpdateModuleStartsAttack  	= No
		AttributeModifier 		= IsengardWargHowl 	
;		AttributeModifierRange 		= 200
		AttributeModifierAffectsSelf 	= Yes
;		AttributeModifierAffects 	= ANY +CAVALRY 
		AttributeModifierFX 		= FX_WargHowl
	End
	
	LocomotorSet
		Locomotor     = NormalCavalryHordeLocomotor ;WargCavalryHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_MOUNTED_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_IsengardBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_IsengardForgedBlades
	End

	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_IsengardHeavyArmor
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = AISpecialPowerUpdate IsengardWargRiderHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End

	;///////////////////
	; AISpecialPowers
	;///////////////////
	Behavior = AISpecialPowerUpdate HowlAI
		CommandButtonName = Command_SpecialAbilityWargHowl
		SpecialPowerAIType = AI_SPECIAL_POWER_BASIC_SELF_BUFF
	End
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	
	Geometry = BOX
	GeometryMajorRadius = 30.0
	GeometryMinorRadius = 40.0
	GeometryHeight = 20.0
	GeometryIsSmall = No


	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Cavalry
	AutoResolveCombatChain = AutoResolve_CavalryCombatChain

	AutoResolveBody = AutoResolve_GondorKnightHordeBody

	AutoResolveArmor
		RequiredUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_IsengardWargRiderHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_IsengardWargRiderArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_IsengardWargRiderUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_IsengardWargRiderWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarDarkIronBlades Upgrade_AngmarDarkIronArmor
End

;-----------------------------------------------------------------------------------------------------------------------------
ChildObject AngmarWolfRider_Summoned AngmarWolfRiders

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module.
	
	// This is to create 
	
	Side = Neutral
	
	Behavior = HorseHordeContain ModuleTag_HordeContain
	FrontAngle 			= 270
		FlankedDelay 		= 2000
		ObjectStatusOfContained = 
		InitialPayload 		= AngmarWolfRider  10
		Slots 			= 10
		PassengerFilter 	= NONE +CAVALRY 
		ShowPips 		= No
		RandomOffset 		= X:2 y:3
		
		MeleeBehavior 		= Amoeba
		End
		
		
		ThisFormationIsTheMainFormation = Yes							;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarBannerWolfRider						; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarWolfRider	Pos:X:-35.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		BannerCarrierMinLevel 	= 0
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RankInfo = RankNumber:1 UnitType:AngmarWolfRider Position:X:40 Y:0		Position:X:40 Y:15		Position:X:40 Y:-15		Position:X:40 Y:30		Position:X:40 Y:-30 
		RankInfo = RankNumber:2 UnitType:AngmarWolfRider Position:X:10 Y:0 Leader 1 0	Position:X:10 Y:15 Leader 1 1	Position:X:10 Y:-15 Leader 1 2	Position:X:10 Y:30 Leader 1 3	Position:X:10 Y:-30 Leader 1 4
		
		RanksToReleaseWhenAttacking 	= 1 2
		MeleeAttackLeashDistance	= 25							; How far the hordes can move from the center of the horde when melee attacking.
		AttributeModifiers 		= IsengardWargSkirmish 
        LivingWorldOverloadTemplate 		= AngmarThrallMaster
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	// This one displays the timer, but the one in the uint does the work 
		MinLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		MaxLifetime		= CREATE_A_HERO_REINFORCEMENT_LIFETIME
		DeathType		= FADED
	End	
End




;---------------------------------------------------------------------------------------------------------------------------

Object AngmarRhudaurSpearmen

	// This is required for garrisoned objects - please put in all objects.
	ButtonImage		= KUSummonSpearmenIcon
	SelectPortrait	= KUThrallMasterPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None //InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkGUTow
		End
	End
	
	Side = Angmar
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:AngmarRhudaurSpearmen
	DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarRhudaurSpearmen
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarRhudaurSpearmen
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    TowerGuardHordeRangefinder
	End

	// *** AUDIO Parameters ***//
	// Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	// are always passed through to members


	BuildCost = ANGMAR_RHUDAURSPEAR_BUILDCOST
	BuildTime = ANGMAR_RHUDAURSPEAR_BUILDTIME
	
	VisionRange = ANGMAR_RHUDAURSPEAR_HORDE_VISION_RANGE	
	ShroudClearingRange = ANGMAR_RHUDAURSPEAR_SHROUD_RANGE       

	
	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 1.0%
	
	CommandPoints = 15
	
	CommandSet = AngmarWildSpearCommandSet

	FormationWidth = 2 // Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 // Depth it occupies in formations. Current choices are 1 or 2.
	
 	CrushableLevel = 0  //What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0
 
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY MELEE_HORDE PIKE LARGE_RECTANGLE_PATHFIND
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End

	ThreatLevel = ANGMAR_RHUDAURSPEAR_HORDE_THREAT
	ThreatBreakdown IsengardWildmanHorde_DetailedThreat
		AIKindOf = PIKEMAN
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = PikeHorde
    End
		
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	=	Yes ATTACK_BUILDINGS
		MoodAttackCheckRate			=	500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		AILuaEventsList				=	InfantryFunctions
		AttackPriority				= 	AttackPriority_Spearman
	End
	
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 180
		FlankedDelay = 4000
		ObjectStatusOfContained = 
		InitialPayload = AngmarRhudaurSpearman EVIL_MEN_BIG_HORDE_SIZE
		Slots = 15
		PassengerFilter	= NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset=X:0 Y:0
		MeleeBehavior = Amoeba
			FacingBonus			=	30.0
			AngleLimitCos		=	-0.17
			InnerRange			=	30
			OuterRange			=	80
			OuterRangeBuildings	=	140
		End

		// Banner Carrier info		
		BannerCarriersAllowed	= AngmarThrallMasterBanner	// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarRhudaurSpearman	Pos:X:-35.0 Y:0.0		// (DEFAULT) position of banner carrier
		BannerCarrierMinLevel   = 0
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RankInfo = RankNumber:1 UnitType:AngmarRhudaurSpearman Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarRhudaurSpearman Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarRhudaurSpearman Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 

		AlternateFormation = AngmarRhudaurSpearmenPorcupine
		MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		 = 1	//The minimum number of	cells to backup
		BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
		BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
        LivingWorldOverloadTemplate = AngmarThrallMaster
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
   	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		// max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	// how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
 		AfraidOf					=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf				=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
 		PointAt						=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance			=	150
		FearScanDistance			=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		//	AddEmotion			=   BraceForBeingCrushed_Base		// Pikemen don't fear getting crushed
		AddEmotion			=	UncontrollableFear_Base
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		
		AddEmotion			=	OVERRIDE Taunt_Base	
 		//	AttributeModifier	=	GondorFighterTaunt
 		End		
 		
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_AngmarBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	/////////////////////
	// AISpecialPowers
	/////////////////////
	

	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	Behavior = AISpecialPowerUpdate GondorTowerShieldGuardHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Geometry = BOX
	GeometryMajorRadius = 30.0
	GeometryMinorRadius = 45.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
	
	
	// *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Pikemen
	AutoResolveCombatChain = AutoResolve_PikemenCombatChain
	
	AutoResolveBody = AutoResolve_GondorTowerGuardHordeBody
	
	AutoResolveArmor
		RequiredUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_GondorTowerGuardHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_AngmarDarkIronArmor
		Armor = AutoResolve_GondorTowerGuardArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_GondorTowerGuardUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_AngmarDarkIronBlades
		Weapon = AutoResolve_GondorTowerGuardWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_AngmarBasicTraining Upgrade_AngmarDarkIronBlades Upgrade_AngmarDarkIronArmor	
End

ChildObject AngmarRhudaurSpearmenPorcupine AngmarRhudaurSpearmen

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module. 
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 360	//	Can't be flanked
		FlankedDelay = 2000
		ObjectStatusOfContained = 
		InitialPayload					= AngmarRhuduarSpearman GOOD_MEN_HORDE_SIZE
		Slots							= 15
		PassengerFilter					= NONE +INFANTRY
		ShowPips						= No
		ThisFormationIsTheMainFormation = No	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset					= X:2 Y:1
		RanksToReleaseWhenAttacking		= 0
		RanksToJustFreeWhenAttacking   = 0
		AttributeModifiers				= AngmarRhudaurSpearmenPorcupine
		IsPorcupineFormation			= Yes
		MinimumHordeSize				= 5

		AlternateFormation				= AngmarRhudaurSpearmen
		VisionRearOverride				= 100%
		VisionSideOverride				= 100%
		NotComboFormation				= Yes // this formation is not suitable for combo, so it will switch out of this when combo-ing

		// Banner Carrier info		
		BannerCarriersAllowed			= AngmarThrallMasterBanner												// types of units that are allowed as banner carriers
		BannerCarrierPosition			= UnitType:AngmarRhuduarSpearman	Pos:X:0.0 Y:0.0		// (DEFAULT) position of banner carrier
		BannerCarrierMinLevel 			= 0
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RankInfo	= RankNumber:1 UnitType:AngmarRhuduarSpearman Position:X:20 Y:0	Position:X:-16.18 Y:11.76		Position:X:6.18 Y:-19.02	Position:X:6.18 Y:19.02	Position:X:-16.18 Y:-11.76	Position:X:36.54 Y:16.27	Position:X:-39.13 Y:8.32	Position:X:26.77 Y:-29.73	Position:X:-4.18 Y:39.78	Position:X:-20 Y:-34.64	Position:X:26.77 Y:29.73	Position:X:-39.13 Y:-8.32	Position:X:36.54 Y:-16.27	Position:X:-20 Y:34.64	Position:X:-4.18 Y:-39.78
        LivingWorldOverloadTemplate = AngmarThrallMaster
	End
End

ChildObject AngmarRhudaurSpearmenNoBanner AngmarRhudaurSpearmen

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module.
	
	// This is to create 
	
	Side = Neutral
	
	Behavior = HordeContain ModuleTag_HordeContain
			FrontAngle = 180
			FlankedDelay = 4000
			ObjectStatusOfContained = 
			InitialPayload = AngmarRhudaurSpearman EVIL_MEN_BIG_HORDE_SIZE
			Slots = 15
			PassengerFilter	= NONE +INFANTRY
			ShowPips = No
			ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
			RandomOffset=X:0 Y:0
			MeleeBehavior = Amoeba
				FacingBonus			=	30.0
				AngleLimitCos		=	-0.17
				InnerRange			=	30
				OuterRange			=	80
				OuterRangeBuildings	=	140
			End
	
			// Banner Carrier info		
			BannerCarriersAllowed	= AngmarThrallMasterBanner	// types of units that are allowed as banner carriers
			BannerCarrierPosition	= UnitType:AngmarRhudaurSpearman	Pos:X:-35.0 Y:0.0		// (DEFAULT) position of banner carrier
			BannerCarrierMinLevel   = 6
			BannerCarrierDestroyHordeOnDeath = Yes
			BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
			
			RankInfo = RankNumber:1 UnitType:AngmarRhudaurSpearman Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
			RankInfo = RankNumber:2 UnitType:AngmarRhudaurSpearman Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
			RankInfo = RankNumber:3 UnitType:AngmarRhudaurSpearman Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
			
			RanksToReleaseWhenAttacking = 1 
	
			AlternateFormation = AngmarRhudaurSpearmenPorcupine
			MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
			BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
			BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
			BackUpMinDistance		 = 1	//The minimum number of	cells to backup
			BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
			BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
            LivingWorldOverloadTemplate = AngmarThrallMaster
	End
End

ChildObject AngmarRhudaurSpearmenArnorBanner AngmarRhudaurSpearmen

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module.
	
	// This is to create 
	
	Side = Neutral
	
	Behavior = HordeContain ModuleTag_HordeContain
		FrontAngle = 180
		FlankedDelay = 4000
		ObjectStatusOfContained = 
		InitialPayload = AngmarRhudaurSpearman EVIL_MEN_BIG_HORDE_SIZE
		Slots = 15
		PassengerFilter	= NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	//Used to determine which armorset to use (and anything else we want!)
		RandomOffset=X:0 Y:0
		MeleeBehavior = Amoeba
			FacingBonus			=	30.0
			AngleLimitCos		=	-0.17
			InnerRange			=	30
			OuterRange			=	80
			OuterRangeBuildings	=	140
		End

		// Banner Carrier info		
		BannerCarriersAllowed	= ArnorInfantryBanner	// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarRhudaurSpearman	Pos:X:70.0 Y:0.0		// (DEFAULT) position of banner carrier
		BannerCarrierMinLevel   = 0
		BannerCarrierDestroyHordeOnDeath = No
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		RankInfo = RankNumber:1 UnitType:AngmarRhudaurSpearman Position:X:50 Y:0		Position:X:50 Y:20		Position:X:50 Y:-20		Position:X:50 Y:40		Position:X:50 Y:-40 
		RankInfo = RankNumber:2 UnitType:AngmarRhudaurSpearman Position:X:30 Y:0 Leader 1 0	Position:X:30 Y:20 Leader 1 1	Position:X:30 Y:-20 Leader 1 2	Position:X:30 Y:40 Leader 1 3	Position:X:30 Y:-40 Leader 1 4
		RankInfo = RankNumber:3 UnitType:AngmarRhudaurSpearman Position:X:10 Y:0 Leader 2 0	Position:X:10 Y:20 Leader 2 1	Position:X:10 Y:-20 Leader 2 2	Position:X:10 Y:40 Leader 2 3	Position:X:10 Y:-40 Leader 2 4
		
		RanksToReleaseWhenAttacking = 1 

		AlternateFormation = AngmarRhudaurSpearmenPorcupine
		MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		 = 1	//The minimum number of	cells to backup
		BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
		BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
        LivingWorldOverloadTemplate = AngmarThrallMaster
	End
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RhudaurSpearmenHorde_Summoned AngmarRhudaurSpearmen
	IsTrainable = No
	CommandPoints = 0
	CommandSet = AngmarWildSpearCommandSet
	EquivalentTo = AngmarRhudaurSpearmen

	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE PIKE MELEE_HORDE SUMMONED LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	; This one displays the timer, but the one in the uint does the work 
		MinLifetime		= ANGMAR_RHUDAURSPEAR_SUMMON_DURATION
		MaxLifetime		= ANGMAR_RHUDAURSPEAR_SUMMON_DURATION
		DeathType		= FADED
	End	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RhudaurSpearman_Summoned 12
		Slots = 12
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:RhudaurSpearman_Summoned Position:X:27 Y:1	Position:X:30 Y:18		Position:X:28 Y:-21		Position:X:30 Y:38		
		RankInfo = RankNumber:2 UnitType:RhudaurSpearman_Summoned Position:X:9 Y:2		Position:X:8 Y:19		Position:X:10 Y:-22		Position:X:11 Y:39	
		RankInfo = RankNumber:3 UnitType:RhudaurSpearman_Summoned Position:X:-10 Y:-1	Position:X:-12 Y:22		Position:X:-10 Y:-18	Position:X:-11 Y:40	
		
		RanksToReleaseWhenAttacking = 1 
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
	
End

;------------------------------------------------------------------------------
Object Hillman1SummonEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 2000
		OCL = FINAL OCL_Hwaldar_SpawnHillmen_Level1
	End
End
;------------------------------------------------------------------------------
Object Hillman2SummonEgg
	Draw = W3DScriptedModelDraw ModuleTag_Draw
		DefaultModelConditionState
			Model = None
		End
	End
	KindOf = INERT IMMOBILE UNATTACKABLE
	
	Body = ActiveBody ModuleTag_MakesKillWork
		MaxHealth = 1
	End
	Behavior = LifetimeUpdate ModuleTag_HatchTrigger
		MinLifetime = 0.0
		MaxLifetime = 0.0
	End
	Behavior = SlowDeathBehavior ModuleTag_HatchProcess
		DestructionDelay = 2000
		OCL = FINAL OCL_Hwaldar_SpawnHillmen_Level2
	End
End


;////////////////////////////////////////////////////////////////////////////////
Object AngmarRhudaurSlingers

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage		= KUSummonAxeThrowerIcon
	SelectPortrait	= KUThrallMasterPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_LOOK_TO_SKY
		DefaultModelConditionState
			Model = None //InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkGUTow
		End
	End
	
	Side 			= Angmar
	EditorSorting 		= UNIT
	EmotionRange 		= 240
	DisplayName 		= OBJECT:AngmarRhudaurSlingers
	DisplayNameStrategic 	= CONTROLBAR:LW_Unit_AngmarRhudaurSlingers
	DescriptionStrategic 	= CONTROLBAR:LW_ToolTip_AngmarRhudaurSlingers
	
	WeaponSet
		Conditions 	= None 
		Weapon		= PRIMARY    DwarvenMissileHordeRangefinder
	End
	
	CommandSet =  AngmarWildMissileHordeCommandSet

	; *** AUDIO Parameters ***
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"


 	CrushableLevel 		= 0  			; What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 		= 0
	UseCrushAttack 		= No			;Archer hordes cannot crush or Bombard will not work
	
	BuildCost = ANGMAR_RHUDAURSLING_BUILDCOST
	BuildTime = ANGMAR_RHUDAURSLING_BUILDTIME
	
	VisionRange = ANGMAR_RHUDAURSLING_HORDE_VISION_RANGE	
	ShroudClearingRange = ANGMAR_RHUDAURSLING_SHROUD_RANGE

	VisionSide = 50%
	VisionRear = 25%
	
	MaxVisionBonusPercent = 300%
	VisionBonusTestRadius = 200
	VisionBonusPercentPerFoot = 1.0%
	
	CommandPoints = 0
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND;UNATTACKABLE 
	
	ThreatLevel = ANGMAR_RHUDAURSPEAR_HORDE_THREAT
	ThreatBreakdown IsengardWildmanHorde_DetailedThreat
		AIKindOf = ARCHER
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End

	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate			= 500
		MaxCowerTime				= 5000
		MinCowerTime				= 3000
		CanAttackWhileContained		= Yes  ; Can fire out of garrisoned building	
        AILuaEventsList				= InfantryFunctions  
        AttackPriority				=  AttackPriority_Archer      
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = AngmarRhudaurSlinger 10
		Slots = 10
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		MeleeBehavior = Amoeba
		End

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarThrallMasterBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarRhudaurSlinger		Pos:X:-35.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		BannerCarrierMinLevel	= 0
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
		
		; Positions for 5
		RandomOffset = X:5 Y:3
		
		RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:0 Y:0	Position:X:0 Y:25	Position:X:0 Y:-25	Position:X:0 Y:50	Position:X:0 Y:-50 
		RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:20 Y:0	Position:X:15 Y:25	Position:X:20 Y:-25	Position:X:20 Y:50	Position:X:20 Y:-50 

		RanksToReleaseWhenAttacking = 1 2 
				
		MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
		BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
		BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
		BackUpMinDistance		 = 1	//The minimum number of	cells to backup
		BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
		BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.
        LivingWorldOverloadTemplate = AngmarThrallMaster
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf				=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
 		PointAt						=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	CAVALRY_FEAR_SCAN_RADIUS

		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base
		AddEmotion			=	Point_Base
		AddEmotion			=	Taunt_Base
 		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base
	End	
		
	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_FAST_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_DwarvenBasicTraining
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_DwarvenFireArrows
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_DwarvenMithrilMail
	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End
	
	/////////////////////
	// AISpecialPowers
	/////////////////////
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End
	Behavior = AISpecialPowerUpdate DwarvenMenOfDaleHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 60.0
	GeometryHeight = 10.0
	GeometryIsSmall = No
	
	
	; *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Archer
	AutoResolveCombatChain = AutoResolve_ArcherCombatChain
	
	AutoResolveBody = AutoResolve_DwarvenMenOfDaleHordeBody
	
	AutoResolveArmor
		RequiredUpgrades = Upgrade_DwarvenMithrilMail
		Armor = AutoResolve_DwarvenMenOfDaleHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_DwarvenMithrilMail
		Armor = AutoResolve_DwarvenMenOfDaleArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_DwarvenFireArrows
		Weapon = AutoResolve_DwarvenMenOfDaleUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_DwarvenFireArrows
		Weapon = AutoResolve_DwarvenMenOfDaleWeapon
	End
	
	WorldMapArmoryUpgradesAllowed = Upgrade_DwarvenBasicTraining Upgrade_DwarvenFireArrows Upgrade_DwarvenMithrilMail	
End

ChildObject AngmarRhudaurSlingersNoBanner AngmarRhudaurSlingers

	// Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	// Any modifications need to be done via the Attribute Modifiers in the contain module.
	
	// This is to create 
	
	Side = Neutral
	
	Behavior = HordeContain ModuleTag_HordeContain
			ObjectStatusOfContained = 
			InitialPayload = AngmarRhudaurSlinger 10
			Slots = 10
			PassengerFilter = NONE +INFANTRY
			ShowPips = No
			ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
			MeleeBehavior = Amoeba
			End
	
			; Banner Carrier info		
			BannerCarriersAllowed	= AngmarThrallMasterBanner										; types of units that are allowed as banner carriers
			BannerCarrierPosition	= UnitType:AngmarRhudaurSlinger		Pos:X:-35.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
			BannerCarrierMinLevel	= 6
			BannerCarrierDestroyHordeOnDeath = Yes
			BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
			
			; Positions for 5
			RandomOffset = X:5 Y:3
			
			RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:0 Y:0	Position:X:0 Y:25	Position:X:0 Y:-25	Position:X:0 Y:50	Position:X:0 Y:-50 
			RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:20 Y:0	Position:X:15 Y:25	Position:X:20 Y:-25	Position:X:20 Y:50	Position:X:20 Y:-50 
	
			RanksToReleaseWhenAttacking = 1 2 
					
			MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
			BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
			BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
			BackUpMinDistance		 = 1	//The minimum number of	cells to backup
			BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
			BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.

            LivingWorldOverloadTemplate = AngmarThrallMaster
	End
End

ChildObject AngmarRhudaurSlingersFree AngmarRhudaurSlingers
	BuildCost = 0
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER LARGE_RECTANGLE_PATHFIND
	Behavior = HordeContain ModuleTag_HordeContain
			ObjectStatusOfContained = 
			InitialPayload = AngmarRhudaurSlinger 10
			Slots = 10
			PassengerFilter = NONE +INFANTRY
			ShowPips = No
			ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
			MeleeBehavior = Amoeba
			End
	
			; Banner Carrier info		
			BannerCarriersAllowed	= AngmarThrallMasterBanner										; types of units that are allowed as banner carriers
			BannerCarrierPosition	= UnitType:AngmarRhudaurSlinger		Pos:X:-35.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
			BannerCarrierMinLevel	= 6
			BannerCarrierDestroyHordeOnDeath = Yes
			BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
			
			; Positions for 5
			RandomOffset = X:5 Y:3
			
			RankInfo = RankNumber:1 UnitType:AngmarRhudaurSlinger Position:X:0 Y:0	Position:X:0 Y:25	Position:X:0 Y:-25	Position:X:0 Y:50	Position:X:0 Y:-50 
			RankInfo = RankNumber:2 UnitType:AngmarRhudaurSlinger Position:X:20 Y:0	Position:X:15 Y:25	Position:X:20 Y:-25	Position:X:20 Y:50	Position:X:20 Y:-50 
	
			RanksToReleaseWhenAttacking = 1 2 
					
			MeleeAttackLeashDistance = 1   //How far the hordes	can	move from the center of	the	horde when melee attacking.				  
			BackUpMinDelayTime		 = 1	//The minimum amount of	time to	delay before backing up
			BackUpMaxDelayTime		 = 3000	//The maximum amount of	time to	delay before backing up
			BackUpMinDistance		 = 1	//The minimum number of	cells to backup
			BackUpMaxDistance		 = 3	//The maximum number of	cells to backup
			BackupPercentage		 = 80%	//The amount of	chance that	a unit will	back up.

            LivingWorldOverloadTemplate = AngmarThrallMaster
	End
End


;////////////////////////////////////////////////////////////////////////////////
ChildObject RhudaurSlingerHorde_Summoned AngmarRhudaurSlingers
	IsTrainable = No
	CommandPoints = 0
	CommandSet = AngmarWildMissileHordeCommandSet
	EquivalentTo = AngmarRhudaurSlingers

	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE SUMMONED LARGE_RECTANGLE_PATHFIND CAN_USE_SIEGE_TOWER
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	; This one displays the timer, but the one in the uint does the work 
		MinLifetime		= ANGMAR_RHUDAURSLING_SUMMON_DURATION
		MaxLifetime		= ANGMAR_RHUDAURSLING_SUMMON_DURATION
		DeathType		= FADED
	End	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RhudaurSlinger_Summoned 12
		Slots = 12
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		MeleeBehavior = Amoeba
		End
		
		RankInfo = RankNumber:1 UnitType:RhudaurSlinger_Summoned Position:X:27 Y:1	Position:X:30 Y:18		Position:X:28 Y:-21		Position:X:30 Y:38		
		RankInfo = RankNumber:2 UnitType:RhudaurSlinger_Summoned Position:X:9 Y:2		Position:X:8 Y:19		Position:X:10 Y:-22		Position:X:11 Y:39	
		RankInfo = RankNumber:3 UnitType:RhudaurSlinger_Summoned Position:X:-10 Y:-1	Position:X:-12 Y:22		Position:X:-10 Y:-18	Position:X:-11 Y:40	
		
		RanksToReleaseWhenAttacking = 1 2 3
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
	
End

;------------------------------------------------------------------------------

;---------------------------------------------------------------------
;---------------------New "Necromancer" horde test--------------------
;---------------------------------------------------------------------
;---------------------------------------------------------------------

Object AngmarNecromancerHorde

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage		= WOR_Necromancer
	SelectPortrait	= KUNecromancerPortrait

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER EMOTION_TERROR EMOTION_LOOK_TO_SKY SELECTED
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End

		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkEUDFG
		End		
	AnimationState = JUST_BUILT
		BeginScript
			CurDrawableHideSubObject("BlueFlame")
			CurDrawableHideSubObject("PurpleFlame")
			CurDrawableHideSubObject("GreenFlame")
			CurDrawableHideSubObject("BlueGlow")
			CurDrawableHideSubObject("PurpleGlow")
			CurDrawableHideSubObject("GreenGlow")
		EndScript
	End
	
	End
	
	Side = Angmar
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeNecromancerGuardian
	DisplayNameStrategic = CONTROLBAR:LW_Unit_AngmarNecromancerHorde
	DescriptionStrategic = CONTROLBAR:LW_ToolTip_AngmarNecromancerHorde
		
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End

	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members
	#include "..\..\..\includes\StandardHordeEvaEvents.inc"

	UnitSpecificSounds
		VoiceDesperateAttack  = GondorSoldierVoiceDesperateCharge 
	End

	BuildCost 			= ANGMAR_NECRO_BUILDCOST
	BuildTime 			= ANGMAR_NECRO_BUILDTIME      
	VisionRange 			= ANGMAR_NECRO_HORDE_VISION_RANGE
	ShroudClearingRange 		= ANGMAR_NECRO_SHROUD_RANGE
	VisionSide 			= 50%
	VisionRear 			= 25%
	
	MaxVisionBonusPercent 		= 300%
	VisionBonusTestRadius 		= 200
	VisionBonusPercentPerFoot 	= 1.0%
	CommandPoints 			= 40		; originally 60
	
	FormationWidth 			= 2 		; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth 			= 2 		; Depth it occupies in formations. Current choices are 1 or 2.
	
	CrushableLevel 			= 0  		;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel 			= 1 
	
	CrushOnlyWhileCharging 		= YES 		; // the guardian is only supposed to crush during his special charge ability
	
	MinCrushVelocityPercent 	= 50% 		; Has to be moving at least xx% of full speed
	CrushDecelerationPercent 	= 90% 		; Lose xx% max velocity when crushing -- thus they only crush 1 row of infantry
	
	CrushKnockback 			= 40  		; how hard we knock back crushed units.
	CrushZFactor 			= 1.0 		; How much we knock upwards.

    TransportSlotCount = TRANSPORTSLOTCOUNT_SMALL_HORDE
	KindOf = SELECTABLE SUPPORT ATTACK_NEEDS_LINE_OF_SIGHT ARCHER HORDE NOTIFY_OF_PREATTACK ARMY_SUMMARY LARGE_RECTANGLE_PATHFIND INFANTRY PATH_THROUGH_INFANTRY ;;UNATTACKABLE 
	
	ThreatLevel = ANGMAR_NECRO_HORDE_THREAT
	ThreatBreakdown AngmarGuardianHorde_DetailedThreat
		AIKindOf = ARCHER
	End
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
;	Behavior = ExperienceLevelCreate ModuleTag_LevelBonus
;		LevelToGrant	= 2
;		MPOnly		= No
;	End
	
	
	Behavior = StancesBehavior ModuleTag_StancesBehavior
        StanceTemplate = ArcherHorde
    End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate		= 500
		MaxCowerTime			= 5000
		MinCowerTime			= 3000

		CanAttackWhileContained		= Yes  ; Can fire out of garrisoned building
		AILuaEventsList			= InfantryFunctions	; 
		AttackPriority			= AttackPriority_Infantry
	End

	Behavior 				= HordeContain ModuleTag_HordeContain
		FrontAngle 			= 270
		FlankedDelay 			= 2000
		ObjectStatusOfContained		= 
		InitialPayload			= AngmarNecroAcolyte 7
		Slots				= 7
		PassengerFilter			= NONE +ARCHER
		ShowPips				= No
		ThisFormationIsTheMainFormation = Yes	;//Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:10 Y:10
		
		MeleeBehavior = Amoeba

        ;AlternateFormation			= AngmarPhalanxHorde
        ;IsPorcupineFormation			= Yes

		End					

		; Banner Carrier info		
		BannerCarriersAllowed	= AngmarNecromancerBanner										;// types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:AngmarNecromancerBanner	Pos:X:0.0 Y:0.0		;// (DEFAULT) position of banner carrier
		BannerCarrierDestroyHordeOnDeath = Yes
		BannerCarrierHordeDeathType = +NORMAL ;NORMAL, NONE, CRUSHED, BURNED, EXPLODED, POISONED, TOPPLED, FLOODED, SUICIDED, LASERED, DETONATED, SPLATTED, POISONED_BETA, EXTRA_2, EXTRA_3, EXTRA_4, EXTRA_5, EXTRA_6, EXTRA_7, EXTRA_8, KNOCKBACK, SUPERNATURAL, FADED, SLAUGHTERED
      		BannerCarrierMinLevel   = 0;

		RankInfo	= RankNumber:1 UnitType:AngmarNecroAcolyte Position:X:20 Y:0	Position:X:-16.18 Y:11.76		Position:X:6.18 Y:-19.02	Position:X:6.18 Y:19.02	Position:X:-16.18 Y:-11.76	Position:X:36.54 Y:16.27	Position:X:-39.13 Y:8.32	Position:X:26.77 Y:-29.73	Position:X:-4.18 Y:39.78	Position:X:-20 Y:-34.64	Position:X:26.77 Y:29.73	Position:X:-39.13 Y:-8.32	Position:X:36.54 Y:-16.27	Position:X:-20 Y:34.64	Position:X:-4.18 Y:-39.78

		;// Positions for 5
		
		RanksToReleaseWhenAttacking	= 1 
		
		MeleeAttackLeashDistance	= 25		;// How far the hordes can move from the center of the horde when melee attacking.				
		BackUpMinDelayTime		= 1		;// The minimum amount of time to delay before backing up
		BackUpMaxDelayTime		= 3000		;// The maximum amount of time to delay before backing up
		BackUpMinDistance		= 1		;// The minimum number of cells to backup
		BackUpMaxDistance		= 3		;// The maximum number of cells to backup
		BackupPercentage		= 80%		;// The amount of chance that a unit will back up.
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
	End
  
	Behavior = HordeNotifyTargetsOfImminentProbableCrushingUpdate ModuleTag_NotifyCrushScan
		ScanWidth = 60.0 ; A little less than the width of the horde (which is 2 * 35 = 70)
	End
	
	#include "..\..\..\includes\CaptureBuilding.inc"

   	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000					; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
 		AfraidOf			=	EMOTION_AFRAIDOF_OBJECTFILTER
		AlwaysAfraidOf			=	EMOTION_ALWAYS_AFRAIDOF_OBJECTFILTER
 		PointAt				=	EMOTION_POINTAT_OBJECTFILTER
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS

		AddEmotion			=	Terror_Base
		AddEmotion			=	Doom_Base
		AddEmotion			=   	BraceForBeingCrushed_Base
		AddEmotion			=	UncontrollableFear_Base
		AddEmotion			=	FearIdle_Base
		AddEmotion			=	FearBusy_Base

		;AddEmotion			=	Point_Base
		;AddEmotion			=	Taunt_Base

 		AddEmotion			=	CheerIdle_Base
		AddEmotion			=	CheerBusy_Base
		AddEmotion			=	HeroCheerIdle_Base
		AddEmotion			=	HeroCheerBusy_Base
		AddEmotion			=	Alert_Base

		;AddEmotion			=   	CheerForAboutToCrush_Base
	End	
  
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
	End
	
	LocomotorSet
		Locomotor     = ScaredMeleeHordeLocomotor
		Condition     = SET_SCARED
		Speed         = NORMAL_FOOT_SLOW_HORDE_SPEED
	End
	
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

;	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
;		TriggeredBy = Upgrade_DwarvenBasicTraining
;		LevelsToGain = 1
;		LevelCap = 2
;	End
;	
;	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality1
;		TriggeredBy = Upgrade_DwarvenSiegeHammer
;	End
;	
;	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
;		TriggeredBy = Upgrade_DwarvenForgedBlades
;	End
;	
;	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
;		TriggeredBy = Upgrade_DwarvenMithrilMail
;	End
	
	Behavior = PickupStuffUpdate ModuleTag_PickupStuffUpdate
		SkirmishAIOnly = Yes
		StuffToPickUp = NONE +CRATE
		ScanRange = 200
		ScanIntervalSeconds = 0.5
	End

    ;--------------------Upgraded Command Sets-------------------------------------
  	Behavior = CommandSetUpgrade ModuleTag_commandSetWellOfSouls
		TriggeredBy 			= Upgrade_AngmarWellOfSouls
		CommandSet 			= AngmarNecromancerHordeWellCommandSet
	End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_unpauseWellOfSouls
		TriggeredBy 			= Upgrade_AngmarWellOfSouls
		SpecialPowerTemplate = SpecialAbilityNecroWellOfSouls
	End

  	Behavior = CommandSetUpgrade ModuleTag_commandSetSoulFreeze
		TriggeredBy 			= Upgrade_AngmarSoulFreeze
		CommandSet 			= AngmarNecromancerHordeFreezeCommandSet
	End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_unpauseSoulFreeze
		TriggeredBy 			= Upgrade_AngmarSoulFreeze
		SpecialPowerTemplate = SpecialAbilityNecroSoulFreeze
	End

  	Behavior = CommandSetUpgrade ModuleTag_commandSetCorpseRain
		TriggeredBy 			= Upgrade_AngmarCorpseRain
		CommandSet 			= AngmarNecromancerHordeRainCommandSet
	End

	Behavior = UnpauseSpecialPowerUpgrade ModuleTag_unpauseCorpseRain
		TriggeredBy 			= Upgrade_AngmarCorpseRain
		SpecialPowerTemplate = SpecialAbilityNecroCorpseRain
	End

	Behavior = SubObjectsUpgrade ModuleTag_StaffWellOfSouls
		TriggeredBy 			= Upgrade_AngmarWellOfSouls
		ShowSubObjects	= PurpleFlame PurpleGlow
		HideSubObjects = MultiFlame MultiGlow BlueFlame BlueGlow GreenFlame GreenGlow
	End
	
	Behavior = SubObjectsUpgrade ModuleTag_StaffSoulFreeze
		TriggeredBy 			= Upgrade_AngmarSoulFreeze
		ShowSubObjects	= BlueFlame BlueGlow
		HideSubObjects = MultiFlame MultiGlow PurpleFlame PurpleGlow GreenFlame GreenGlow
	End

	
	Behavior = SubObjectsUpgrade ModuleTag_StaffCorpseRain
		TriggeredBy 			= Upgrade_AngmarCorpseRain
		ShowSubObjects	= GreenFlame GreenGlow
		HideSubObjects = MultiFlame MultiGlow PurpleFlame PurpleGlow BlueFlame BlueGlow
	End


;--------------------Necro Death Mask Power--------------------------------
;	Behavior = SpecialPowerModule ModuleTag_NecroDeathMaskUpdate
;		SpecialPowerTemplate		= SpecialAbilityFakeLeadership
;		UpdateModuleStartsAttack	= Yes
;		StartsPaused			= No
;	End
;
;	Behavior = AttributeModifierAuraUpdate ModuleTag_DeathMask
;		StartsActive			= Yes ;If no, requires upgrade to turn on.
;		BonusName			= DeathMaskModifier
;		RefreshDelay			= 2000
;		Range				= ANGMAR_NECRO_DEATH_MASK_RANGE
;		TargetEnemy			= Yes
;		AntiCategory			= LEADERSHIP BUFF ; This means cancel all previous leadership bonuses
;		ObjectFilter			= ANY +INFANTRY +CAVALRY -STRUCTURE -BASE_FOUNDATION -HERO -HORDE
;;	End

;--------------------Necro Black Ice power---------------------------------
	Behavior = SpecialPowerModule ModuleTag_NecroBlackIceStarter
		SpecialPowerTemplate		= SpecialAbilityNecroBlackIce
		StartsPaused			= No
 		UpdateModuleStartsAttack	= Yes
	End

	Behavior = ActivateModuleSpecialPower ModuleTag_NecroBlackIceMover
		SpecialPowerTemplate		= SpecialAbilityNecroBlackIce
		StartAbilityRange		= ANGMAR_NECRO_BLACK_ICE_START_RANGE
		TriggerSpecialPower		= ModuleTag_NecroBlackIceBlastTrigger TARGETPOS
		TriggerSpecialPower		= ModuleTag_NecroBlackIceBlastWeapon TARGETPOS
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroBlackIceBlastWeaponFireUpdate   
		SpecialPowerTemplate    	= SpecialAbilityNecroBlackIceWeaponStarter
		WhichSpecialWeapon		= 2
		SkipContinue			= Yes
		FreezeAfterTriggerDuration 	= 100 ; Hold AI for this long after we fire.
		UnpackTime					= 700
		PreparationTime				= 1   
		;PersistentPrepTime			= 1000
		PackTime					= 100
		AwardXPForTriggering    	= 0		
		StartAbilityRange		= ANGMAR_NECRO_BLACK_ICE_START_RANGE		
		TriggerSound = NecroVoiceModeBlackIce 
		SpecialWeapon			= AngmarNecroBlackIceWeapon
	End

	
	Behavior = SpecialPowerModule ModuleTag_NecroBlackIceBlastTrigger
		SpecialPowerTemplate		= SpecialAbilityNecroBlackIceFXStarter
		TriggerFX					= FX_BlackIce
		UpdateModuleStartsAttack	= No
		StartsPaused				= No
   	End
   	
	Behavior = SpecialPowerModule ModuleTag_NecroBlackIceBlastWeapon
		SpecialPowerTemplate		= SpecialAbilityNecroBlackIceWeaponStarter
		UpdateModuleStartsAttack	= No
		StartsPaused				= No
   	End
	
	Behavior = SpecialPowerModule ModuleTag_BarrowCorruptTrigger
		SpecialPowerTemplate		= SpecialAbilityBarrowCorruptFXStarter
		TriggerFX					= FX_BarrowCorruption
		UpdateModuleStartsAttack	= No
		StartsPaused				= No
   	End
	
;----------------------Necro Soul Freeze power---------------------------------------	
	Behavior = SpecialPowerModule ModuleTag_NecroSoulFreezeStarter
		SpecialPowerTemplate		= SpecialAbilityNecroSoulFreeze
		StartsPaused			= Yes
 		UpdateModuleStartsAttack	= Yes
		;TriggerFX              		= FX_SoulFreezeCast
		;TriggerFX              	= FX_SoulFreezeCastBone
	End
	
	Behavior = ActivateModuleSpecialPower ModuleTag_NecroSoulFreezeMover
		SpecialPowerTemplate		= SpecialAbilityNecroSoulFreeze
		StartAbilityRange		= ANGMAR_NECRO_SOUL_FREEZE_START_RANGE
		TriggerSpecialPower		= ModuleTag_NecroSoulFreezeBlastTrigger TARGETPOS
		TriggerSpecialPower		= ModuleTag_NecroSoulFreezeBlastWeapon TARGETPOS		
	End
	
	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroSoulFreezeBlastWeaponFireUpdate   
		SpecialPowerTemplate    	= SpecialAbilityNecroSoulFreezeWeaponStarter
		WhichSpecialWeapon		= 3
		SkipContinue			= Yes
		FreezeAfterTriggerDuration 	= 100 ; Hold AI for this long after we fire.
		UnpackTime			= 700
		PreparationTime			= 1   
		;PersistentPrepTime		= 1000
		PackTime			= 100
		AwardXPForTriggering    	= 0		
		StartAbilityRange		= ANGMAR_NECRO_SOUL_FREEZE_START_RANGE		
	       	TriggerSound = NecroVoiceModeSoulFreeze 
		SpecialWeapon			= AngmarNecroSoulFreezeWeapon
	End
	
	Behavior = SpecialPowerModule ModuleTag_NecroSoulFreezeBlastTrigger ;ModuleTag_NecroBlackIceBlastTrigger
		SpecialPowerTemplate		= SpecialAbilityNecroSoulFreezeFXStarter ;SpecialAbilityNecroSoulFreeze ;SpecialAbilityNecroBlackIceFXStarter
		TriggerFX			= FX_SoulFreezeGround ;FX_BlackIce
		UpdateModuleStartsAttack	= No
		StartsPaused			= No
  	End

  	Behavior = SpecialPowerModule ModuleTag_NecroSoulFreezeBlastWeapon
		SpecialPowerTemplate		= SpecialAbilityNecroSoulFreezeWeaponStarter
		UpdateModuleStartsAttack	= No
		StartsPaused			= No
   	End




;----------------------Necro Corpse Rain power---------------------------------------	
	Behavior = SpecialPowerModule ModuleTag_NecroCorpseRainStarter
		SpecialPowerTemplate		= SpecialAbilityNecroCorpseRain
		StartsPaused			= Yes
 		UpdateModuleStartsAttack	= Yes
		TriggerFX              		= FX_GandalfLightningSwordBlastWeapon
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroCorpseRainBlastWeaponFireUpdate   
		SpecialPowerTemplate    	= SpecialAbilityNecroCorpseRain
		WhichSpecialWeapon		= 4
		SkipContinue			= Yes
		FreezeAfterTriggerDuration 	= 100 ; Hold AI for this long after we fire.
		UnpackTime					= 700
		PreparationTime				= 1   
		;PersistentPrepTime			= 1000
		PackTime					= 100
		AwardXPForTriggering    	= 0		
		StartAbilityRange		= ANGMAR_NECRO_CORPSE_RAIN_START_RANGE		
        	TriggerSound = NecroVoiceModeCorpseRain 
		SpecialWeapon			= AngmarNecroCorpseRainWeapon
	End


;--------------------Necro Fell Strength power---------------------------------
	Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthStarter
		SpecialPowerTemplate		= SpecialAbilityNecroFellStrength
		StartsPaused			= No
 		UpdateModuleStartsAttack	= No
	End
	
	Behavior = ActivateModuleSpecialPower ModuleTag_NecroFellStrengthMover
		SpecialPowerTemplate		= SpecialAbilityNecroFellStrength
		StartAbilityRange		= ANGMAR_NECRO_FELL_STRENGTH_START_RANGE
		TriggerSpecialPower		= ModuleTag_NecroFellStrengthBlastStarter TARGETPOS
		TriggerSpecialPower		= ModuleTag_NecroFellStrengthBlastTrigger TARGETPOS
		TriggerSpecialPower		= ModuleTag_NecroFellStrengthBuffStarter OBJECTPOS
	End

	Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthBlastTrigger
		SpecialPowerTemplate		= SpecialAbilityNecroFellStrengthFXStarter
		TriggerFX			= FX_FellStrength
		UpdateModuleStartsAttack	= No
		StartsPaused			= No
   	End

	Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthBuffStarter
		SpecialPowerTemplate		= SpecialAbilityActivateeDummy		
		AttributeModifier		= FellStrengthModifier
		AttributeModifierRange		= ANGMAR_NECRO_FELL_STRENGTH_BUFF_RANGE
		AttributeModifierAffects	= ANY +INFANTRY +CAVALRY +MONSTER +HORDE ALLIES -STRUCTURE
		AttributeModifierAffectsSelf	= Yes
		UpdateModuleStartsAttack	= No
		StartsPaused			= No
   	End

	Behavior = SpecialPowerModule ModuleTag_NecroFellStrengthBlastStarter       
		SpecialPowerTemplate      	= SpecialAbilityWizardBlast
		UpdateModuleStartsAttack  	= Yes
		StartsPaused		  	= No
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroFellStrengthBlastWeaponFireUpdate   
		SpecialPowerTemplate    	= SpecialAbilityWizardBlast
		WhichSpecialWeapon		= 5
		SkipContinue			= Yes
		FreezeAfterTriggerDuration 	= 100 ; Hold AI for this long after we fire.
		UnpackTime					= 700
		PreparationTime				= 1   
		;PersistentPrepTime			= 1000
		PackTime					= 100
		AwardXPForTriggering    	= 0		
		StartAbilityRange		= ANGMAR_NECRO_FELL_STRENGTH_START_RANGE		
        	TriggerSound = NecroVoiceModeFellStrength 
		SpecialWeapon			= NecroFellStrength
	End

;--------------------Necro Well of Souls power---------------------------------
	Behavior = SpecialPowerModule ModuleTag_NecroWellOfSoulsStarter
		SpecialPowerTemplate		= SpecialAbilityNecroWellOfSouls
		StartsPaused			= Yes
 		UpdateModuleStartsAttack	= Yes
	End
	
	Behavior = ActivateModuleSpecialPower ModuleTag_NecroWellOfSoulsMover
		SpecialPowerTemplate		= SpecialAbilityNecroWellOfSouls
		StartAbilityRange		= ANGMAR_NECRO_WELL_OF_SOULS_START_RANGE
		TriggerSpecialPower		= ModuleTag_NecroBlastStarter TARGETPOS
		TriggerSpecialPower		= ModuleTag_NecroWellOfSoulsBlastTrigger TARGETPOS
		TriggerSpecialPower		= ModuleTag_NecroBuffHeal OBJECTPOS
	End

	Behavior = SpecialPowerModule ModuleTag_NecroWellOfSoulsBlastTrigger
		SpecialPowerTemplate		= SpecialAbilityNecroWellOfSouls
		TriggerFX			= FX_WellOfSoulsWeapon
		UpdateModuleStartsAttack	= No
		StartsPaused			= Yes
   	End


   	Behavior = PlayerHealSpecialPower ModuleTag_NecroBuffHeal
		SpecialPowerTemplate		= SpecialAbilityActivateeDummy
		HealAmount			= ANGMAR_NECRO_WELL_OF_SOULS_HEAL_AMT
		HealAsPercent			= Yes
		HealAffects			= INFANTRY CAVALRY HERO DOZER MONSTER
		HealRadius			= ANGMAR_NECRO_WELL_OF_SOULS_BUFF_RADIUS
		HealFX				= FX_SpellHealUnitHealBuff
		InitiateSound			= DainMightyRage
		TriggerFX			= FX_WellOfSoulsCast
	End

	Behavior = SpecialPowerModule ModuleTag_NecroBlastStarter       
		SpecialPowerTemplate      	= SpecialAbilityWellOfSoulsBlast
		UpdateModuleStartsAttack  	= Yes
		StartsPaused			= No
	End

	Behavior = WeaponFireSpecialAbilityUpdate ModuleTag_NecroBlastWeaponFireUpdate   
		SpecialPowerTemplate		= SpecialAbilityWellOfSoulsBlast
		WhichSpecialWeapon		= 1
		SkipContinue			= Yes
		UnpackTime					= 700
		PreparationTime				= 1   
		;PersistentPrepTime			= 1000
		PackTime					= 100
		;UnpackTime			= 10 
		;PackTime			= 10	
		FreezeAfterTriggerDuration 	= 100 ; Hold AI for this long after we fire.
		AwardXPForTriggering    	= 0		
		StartAbilityRange		= ANGMAR_NECRO_WELL_OF_SOULS_START_RANGE	
        	TriggerSound = NecroVoiceModeWellofSouls 
		SpecialWeapon			= NecroWellOfSoulsAttack
		;PreparationTime		= 1	//Quick	shot
	End

;----------end necro special powers------------------------------------------
		
	CommandSet = AngmarNecromancerHordeCommandSet
	
	/////////////////////
	// AISpecialPowers
	/////////////////////
	
	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceBattle
		CommandButtonName = Command_SetStanceBattle
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEBATTLE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeStanceAggressive
		CommandButtonName = Command_SetStanceAggressive
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEAGGRESSIVE
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeHoldGround
		CommandButtonName = Command_SetStanceHoldGround
		SpecialPowerAIType = AI_SPECIAL_POWER_STANCEHOLDGROUND
	End

	Behavior = AISpecialPowerUpdate GondorFighterHordeCaptureBuildingAI
		CommandButtonName = Command_CaptureBuilding
		SpecialPowerAIType = AI_SPECIAL_POWER_CAPTURE_BUILDING
	End
	
	
    ;-----------------Necro specific AI power hookups-----------------

	Behavior = AISpecialPowerUpdate AngmarNecroBlackIceAI
		CommandButtonName = Command_NecromancerBlackIce
		SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK_UNITS
	End

	Behavior = AISpecialPowerUpdate AngmarNecroSoulFreezeAI
		CommandButtonName = Command_NecromancerSoulFreeze
		SpecialPowerAIType = AI_SPECIAL_POWER_SOUL_FREEZE
		SpecialPowerRange = ANGMAR_NECRO_SOUL_FREEZE_START_RANGE
	End

	Behavior = AISpecialPowerUpdate AngmarNecroCorpseRainAI
		CommandButtonName = Command_NecromancerCorpseRain
		SpecialPowerAIType = AI_SPECIAL_POWER_RANGED_AOE_ATTACK_UNITS
	End

	Behavior = AISpecialPowerUpdate AngmarNecroFellStrengthAI
		CommandButtonName = Command_NecromancerFellStrength
		SpecialPowerAIType = AI_SPECIAL_POWER_AOE_AND_BUFF
	End

	Behavior = AISpecialPowerUpdate AngmarNecroWellofSoulsAI
		CommandButtonName = Command_NecromancerWellOfSouls
		SpecialPowerAIType = AI_SPECIAL_POWER_ATTACK_HEAL_AOE; AI_SPECIAL_POWER_AOE_AND_BUFF 
        SpecialPowerRadius = ANGMAR_NECRO_WELL_OF_SOULS_BUFF_RADIUS
        SpecialPowerRange  = ANGMAR_NECRO_WELL_OF_SOULS_START_RANGE
	End

	
	Geometry = BOX
	GeometryMajorRadius = 30.0
	GeometryMinorRadius = 50.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
	
	
	; *** AUTO RESOLVE DATA *** 
	AutoResolveUnitType = AutoResolveUnit_Support
	
	; // TODO:  Create a SupportCombatChain
	AutoResolveCombatChain = AutoResolve_SoldierCombatChain
	
	AutoResolveBody = AutoResolve_DwarvenGuardianHordeBody
	
	AutoResolveArmor
		RequiredUpgrades = Upgrade_DwarvenMithrilMail
		Armor = AutoResolve_DwarvenGuardianHeavyArmor
	End

	AutoResolveArmor
		ExcludedUpgrades = Upgrade_DwarvenMithrilMail
		Armor = AutoResolve_DwarvenGuardianArmor
	End

	AutoResolveWeapon
		RequiredUpgrades = Upgrade_DwarvenForgedBlades
		Weapon = AutoResolve_DwarvenGuardianUpgradedWeapon
	End

	AutoResolveWeapon
		ExcludedUpgrades = Upgrade_DwarvenForgedBlades
		Weapon = AutoResolve_DwarvenGuardianWeapon
	End
	
	; Necromancers should not be upgradable at Living World forges!
	; WorldMapArmoryUpgradesAllowed = Upgrade_DwarvenBasicTraining Upgrade_DwarvenForgedBlades Upgrade_DwarvenMithrilMail
End
