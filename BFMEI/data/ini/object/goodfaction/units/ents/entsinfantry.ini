;------------------------------------------------------------------------------
;
;	EntsInfantry.ini
;
;------------------------------------------------------------------------------

;------------------------------------------------------------------------------
;Creating this Ent will randomize between several variations of the Ent (Fir, Birch)
;Eventually Ash will be supported.
;------------------------------------------------------------------------------
Object RohanGenericEnt
	Draw = W3DScriptedModelDraw ModuleTag_01  
		StaticModelLODMode = Yes
		DefaultModelConditionState
			;Give it a model so it'll show up in WB
			Model               = RUTreeberd_SKN
			Skeleton            = RUTreeberd_SKL
		End
	End

	;***** IMPORTANT NOTE! ***************************************************************	
	;Certain Upgrades and costs may need to be propagated from here. One example was veterancy
	;overlays. See Zero Hour GLAVehicleTechnical for reference.
	;*************************************************************************************	

	; ***DESIGN parameters ***
	Side = Rohan
	EditorSorting = UNIT
	CommandSet = RohanGenericEntCommandSet
	CommandPoints = 10
	BuildVariations = RohanEntFir RohanEntBirch ; Pending some Ash specific art bug resolution ;RohanEntAsh
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAN_ATTACK_WALLS SCARY
	BuildCost = ROHAN_ENT_BUILDCOST				
	BuildTime = ROHAN_ENT_BUILDTIME
	BountyValue = ROHAN_ENT_BOUNTY_VALUE				
End

;------------------------------------------------------------------------------
; aka TreeBerd, Treebeard
Object RohanTreeBerd
	; *** ART Parameters ***
        ButtonImage		= HITreebeard
	SelectPortrait	= HPTreeBeard

    ; ButtonImage for Heros is button image on Hero Select UI to select hero. HI = HeroIcon or HeroImage.
    ButtonImage = HITreebeard
	Draw = W3DScriptedModelDraw ModuleTag_01
		StaticModelLODMode = Yes
		WadingParticleSys = EntRipples
		WadingParticleSys = EntSplash

			  OkToChangeModelColor = Yes
	
		ExtraPublicBone = B_POINT1R
		;ExtraPublicBone = Passenger01   
		;ExtraPublicBone = Passenger02
		ExtraPublicBone = PASSENGER
		ExtraPublicBone = IMPACT
		ExtraPublicBone = ROCK

		DefaultModelConditionState
			Model               = RUTreeberd_SKN
			Skeleton			= RUTreeberd_SKL
			WeaponLaunchBone    = PRIMARY Firepoint
			WeaponLaunchBone    = SECONDARY Firepoint
			
			;Leaving this commented out to show it's busted.  When we split ModelDraw states in to Model and Animation
			; seperately, this field got split in half and no longer works.  So the fire fx uses FXListAtBonePos instead.
			;WeaponFireFXBone	= TERTIARY Firepoint


		ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeaves FollowBone: no
   		End

		;---------------------------------Wading model
   		ModelConditionState	 = WADING AFLAME
   			Model               = RUTreeburnt_SKN
   			Skeleton            = RUTreeBerd_SKL
   			
			ParticleSysBone     = BAT_HEAD TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_SPINE1 TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_PELVIS TreebeardSteam1 FollowBone:yes
			ParticleSysBone     = BAT_CALFR TreebeardSteam FollowBone:yes
			ParticleSysBone     = B_POINT1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_POINT1R TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1R TrBrdWaterDrips FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDR TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDL TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash4 FollowBone:yes

   		End

		;---------------------------------Burned model
   		ModelConditionState	 = BURNED
   			Model               = RUTreeburnt_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
		
   		ModelConditionState	 = BURNT_MODEL DYING ; No smoke when dying and sinking in to ground.  Maybe later, some kind of fading smoke.
   			Model               = RUTreeburnt_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState   = BURNT_MODEL
   			Model               = RUTreeburnt_SKN
   			Skeleton            = RUTreeBerd_SKL
			
            ;Final Fires

			ParticleSysBone     = BAT_HEAD TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HEAD TreebeardSmoke FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_SPINE1 TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_PELVIS TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardEmbers FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardFlare FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_CALFR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_HANDR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HANDL TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
   		End
   		   		
		IdleAnimationState
			Animation = IDLA 
				AnimationName = RUTreeberd_IDLA ; Stand and breathe
				AnimationBlendTime  = 5
			End
			StateName = Idle
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.875 then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.625 then CurDrawableSetTransitionAnimState("TRANS_Stop75") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.375 then CurDrawableSetTransitionAnimState("TRANS_Stop50") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.125 then CurDrawableSetTransitionAnimState("TRANS_Stop25") return end
				if Prev == "Moving" then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
                if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
            ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeaves FollowBone: no
		End

		AnimationState        = DYING
			Animation           = Die
				AnimationName     = RUTreeberd_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		; -------- DEBATE ANIMS ---------------
		AnimationState   = JUST_BUILT
			StateName		= STATE_JustBuilt
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ;sprout animation
				AnimationMode = MANUAL ;; hold first frame
				AnimationBlendTime = 0
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState		= PREPARING MOVING
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState		= PREPARING
			StateName			= STATE_Debate
			Animation           = Debate
				AnimationName     = RUTreeberd_MOTB  ;debate animations
				AnimationMode      = LOOP
				AnimationBlendTime = 30
				AnimationSpeedFactorRange = 0.8 1.1
			End
			Flags               = RANDOMSTART
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript			
		End
		TransitionState   = TRANS_Sprout
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ; sprout animation
				AnimationMode = ONCE
				AnimationBlendTime = 0
				AnimationSpeedFactorRange = 0.5 0.5
			End
			
						FXEvent	= Frame:25 Name:FX_EntSprout	
						FXEvent = Frame:25 Name:FX_EntSproutButterflies
		End



		
		;------ Stunned anims

		AnimationState        = STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		
		;-------------------------------------- AFLAME states
		AnimationState        = AFLAME DYING SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME DYING
			Animation           = Die
				AnimationName     = RUTreeberd_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = USER_3 ;Panic prior to run. Used by FlammableUpdate
			Animation           = OnFire
				AnimationName     = RUTreeberd_RCTD
				AnimationMode      = ONCE
				AnimationBlendTime = 20
			End
				FXEvent	= Frame:54 Name:FX_EntRightFootStep	
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End


		;-------------------------------------------------- Attack states
		AnimationState        = FIRING_OR_PREATTACK_A AIM_NEAR
			Animation       = CloseRock
				AnimationName     = RUTreeberd_THRC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_A
			Animation       = FarRock
				AnimationName     = RUTreeberd_THRB
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = CloseFakeRockMad
				AnimationName     = RUTreeberd_GRBF
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = FarFakeRockMad
				AnimationName     = RUTreeberd_GRBE
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1
			Animation       = CloseFakeRock
				AnimationName     = RUTreeberd_GRBD
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1
			Animation       = FarFakeRock
				AnimationName     = RUTreeberd_GRBC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = MOVING FIRING_OR_PREATTACK_B WEAPONSET_ENRAGED
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRB
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_B
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRA
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = FIRING_OR_PREATTACK_B 
			Animation           = Punch
				AnimationName     = RUTreeberd_ATKA 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = Punt
				AnimationName     = RUTreeberd_ATKD 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = FrontKick
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunch
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				if CurDrawableIsCurrentTargetKindof("MONSTER") then
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("FrontKick")
					else
						return ("KirkPunch")
					end
				else
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("Punch")
					else
						return ("Punt")
					end
				end
			EndScript
		End
	
		AnimationState        = FIRING_OR_PREATTACK_C 
			Animation           = FrontKickOnBuilding
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunchOnBuilding
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUTreeBerd_MADA
				AnimationName		= RUTreeBerd_MADA 
				AnimationMode		= ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

;-----------------------
; Enraged movement is before Aflame, because if he can't find water to run too, he gets pissed instead of panicky.
		AnimationState        = WEAPONSET_ENRAGED TURN_LEFT
			Animation           = Walk
				AnimationName     = RUTreeberd_TNL2 
				AnimationMode     = LOOP
				AnimationSpeedFactorRange = 1.1 1.1
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = WEAPONSET_ENRAGED TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUTreeberd_TNR2 
				AnimationMode     = LOOP
				AnimationSpeedFactorRange = 1.1 1.1
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = WEAPONSET_ENRAGED MOVING
			Animation           = AngryStompWalk
				AnimationName     = RUTreeberd_WLKC 
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:26 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
;-----------------------

		AnimationState        = AFLAME TURN_LEFT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNL 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNR 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME MOVING
			Animation           = Jump
				AnimationName     = RUTreeberd_MFDA 
				AnimationMode      = LOOP
				AnimationSpeedFactorRange = 0.5 0.5
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:4 Name:FX_EntLeftFootStep
			FXEvent	= Frame:18 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				CurDrawablePlaySound("EntRunFire")
		    EndScript
		End

		AnimationState        =  AFLAME WADING
			Animation           = Splash
				AnimationName     = RUTreeberd_SPLA  ; Splashing water on himself
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = AFLAME STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = DYING SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB2
				AnimationMode      = ONCE
				AnimationBlendTime = 0		;We need to go instantly from unpacking to packing.
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB1
				AnimationMode      = ONCE
				AnimationBlendTime = 20		
			End
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA2
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA1
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		; --------- Moving anims.

		AnimationState				= TURN_RIGHT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNR 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState				= TURN_LEFT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNL 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= MOVING
			StateName				= Moving
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
				if Prev == "Turn" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
			EndScript			
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:39 Name:FX_EntRightFootStep
			FXEvent	= Frame:79 Name:FX_EntLeftFootStep
			FXEvent	= Frame:129 Name:FX_EntRightFootStep
		End


		AnimationState						= HIT_REACTION HIT_LEVEL_1
			Animation						= Hit_Level_1_a
				AnimationName				= RUTreeberd_HITA
				AnimationMode				= ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState						= WEAPONSET_ENRAGED
			Animation						= AngryIdle
				AnimationName				= RUTreeberd_IDLC
				AnimationMode				= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		TransitionState = TRANS_Accelerate
			Animation = Transition
				AnimationName = RUTreeberd_ACLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.75 0.75
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop75
			Animation = Transition
				AnimationName = RUTreeberd_DCLC
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop50
			Animation = Transition
				AnimationName = RUTreeberd_DCLB
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop25
			Animation = Transition
				AnimationName = RUTreeberd_DCLD
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop00
			Animation = Transition
				AnimationName = RUTreeberd_DCLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

	End

	; ***DESIGN parameters ***
	Side = Rohan
	EditorSorting = UNIT
	ThreatLevel = 4.0
	ThingClass = MEDIUM_MONSTER
	MaxSimultaneousOfType = 1
	TransportSlotCount = 1
	CommandPoints = 0
	WeaponSet
		Conditions          =  None
		Weapon              =  PRIMARY    RohanTreeBeardRockThrow
		Weapon              =  SECONDARY  RohanTreeBeardPunch
		Weapon              =  TERTIARY   RohanBuildingTeardown
		PreferredAgainst	= PRIMARY STRUCTURE BLOCKING_GATE		; Preferred is more powerful than Only, so if we have a rock we will chuck it, but otherwise we will choke a building
		OnlyAgainst         =  TERTIARY   STRUCTURE BLOCKING_GATE
	End

	WeaponSet
		Conditions          =  WEAPONSET_TOGGLE_1
		Weapon              =  PRIMARY    RohanTreeBeardRockThrow
		Weapon              =  SECONDARY  RohanTreeBeardRockFromThinAir
	End

	ArmorSet
		Conditions      = None
		Armor           = EntArmor
		DamageFX        = EntDamageFX
	End
  ImmuneToShockwave = Yes

	VisionRange = VISION_STANDARD_MELEE
	ShroudClearingRange = SHROUD_CLEAR_ENT

	BountyValue = ROHAN_TREEBEARD_BOUNTY_VALUE			

	DisplayName = OBJECT:RohanTreeBeard
	DisplayMeleeDamage = ROHAN_TREEBEARD_PUNCH_DAMAGE

	CrusherLevel = 1	
	UseCrushAttack = No  ; Don't attack using crush, just crush when you walk through.
	CommandSet = RohanTreeBeardCommandSet
	


	; *** AUDIO Parameters ***;

	VoiceAttack			= TreebeardVoiceAttack		;EntVoiceSelect
	VoiceAttackCharge		= TreebeardVoiceAttackCharge
	VoiceAttackMachine	= TreebeardVoiceAttack
	VoiceAttackStructure	= TreebeardVoiceAttackBuilding
	VoiceCreated		= TreebeardVoiceSalute
	VoiceFullyCreated		= TreebeardVoiceSalute
	VoiceFear			= TreebeardVoiceHelpMe
	VoiceGuard			= TreebeardVoiceMove
	VoiceMove			= TreebeardVoiceMove		;EntVoiceSelect
	VoicePriority		= 72
	VoiceSelect			= TreebeardVoiceSelect		;EntVoiceSelect
	VoiceSelectBattle		= TreebeardVoiceSelectBattle

	VoiceAttack2		= TreebeardVoice
	VoiceAttackCharge2	= TreebeardVoice
	VoiceAttackMachine2	= TreebeardVoice
	VoiceAttackStructure2	= TreebeardVoice
	VoiceCreated2		= TreebeardVoice
	VoiceFear2			= TreebeardVoice
	VoiceMove2			= TreebeardVoice
	VoiceSelect2		= TreebeardVoice
	VoiceSelectBattle2	= TreebeardVoice

	SoundMoveLoop		= EntVoxMoveLoop
	SoundImpact			= ImpactHorse

;TreebeardVoiceDropHobbit
;TreebeardVoiceJoinHobbit
;TreebeardVoiceJoinOrc
;TreebeardVoiceJoinRock
;TreebeardVoiceRespawn

	;UnitSpecificSounds
	;	VoiceGarrison         = NoSound
	;End

	EvaEventDamagedOwner	= UnitUnderAttack 		;Eva event to trigger when unit is damaged
	EvaEventDieOwner		= TreebeardDie			;Eva event to trigger on unit's death. NOTICE THAT this is only for permanent deaths

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:BuildingEntMootCouncil				Animation:RUTReeBerd_SKL.RUTreeberd_MOTA	Frames:1
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_MOTA	Frames:225 253
		AnimationSound = Sound:BuildingEntMootCouncil				Animation:RUTReeBerd_SKL.RUTreeberd_MOTB	Frames:1

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBA1	Frames:9 13
		AnimationSound = Sound:TrollTreeSwingLight				Animation:RUTReeBerd_SKL.RUTreeBerd_GBA1	Frames:10
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GBA1	Frames:16
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBA2	Frames:28 34
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBB1	Frames:18
		AnimationSound = Sound:TrollTreeSwingLight				Animation:RUTReeBerd_SKL.RUTreeBerd_GBB1	Frames:16
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeBerd_GBB1	Frames:21
		AnimationSound = Sound:EntGrabBuildingChunk				Animation:RUTReeBerd_SKL.RUTreeberd_GBB1	Frames:37
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBB2	Frames:24

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBC	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBC	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBC	Frames:160
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBD	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBD	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBD	Frames:160
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBE	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBE	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBE	Frames:160
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBF	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBF	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBF	Frames:160

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKA	Frames:9 78
		AnimationSound = Sound:ImpactEntGenericPunch				Animation:RUTReeBerd_SKL.RUTreeberd_ATKA	Frames:31
 		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKD	Frames:65
		AnimationSound = Sound:ImpactEntGenericKick				Animation:RUTReeBerd_SKL.RUTreeberd_ATKD	Frames:32
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKE	Frames:70
		AnimationSound = Sound:ImpactEntGenericKick				Animation:RUTReeBerd_SKL.RUTreeberd_ATKE	Frames:31
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKF	Frames:16 82
		AnimationSound = Sound:ImpactEntGenericPunch				Animation:RUTReeBerd_SKL.RUTreeberd_ATKF	Frames:32

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_ACLA	Frames:9
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLA	Frames:17 42
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLB	Frames:17 44
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLC	Frames:11 41
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLD	Frames:32

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_WLKA	Frames:33 76
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_WLKC	Frames:22 48 
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_RUNA	Frames:4 24

		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TRNL	Frames:12 27
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TRNR	Frames:12 27
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TNL2	Frames:18 38 
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TNR2	Frames:18 38

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_THRB	Frames:12 44
		AnimationSound = Sound:TrollTreeSwing					Animation:RUTReeBerd_SKL.RUTreeBerd_THRB	Frames:36
		AnimationSound = Sound:TrollTreeSwingLight				Animation:RUTReeBerd_SKL.RUTreeBerd_THRC	Frames:29
		
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_MADA	Frames:75
		AnimationSound = Sound:EntPanic						Animation:RUTReeBerd_SKL.RUTreeBerd_MADA	Frames:17
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_MFDA	Frames:2 14

		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:5 120 206
		AnimationSound = Sound:EntSeeFirePart1					Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:40 
		AnimationSound = Sound:EntSeeFirePart2					Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:70
		AnimationSound = Sound:TrollTreeSwing					Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:121
		AnimationSound = Sound:EntPanic						Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:150

		AnimationSound = Sound:EntSplashWater					Animation:RUTReeBerd_SKL.RUTreeBerd_SPLA	Frames:0

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_HITA	Frames:11 52
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_GTPA	Frames:14 24
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DIEA	Frames:7 
		AnimationSound = Sound:EntDieFall						Animation:RUTReeBerd_SKL.RUTreeBerd_DIEA	Frames:63
		AnimationSound = Sound:EntDieFall						Animation:RUTReeBerd_SKL.RUTreeBerd_LNDA	Frames:3
		AnimationSound = Sound:EntBodyfall						Animation:RUTReeBerd_SKL.RUTreeBerd_LNDA	Frames:24

		;----------- water footsteps below -------------

		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_MOTA	Frames:225 253
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBA1	Frames:9 13
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBA2	Frames:28 34
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBB1	Frames:18
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBB2	Frames:24
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBC	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBD	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBE	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBF	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKA	Frames:9 78	
 		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKD	Frames:65
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKE	Frames:70
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKF	Frames:16 82
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_ACLA	Frames:9
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLA	Frames:17 42
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLB	Frames:17 44
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLC	Frames:11 41
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLD	Frames:32 	
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_WLKA	Frames:33 76
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_WLKC	Frames:22 48
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_THRB	Frames:12 44
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_MADA	Frames:75	
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_HITA	Frames:11 52
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_GTPA	Frames:14 24
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DIEA	Frames:7

		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_RUNA	Frames:4 24
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TRNL	Frames:12 27
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TRNR	Frames:12 27
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TNL2	Frames:18 38
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TNR2	Frames:18 38
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_MFDA	Frames:2 14
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_RCTD	Frames:5 120 206
	End

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU						; Tie into LargeGroupAudio system
		Key = Ent Unit Infantry
		UnitWeight = 2 ; Ents count as 2 infantry when computing group size
	End


	; *** ENGINEERING Parameters ***
	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS SCARY HERO BIG_MONSTER ARMY_SUMMARY
	
	BuildCost = 2000
	BuildTime = 60.0 
	
	Behavior = FlammableUpdate FlammableModuleTag_15
		AflameDuration				= 0			; Burn until expressly put out.  Made of wood and all.
		AflameDamageDelay			= 500	; How often do I take damage from being on fire?
		AflameDamageAmount			= 30			; How much damage to I take per delay?
		FlameDamageLimit			= 130		; How much flame damage do I need to take before starting on fire?
		FlameDamageExpiration			= 10000
		SwapModelWhenAflame			= Yes
		SwapModelWhenQuenched		= Yes
		RunToWater					= Yes
		RunToWaterDepth				= 5		; Any water will put us out, but we'll look for something at least a little deep
	    RunToWaterSearchRadius			= 0 ; No more auto run to water, but oddly enough we need to keep the RunToWater flag if we want to get mad since we "can't find water"
		RunToWaterSearchIncrement	= 50
		PanicLocomotorWhileAflame	= Yes
		CustomAnimAndDuration		= AnimState:USER_3 AnimTime:7000 ;RCTD animation
            FireFXList = FX:FX_FireStartEnt
	End

	Body = ActiveBody ModuleTag_ActiveBody
		CheerRadius 			= EMOTION_CHEER_RADIUS
		MaxHealth         		= ROHAN_TREEBEARD_HEALTH				;BALANCE Treebeard Health
	End

	Behavior = AutoHealBehavior ModuleTag_EntHealing
		StartsActive = Yes
		HealingAmount = 50
		HealingDelay = 1000
		StartHealingDelay = 15000
		HealOnlyIfNotInCombat = Yes
	End

	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		AILuaEventsList				=	EntFunctions	
	End

	Behavior = EntEnragedUpdate  EnragedBehaviorModuleTag
	;	EnragedLifeTimer 	= 15.0 ; 15 seconds lifetime
		HatedObjectFilter 	= NONE +LumberMill
		FriendlyDeadFilter 	= NONE +RohanEntFir +RohanEntBirch +RohanEntAsh +RohanTreeBerd +RohanEntFir_Summoned +RohanEntBirch_Summoned
		EnragedTime		= 150000 ;30000
		TimeUntilCanRageAgain = 0	; always enrage if you "should."
		EnragedTransitionTime 	= 3000
		;;;;;;;;;EnragedTransitionFX = FX_EntEnragedTransition
		;;;;;;;;;EnragedOnBuffFX		= FX_EntEnragedBuffOn	
		;;;;;;;;;EnragedOffBuffFX	= FX_EntEnragedBuffOff	
	End
	
	Behavior = FireWeaponWhenDeadBehavior FireDeadTag
		RequiredStatus	= DEATH_1
		StartsActive	= Yes
		DelayTime		= 2300 
		DeathWeapon		= RohanEntDeath
		WeaponOffset	= X:-48 Y:0 Z:0	;Fire the death weapon right behind the object.
	End	

	LocomotorSet
		Locomotor = RohanTreeBeardLocomotor
		Condition = SET_NORMAL 
		Speed     = 16
	End

	LocomotorSet
		Locomotor = RohanTreeBeardLocomotor
		Condition = SET_ENRAGED
		Speed     = 50
	End
	
	LocomotorSet
		Locomotor = RohanTreeBeardFastTurnLocomotor
		Condition = SET_PANIC
		Speed	  = 80
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End
	
	Behavior = SlowDeathBehavior ModuleTag_50
		DeathTypes = ALL -KNOCKBACK 
		DestructionDelay = 20000
		SinkDelay = 5000
		SinkRate = 0.8     ; in Dist/Sec
		Sound = INITIAL EntDie
		DeathFlags			= DEATH_1      ; Controls animation and weapon choice. Sets BOTH model condition and object status bits.
	End

	Behavior = SlowDeathBehavior ModuleTag_52
		; Same as normal death, but no sound (sound already played by SoundImpact = ... )
		DeathTypes = NONE +KNOCKBACK
		DestructionDelay = 20000
		SinkDelay = 5000
		SinkRate = 0.8     ; in Dist/Sec
		DeathFlags			= DEATH_1      ; Controls animation and weapon choice. Sets BOTH model condition and object status bits.
	End
    
    Behavior = SlowDeathBehavior ModuleTag_FadeDeath
		DeathTypes = NONE +FADED
		SinkRate = 0.8     ; in Dist/Sec
		DestructionDelay = 10000
        DeathFlags = DEATH_2
        FX         = INITIAL   FX_UnSummonEntAllies
	End


	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	Behavior = AutoPickUpUpdate AutoPickUpForRocks
		ScanDelayTime = 0
		ScanDistance = 300;		default value is 300 units	
		PickUpKindOf = ROCK_VENDOR ; Not Rock, because this module finds someone to hit with the GrabPassenger power, and in there is where vendor is handled
		RunFromButton = Yes ; No natural scanning, wakes up to run exactly once when hit with a WakeAutoPickup button
		RunFromButtonNumber = 1; In case of multiples, this lines up with the OPTION_(ONE) field in the waking button
	End

	;building chunk
	Behavior = GrabPassengerSpecialPower ModuleTag_GrabBuildingChunk                      
		SpecialPowerTemplate		= SpecialAbilityGrabPassenger2
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= TreebeardVoiceGrabBuildingChunk
		InitiateSound2			= TreebeardVoice
		AllowTree					= No
	End

	Behavior = SpecialAbilityUpdate ModuleTag_082                
		SpecialPowerTemplate    = SpecialAbilityGrabPassenger2
		StartAbilityRange       = 10.0

		UnpackTime              = 1300 ; Nothing to touching it
		PreparationTime         = 0   ; touching it to grabbing it
		PersistentPrepTime      = 0 ; grabbing it to whacking it on the ground (if shrubbery)
		PackTime                = 1700 ; whacking it to holding it nice
		
		ContactPointOverride		= Grab	; If the victim building has a point named this, we'll go there instead of to the bounding circle.

	;	GrabChunkObject = EntThrownBuildingRock
	;	GrabChunkFX = FX_WallGrab
	;	GrabChunkDamage = 490
	;	GrabChunkOffset = X:16 Y:0

;    PackSound               = 
;    UnpackSound             = 
;    TriggerSound            = 
;    PrepSoundLoop           = 
		AwardXPForTriggering    = 0
	End
	
	;pick up a rock and grab it
	Behavior = GrabPassengerSpecialPower ModuleTag_GrabRock                      
		SpecialPowerTemplate		= SpecialAbilityGrabPassenger
		UpdateModuleStartsAttack	= Yes
		GrabRadius				= 200
		AllowTree				= No
		InitiateSound			= TreebeardVoiceGrabRock
		InitiateSound2			= TreebeardVoice
	End

	Behavior = SpecialAbilityUpdate ModuleTag_08                
		SpecialPowerTemplate    = SpecialAbilityGrabPassenger
		StartAbilityRange       = 8.0

		UnpackTime              = 600 ; Nothing to touching it
		PreparationTime         = 0   ; touching it to grabbing it
		PersistentPrepTime      = 0 ; grabbing it to whacking it on the ground (if shrubbery)
		PackTime                = 1333 ; whacking it to holding it nice
		
		;GrabChunkObject = EntThrownBuildingRock
		;GrabChunkFX = FX_WallGrab
		;GrabChunkDamage = 490
		;GrabChunkOffset = X:16 Y:0

;    PackSound               = 
;    UnpackSound             = 
;    TriggerSound            = 
;    PrepSoundLoop           = 
		AwardXPForTriggering    = 0
	End
	
	Behavior = TransportContain ModuleTag_09
		ObjectStatusOfContained = UNSELECTABLE
		PassengerFilter = ANY +ROCK 
		CanGrabStructure = Yes ; Overrides buildings' natural 0 in TransportSlotCount that makes them uncontainable
		Slots = 1
		ShowPips = No
		AllowEnemiesInside = Yes
		AllowNeutralInside = Yes
		AllowAlliesInside  = No
		DamagePercentToUnits = 0%
		TypeOneForWeaponState = ROCK
		
		PassengerBonePrefix = PassengerBone:Firepoint    KindOf:ROCK 
	End
	
	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
		HitReactionLifeTimer1 = 2500 ; level 1 (light  damage)  hit reaction animations in ms
		HitReactionThreshold1 = 50.0   ; level 1 (light  damage) threshold trigger
	End

  	Behavior = AimWeaponBehavior AimWeaponModuleTag
		AimNearDistance = 40.0	; If target closer than this, give Near flag.  This and IsAimingWeapon combine to give extra model condition flags
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 56.0
	GeometryIsSmall = No
	Shadow = SHADOW_VOLUME_NON_SELF_2; volumetric shadow that doesn't cast onto all objects using SHADOW_VOLUME_NON_SELF_2
	ShadowSizeX = 36; clamp the angle so shadow isn't as long.

End

;------------------------------------------------------------------------------
; aka Ent Fir
Object RohanEntFir
	; *** ART Parameters ***
	
	ButtonImage		= HIEnt
	SelectPortrait	= UPRohan_Ent
	
	Draw = W3DScriptedModelDraw ModuleTag_01
	
	StaticModelLODMode = Yes

	WadingParticleSys = EntRipples
	WadingParticleSys = EntSplash

	  OkToChangeModelColor = Yes
	  ExtraPublicBone = IMPACT
		ExtraPublicBone = ROCK

		DefaultModelConditionState
			Model               = RUEntFir_SKN
			Skeleton			= RUTreeberd_SKL
			WeaponLaunchBone    = PRIMARY Firepoint
			WeaponLaunchBone    = SECONDARY Firepoint
		End
		
		;---------------------------------Burned model
   		ModelConditionState	 = WADING AFLAME
   			Model               = RUEntFirD_SKN
   			Skeleton            = RUTreeBerd_SKL
   			
			ParticleSysBone     = BAT_HEAD TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_SPINE1 TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_PELVIS TreebeardSteam1 FollowBone:yes
			ParticleSysBone     = BAT_CALFR TreebeardSteam FollowBone:yes
			ParticleSysBone     = B_POINT1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_POINT1R TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1R TrBrdWaterDrips FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDR TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDL TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash4 FollowBone:yes

   		End

		;---------------------------------Burned model
   		ModelConditionState	 = BURNED
   			Model               = RUEntFirD_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState	 = BURNT_MODEL DYING ; No smoke when dying and sinking in to ground.  Maybe later, some kind of fading smoke.
   			Model               = RUEntFirD_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState   = BURNT_MODEL
   			Model               = RUEntFirD_SKN
   			Skeleton            = RUTreeBerd_SKL

	;Final Fire
			
			ParticleSysBone     = BAT_HEAD TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HEAD TreebeardSmoke FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_SPINE1 TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_PELVIS TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardEmbers FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardFlare FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_CALFR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_HANDR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HANDL TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN


   		End
   		
		IdleAnimationState
			Animation = IDLA 
				AnimationName = RUTreeberd_IDLA ; Stand and breathe
				AnimationBlendTime  = 5
			End
			StateName = Idle
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.875 then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.625 then CurDrawableSetTransitionAnimState("TRANS_Stop75") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.375 then CurDrawableSetTransitionAnimState("TRANS_Stop50") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.125 then CurDrawableSetTransitionAnimState("TRANS_Stop25") return end
				if Prev == "Moving" then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
                if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
            ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeavesFir FollowBone: no
		End

 		AnimationState        = DYING DEATH_1
 			Animation           = Die
 				AnimationName     = RUTreeberd_DIEA
 				AnimationMode      = ONCE
 			End
 			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 
 		AnimationState        = DYING DEATH_2
 			Animation           = Die
 				AnimationName     = RUTreeberd_MOTA
 				AnimationMode      = ONCE_BACKWARDS
 			End
            Flags = START_FRAME_LAST
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 
		; -------- DEBATE ANIMS ---------------
		AnimationState   = JUST_BUILT
			StateName		= STATE_JustBuilt
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ;sprout animation
				AnimationMode = MANUAL ;; hold first frame
				AnimationBlendTime = 0
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState		= PREPARING MOVING
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		
		AnimationState		= PREPARING
			StateName			= STATE_Debate
			Animation           = Debate
				AnimationName     = RUTreeberd_MOTB  ;debate animations
				AnimationMode      = LOOP
				AnimationBlendTime = 30
				AnimationSpeedFactorRange = 0.8 1.1
			End
			Flags               = RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
		End
		TransitionState   = TRANS_Sprout
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ; sprout animation
				AnimationMode = ONCE
				AnimationBlendTime = 0
				AnimationSpeedFactorRange = 0.7 0.7
			End

						FXEvent	= Frame:25 Name:FX_EntSprout	
						FXEvent = Frame:25 Name:FX_EntSproutButterflies
		End



		
		;------ Stunned anims

		AnimationState        = STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		
		;-------------------------------------- AFLAME states
		AnimationState        = AFLAME DYING DEATH_1 SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME DYING DEATH_1
			Animation           = Die
				AnimationName     = RUTreeberd_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = USER_3 ;Panic prior to run. Used by FlammableUpdate
			Animation           = OnFire
				AnimationName     = RUTreeberd_RCTD
				AnimationMode      = ONCE
				AnimationBlendTime = 20
			End
				FXEvent	= Frame:54 Name:FX_EntRightFootStep	
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End


		;-------------------------------------------------- Attack states
		AnimationState        = FIRING_OR_PREATTACK_A AIM_NEAR
			Animation       = CloseRock
				AnimationName     = RUTreeberd_THRC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_A
			Animation       = FarRock
				AnimationName     = RUTreeberd_THRB
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = CloseFakeRockMad
				AnimationName     = RUTreeberd_GRBF
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = FarFakeRockMad
				AnimationName     = RUTreeberd_GRBE
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1
			Animation       = CloseFakeRock
				AnimationName     = RUTreeberd_GRBD
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1
			Animation       = FarFakeRock
				AnimationName     = RUTreeberd_GRBC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = MOVING FIRING_OR_PREATTACK_B WEAPONSET_ENRAGED
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRB
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_B
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRA
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = FIRING_OR_PREATTACK_B 
			Animation           = Punch
				AnimationName     = RUTreeberd_ATKA 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = Punt
				AnimationName     = RUTreeberd_ATKD 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = FrontKick
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunch
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				if CurDrawableIsCurrentTargetKindof("MONSTER") then
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("FrontKick")
					else
						return ("KirkPunch")
					end
				else
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("Punch")
					else
						return ("Punt")
					end
				end
			EndScript
		End
	
		AnimationState        = FIRING_OR_PREATTACK_C 
			Animation           = FrontKickOnBuilding
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunchOnBuilding
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUTreeBerd_MADA
				AnimationName		= RUTreeBerd_MADA 
				AnimationMode		= ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

  ;-----------------------
; Enraged movement is before Aflame, because if he can't find water to run too, he gets pissed instead of panicky.
   		AnimationState        = WEAPONSET_ENRAGED TURN_LEFT
   			Animation           = Walk
 				AnimationName     = RUTreeberd_TNL2 
   				AnimationMode     = LOOP
   				AnimationSpeedFactorRange = 1.1 1.1
   			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
   		End
   
   		AnimationState        = WEAPONSET_ENRAGED TURN_RIGHT
   			Animation           = Walk
 				AnimationName     = RUTreeberd_TNR2 
   				AnimationMode     = LOOP
   				AnimationSpeedFactorRange = 1.1 1.1
   			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
   		End

		AnimationState        = WEAPONSET_ENRAGED MOVING
			Animation           = AngryStompWalk
				AnimationName     = RUTreeberd_WLKC 
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:26 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
;-----------------------

		AnimationState        = AFLAME TURN_LEFT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNL 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNR 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME MOVING
			Animation           = Jump
				AnimationName     = RUTreeberd_MFDA 
				AnimationMode      = LOOP
				AnimationSpeedFactorRange = 0.5 0.5
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:4 Name:FX_EntLeftFootStep
			FXEvent	= Frame:18 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				CurDrawablePlaySound("EntRunFire")
		    EndScript
		End

		AnimationState        =  AFLAME WADING
			Animation           = Splash
				AnimationName     = RUTreeberd_SPLA  ; Splashing water on himself
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = AFLAME STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = DYING DEATH_1 SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB2
				AnimationMode      = ONCE
				AnimationBlendTime = 0		;We need to go instantly from unpacking to packing.
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB1
				AnimationMode      = ONCE
				AnimationBlendTime = 20		
			End
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA2
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA1
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		; --------- Moving anims.

		AnimationState				= TURN_RIGHT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNR 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState				= TURN_LEFT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNL 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= MOVING
			StateName				= Moving
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
				if Prev == "Turn" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
			EndScript			
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:39 Name:FX_EntRightFootStep
			FXEvent	= Frame:79 Name:FX_EntLeftFootStep
			FXEvent	= Frame:129 Name:FX_EntRightFootStep
		End

 
 		AnimationState						= HIT_REACTION HIT_LEVEL_1
 			Animation						= Hit_Level_1_a
 				AnimationName				= RUTreeberd_HITA
 				AnimationMode				= ONCE
 			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 		
 		AnimationState						= WEAPONSET_ENRAGED
 			Animation						= AngryIdle
 				AnimationName				= RUTreeberd_IDLC
 				AnimationMode				= LOOP
 			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 		
		TransitionState = TRANS_Accelerate
			Animation = Transition
				AnimationName = RUTreeberd_ACLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.75 0.75
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop75
			Animation = Transition
				AnimationName = RUTreeberd_DCLC
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop50
			Animation = Transition
				AnimationName = RUTreeberd_DCLB
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop25
			Animation = Transition
				AnimationName = RUTreeberd_DCLD
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop00
			Animation = Transition
				AnimationName = RUTreeberd_DCLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End
	End

	; ***DESIGN parameters ***
	Side = Rohan
	IsTrainable		= No
	EditorSorting = UNIT
	ThreatLevel = 4.0
	ThingClass = MEDIUM_MONSTER
	ImmuneToShockwave = Yes
	TransportSlotCount = 1

	WeaponSet
		Conditions          =  None
		Weapon              =  PRIMARY    RohanTreeBeardRockThrow
		Weapon              =  SECONDARY  RohanTreeBeardPunch
		Weapon              =  TERTIARY   RohanBuildingTeardown
		PreferredAgainst	=  PRIMARY STRUCTURE BLOCKING_GATE		; Preferred is more powerful than Only, so if we have a rock we will chuck it, but otherwise we will choke a building
		OnlyAgainst         =  TERTIARY   STRUCTURE BLOCKING_GATE
	End

	WeaponSet
		Conditions          =  WEAPONSET_TOGGLE_1
		Weapon              =  PRIMARY    RohanTreeBeardRockThrow
		Weapon              =  SECONDARY  RohanTreeBeardRockFromThinAir
	End

	ArmorSet
		Conditions      = None
		Armor           = EntArmor
		DamageFX        = EntDamageFX
	End
	VisionRange = VISION_STANDARD_MELEE
	ShroudClearingRange = SHROUD_CLEAR_ENT
				
	DisplayName = OBJECT:RohanEnt
	CrusherLevel = 1	
	UseCrushAttack = No  ; Don't attack using crush, just crush when you walk through. 
	CommandSet = RohanEntCommandSet
	CommandPoints = 10
	EquivalentTo = RohanGenericEnt


	; *** AUDIO Parameters ***;

	VoiceAttack			= EntVoiceSelect
	VoiceAttackCharge		= EntVoiceSelect
	VoiceAttackMachine	= EntVoiceSelect
	VoiceAttackStructure	= EntVoiceSelect
	VoiceCreated		= EntVoiceSelect
	VoiceFullyCreated		= EntVoiceSelect
	;VoiceFear			= EntPanic
	VoiceGuard			= EntVoiceSelect
	VoiceMove			= EntVoiceSelect
	VoicePriority		= 35
	VoiceSelect			= EntVoiceSelect
	VoiceSelectBattle		= EntVoiceSelect
	
	SoundMoveLoop		= EntVoxMoveLoop
	SoundImpact			= ImpactHorse

	;UnitSpecificSounds
	;	VoiceGarrison         = NoSound
	;End

	EvaEventDamagedOwner	= UnitUnderAttack 		;Eva event to trigger when unit is damaged

	Behavior = LargeGroupAudioUpdate ModuleTag_LGAU		; Tie into LargeGroupAudio system
		Key = Ent Unit Infantry
		UnitWeight = 2						; Ents count as 2 infantry when computing group size
	End

	ClientBehavior = AnimationSoundClientBehavior ModuleTag_AnimAudioBehavior
		MaxUpdateRangeCap = 800
		AnimationSound = Sound:BuildingEntMootCouncil				Animation:RUTReeBerd_SKL.RUTreeberd_MOTA	Frames:1
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_MOTA	Frames:225 253
		AnimationSound = Sound:BuildingEntMootCouncil				Animation:RUTReeBerd_SKL.RUTreeberd_MOTB	Frames:1

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBA1	Frames:9 13
		AnimationSound = Sound:TrollTreeSwingLight				Animation:RUTReeBerd_SKL.RUTreeBerd_GBA1	Frames:10
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GBA1	Frames:16
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBA2	Frames:28 34
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBB1	Frames:18
		AnimationSound = Sound:TrollTreeSwingLight				Animation:RUTReeBerd_SKL.RUTreeBerd_GBB1	Frames:16
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeBerd_GBB1	Frames:21
		AnimationSound = Sound:EntGrabBuildingChunk				Animation:RUTReeBerd_SKL.RUTreeberd_GBB1	Frames:37
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GBB2	Frames:24

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBC	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBC	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBC	Frames:160
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBD	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBD	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBD	Frames:160
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBE	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBE	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBE	Frames:160
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_GRBF	Frames:13 26 117 179 223
		AnimationSound = Sound:EntGrabRock						Animation:RUTReeBerd_SKL.RUTreeberd_GRBF	Frames:48
		AnimationSound = Sound:EntVoxEfforts					Animation:RUTReeBerd_SKL.RUTreeberd_GRBF	Frames:160

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKA	Frames:9 78
		AnimationSound = Sound:ImpactEntGenericPunch				Animation:RUTReeBerd_SKL.RUTreeberd_ATKA	Frames:31
 		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKD	Frames:65
		AnimationSound = Sound:ImpactEntGenericKick				Animation:RUTReeBerd_SKL.RUTreeberd_ATKD	Frames:32
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKE	Frames:70
		AnimationSound = Sound:ImpactEntGenericKick				Animation:RUTReeBerd_SKL.RUTreeberd_ATKE	Frames:31
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_ATKF	Frames:16 82
		AnimationSound = Sound:ImpactEntGenericPunch				Animation:RUTReeBerd_SKL.RUTreeberd_ATKF	Frames:32

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_ACLA	Frames:9
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLA	Frames:17 42
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLB	Frames:17 44
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLC	Frames:11 41
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DCLD	Frames:32

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_WLKA	Frames:33 76
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_WLKC	Frames:22 48 
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_RUNA	Frames:4 24

		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TRNL	Frames:12 27
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TRNR	Frames:12 27
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TNL2	Frames:18 38 
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_TNR2	Frames:18 38

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_THRB	Frames:12 44
		AnimationSound = Sound:TrollTreeSwing					Animation:RUTReeBerd_SKL.RUTreeBerd_THRB	Frames:36
		AnimationSound = Sound:TrollTreeSwingLight				Animation:RUTReeBerd_SKL.RUTreeBerd_THRC	Frames:29
		
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_MADA	Frames:75
		AnimationSound = Sound:EntPanic						Animation:RUTReeBerd_SKL.RUTreeBerd_MADA	Frames:17
		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_MFDA	Frames:2 14

		AnimationSound = Sound:EntRunStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:5 120 206
		AnimationSound = Sound:EntSeeFirePart1					Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:40 
		AnimationSound = Sound:EntSeeFirePart2					Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:70
		AnimationSound = Sound:TrollTreeSwing					Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:121
		AnimationSound = Sound:EntPanic						Animation:RUTReeBerd_SKL.RUTreeBerd_RCTD	Frames:150

		AnimationSound = Sound:EntSplashWater					Animation:RUTReeBerd_SKL.RUTreeBerd_SPLA	Frames:0

		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_HITA	Frames:11 52
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_GTPA	Frames:14 24
		AnimationSound = Sound:EntFootStep			ExcludedMC:WADING	Animation:RUTReeBerd_SKL.RUTreeberd_DIEA	Frames:7 
		AnimationSound = Sound:EntDieFall						Animation:RUTReeBerd_SKL.RUTreeBerd_DIEA	Frames:63
		AnimationSound = Sound:EntDieFall						Animation:RUTReeBerd_SKL.RUTreeBerd_LNDA	Frames:3
		AnimationSound = Sound:EntBodyfall						Animation:RUTReeBerd_SKL.RUTreeBerd_LNDA	Frames:24

		;----------- water footsteps below -------------

		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_MOTA	Frames:225 253
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBA1	Frames:9 13
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBA2	Frames:28 34
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBB1	Frames:18
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GBB2	Frames:24
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBC	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBD	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBE	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_GRBF	Frames:13 26 117 179 223
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKA	Frames:9 78	
 		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKD	Frames:65
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKE	Frames:70
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_ATKF	Frames:16 82
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_ACLA	Frames:9
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLA	Frames:17 42
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLB	Frames:17 44
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLC	Frames:11 41
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DCLD	Frames:32 	
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_WLKA	Frames:33 76
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_WLKC	Frames:22 48
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_THRB	Frames:12 44
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_MADA	Frames:75	
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_HITA	Frames:11 52
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_GTPA	Frames:14 24
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeberd_DIEA	Frames:7

		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_RUNA	Frames:4 24
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TRNL	Frames:12 27
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TRNR	Frames:12 27
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TNL2	Frames:18 38
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_TNR2	Frames:18 38
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_MFDA	Frames:2 14
		AnimationSound = Sound:EntFootstepWater		RequiredMC:WADING	Animation:RUTreeberd_SKL.RUTreeBerd_RCTD	Frames:5 120 206
	End


	; *** ENGINEERING Parameters ***

	RadarPriority = UNIT
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS SCARY BIG_MONSTER ARMY_SUMMARY
	
	BuildCost = ROHAN_ENT_BUILDCOST				
	BuildTime = ROHAN_ENT_BUILDTIME				
	
	Behavior = FlammableUpdate FlammableModuleTag_15
		AflameDuration				= 0			; Burn until expressly put out.  Made of wood and all.
		AflameDamageDelay			= 500	; How often do I take damage from being on fire?
		AflameDamageAmount			= 30			; How much damage to I take per delay?
		FlameDamageLimit			= 130		; How much flame damage do I need to take before starting on fire?
		FlameDamageExpiration			= 10000
		SwapModelWhenAflame			= Yes
		SwapModelWhenQuenched			= Yes
		RunToWater				= Yes
		RunToWaterDepth				= 5		; Any water will put us out, but we'll look for something at least a little deep
	    RunToWaterSearchRadius			= 0 ; No more auto run to water, but oddly enough we need to keep the RunToWater flag if we want to get mad since we "can't find water"
		RunToWaterSearchIncrement		= 50
		PanicLocomotorWhileAflame		= Yes
		CustomAnimAndDuration			= AnimState:USER_3 AnimTime:7000 ;4667 ;FIREB animation
            FireFXList = FX:FX_FireStartEnt
	End
	
	Body = ActiveBody ModuleTag_02
		CheerRadius 		= EMOTION_CHEER_RADIUS
		MaxHealth         	= ROHAN_ENT_HEALTH				;BALANCE Ent Health
;		MaxHealthDamaged  	= 1000
;		RecoveryTime      	= 5000
	End
	
	Behavior = AIUpdateInterface ModuleTag_03
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		AILuaEventsList				=	EntFunctions	
	End

	Behavior = EntEnragedUpdate  EnragedBehaviorModuleTag
	;	EnragedLifeTimer = 15.0 ; 15 seconds lifetime
		HatedObjectFilter = NONE +LumberMill
		FriendlyDeadFilter = NONE +RohanEntFir +RohanEntBirch +RohanEntAsh +RohanTreeBerd +RohanEntFir_Summoned +RohanEntBirch_Summoned
		EnragedTime		 = 30000
		TimeUntilCanRageAgain = 0	; always enrage if you "should."
		EnragedTransitionTime = 3000
		;;;;;;;;;;;EnragedTransitionFX = FX_EntEnragedTransition
		;;;;;;;;;;;EnragedOnBuffFX		= FX_EntEnragedBuffOn	
		;;;;;;;;;;;EnragedOffBuffFX	= FX_EntEnragedBuffOff	
	End
	

	Behavior = FireWeaponWhenDeadBehavior FireDeadTag
		RequiredStatus	= DEATH_1
		StartsActive	= Yes
		DelayTime		= 2300 
		DeathWeapon		= RohanEntDeath
		WeaponOffset	= X:-48 Y:0 Z:0	;Fire the death weapon right behind the object.
	End	

	LocomotorSet
		Locomotor = RohanTreeBeardLocomotor
		Condition = SET_NORMAL 
		Speed     = 16
	End

	LocomotorSet
		Locomotor = RohanTreeBeardLocomotor
		Condition = SET_ENRAGED
		Speed     = 50
	End
	
	LocomotorSet
		Locomotor = RohanTreeBeardFastTurnLocomotor
		Condition = SET_PANIC
		Speed	  = 80
	End

	Behavior = PhysicsBehavior ModuleTag_04
		GravityMult = 1.0
	End
	
	Behavior = SlowDeathBehavior ModuleTag_50
		DeathTypes = ALL -KNOCKBACK -FADED
		DestructionDelay = 20000
		SinkDelay = 5000
		SinkRate = 0.8     ; in Dist/Sec
		Sound = INITIAL EntDie
		DeathFlags			= DEATH_1      ; Controls animation and weapon choice. Sets BOTH model condition and object status bits.
	End

	Behavior = SlowDeathBehavior ModuleTag_52
		; Same as normal death, but no sound (sound already played by SoundImpact = ... )
		DeathTypes = NONE +KNOCKBACK
		DestructionDelay = 20000
		SinkDelay = 5000
		SinkRate = 0.8     ; in Dist/Sec
		DeathFlags			= DEATH_1      ; Controls animation and weapon choice. Sets BOTH model condition and object status bits.
	End
	
  	Behavior = SlowDeathBehavior ModuleTag_FadeDeath
		DeathTypes = NONE +FADED
		SinkRate = 0.8     ; in Dist/Sec
		DestructionDelay = 10000
        DeathFlags = DEATH_2
        FX         = INITIAL   FX_UnSummonEntAllies
	End
	
	Behavior = SquishCollide ModuleTag_06
		;nothing
	End
	
	Behavior = AutoPickUpUpdate AutoPickUpForRocks
		ScanDelayTime = 0
		ScanDistance = 300;		default value is 300 units	
		PickUpKindOf = ROCK_VENDOR ; Not Rock, because this module finds someone to hit with the GrabPassenger power, and in there is where vendor is handled
		RunFromButton = Yes ; No natural scanning, wakes up to run exactly once when hit with a WakeAutoPickup button
		RunFromButtonNumber = 1; In case of multiples, this lines up with the OPTION_(ONE) field in the waking button
	End

		;building chunk
	Behavior = GrabPassengerSpecialPower ModuleTag_072                      
		SpecialPowerTemplate		= SpecialAbilityGrabPassenger2
		UpdateModuleStartsAttack	= Yes
		InitiateSound			= EntVoxGrabBuildingChunk
		AllowTree				= No
	End

	Behavior = SpecialAbilityUpdate ModuleTag_082                
		SpecialPowerTemplate    = SpecialAbilityGrabPassenger2
		StartAbilityRange       = 8.0

		UnpackTime              = 1300 ; Nothing to touching it
		PreparationTime         = 0   ; touching it to grabbing it
		PersistentPrepTime      = 0 ; grabbing it to whacking it on the ground (if shrubbery)
		PackTime                = 1700 ; whacking it to holding it nice
		
		ContactPointOverride		= Grab	; If the victim building has a point named this, we'll go there instead of to the bounding circle.

		;GrabChunkObject = EntThrownBuildingRock
		;GrabChunkFX = FX_WallGrab
		;GrabChunkDamage = 490
		;GrabChunkOffset = X:16 Y:0

;    PackSound               = 
;    UnpackSound             = 
;    TriggerSound            = 
;    PrepSoundLoop           = 
		AwardXPForTriggering    = 0
	End
	
	;pick up a rock and grab it
	Behavior = GrabPassengerSpecialPower ModuleTag_07                      
		SpecialPowerTemplate		= SpecialAbilityGrabPassenger
		UpdateModuleStartsAttack	= Yes
		GrabRadius				= 200
		AllowTree				= No
		InitiateSound			= EntVoxGrabRock
	End

	Behavior = SpecialAbilityUpdate ModuleTag_08                
		SpecialPowerTemplate    = SpecialAbilityGrabPassenger
		StartAbilityRange       = 8.0

		UnpackTime              = 600 ; Nothing to touching it
		PreparationTime         = 0   ; touching it to grabbing it
		PersistentPrepTime      = 0 ; grabbing it to whacking it on the ground (if shrubbery)
		PackTime                = 1333 ; whacking it to holding it nice
		

;    PackSound               = 
;    UnpackSound             = 
;    TriggerSound            = 
;    PrepSoundLoop           = 
		AwardXPForTriggering    = 0
	End
	Behavior = TransportContain ModuleTag_09
		ObjectStatusOfContained = UNSELECTABLE
		PassengerFilter = ANY +ROCK 
		CanGrabStructure = Yes ; Overrides buildings' natural 0 in TransportSlotCount that makes them uncontainable
		Slots = 1
		ShowPips = No
		AllowEnemiesInside = Yes
		AllowNeutralInside = Yes
		AllowAlliesInside  = No
		DamagePercentToUnits = 0%
		TypeOneForWeaponState = ROCK
		
		PassengerBonePrefix = PassengerBone:Firepoint    KindOf:ROCK 
	End

	;----------------------------------------

 	Behavior = HitReactionBehavior HitReactionBehaviorModuleTag
 		HitReactionLifeTimer1 = 2500 
		HitReactionThreshold1 = 50.0 
 	End

  	Behavior = AimWeaponBehavior AimWeaponModuleTag
		AimNearDistance = 40.0	; If target closer than this, give Near flag.  This and IsAimingWeapon combine to give extra model condition flags
	End
	
	Geometry = CYLINDER
	GeometryMajorRadius = 17.6
	GeometryHeight = 56.0
	GeometryIsSmall = No
	Shadow = SHADOW_VOLUME_NON_SELF_2; volumetric shadow that doesn't cast onto all objects using SHADOW_VOLUME_NON_SELF_2
	ShadowSizeX = 36; clamp the angle so shadow isn't as long.

End

;------------------------------------------------------------------------------
ChildObject RohanEntFir_Summoned RohanEntFir
	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS SCARY BIG_MONSTER SUMMONED ; ARMY_SUMMARY
	IsTrainable = No
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 120000
		MaxLifetime		= 120000
		DeathType		= FADED
	End	
End

;------------------------------------------------------------------------------
; aka Ent Birch
ObjectReskin RohanEntBirch RohanEntFir                
	; *** ART Parameters ***


	Draw = W3DScriptedModelDraw ModuleTag_01
	
	StaticModelLODMode = Yes

	WadingParticleSys = EntRipples
	WadingParticleSys = EntSplash
	  
	  OkToChangeModelColor = Yes
	  ExtraPublicBone = IMPACT
		ExtraPublicBone = ROCK

		DefaultModelConditionState
			Model               = RUEntBirch_SKN
			Skeleton			= RUTreeberd_SKL
			WeaponLaunchBone    = PRIMARY Firepoint
			WeaponLaunchBone    = SECONDARY Firepoint
		End
		
		;---------------------------------Burned model
   		ModelConditionState	 = WADING AFLAME
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
			ParticleSysBone     = BAT_HEAD TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_SPINE1 TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_PELVIS TreebeardSteam1 FollowBone:yes
			ParticleSysBone     = BAT_CALFR TreebeardSteam FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
			ParticleSysBone     = B_POINT1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_POINT1R TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1R TrBrdWaterDrips FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDR TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDL TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash4 FollowBone:yes

   		End

		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUTreeBerd_MADA
				AnimationName		= RUTreeBerd_MADA 
				AnimationMode		= ONCE
			End
		End

		;---------------------------------Burned model
   		ModelConditionState	 = BURNED
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState	 = BURNT_MODEL DYING
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState   = BURNT_MODEL
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
			

	;Final Fire
			
			ParticleSysBone     = BAT_HEAD TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HEAD TreebeardSmoke FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_SPINE1 TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_PELVIS TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardEmbers FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardFlare FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_CALFR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_HANDR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HANDL TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN


   		End
   		
 		
   		
		IdleAnimationState
			Animation = IDLA 
				AnimationName = RUTreeberd_IDLA ; Stand and breathe
				AnimationBlendTime  = 5
			End
			StateName = Idle
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.875 then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.625 then CurDrawableSetTransitionAnimState("TRANS_Stop75") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.375 then CurDrawableSetTransitionAnimState("TRANS_Stop50") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.125 then CurDrawableSetTransitionAnimState("TRANS_Stop25") return end
				if Prev == "Moving" then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
                if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
            ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeaves FollowBone: no
		End

 		AnimationState        = DYING
 			Animation           = Die
 				AnimationName     = RUTreeberd_DIEA
 				AnimationMode      = ONCE
 			End
 			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 
		; -------- DEBATE ANIMS ---------------
		AnimationState   = JUST_BUILT
			StateName		= STATE_JustBuilt
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ;sprout animation
				AnimationMode = MANUAL ;; hold first frame
				AnimationBlendTime = 0
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState		= PREPARING MOVING
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		
		AnimationState		= PREPARING
			StateName			= STATE_Debate
			Animation           = Debate
				AnimationName     = RUTreeberd_MOTB  ;debate animations
				AnimationMode      = LOOP
				AnimationBlendTime = 30
				AnimationSpeedFactorRange = 0.7 1.2
			End
			Flags               = RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
		End
		TransitionState   = TRANS_Sprout
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ; sprout animation
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End

						FXEvent	= Frame:25 Name:FX_EntSprout	
						FXEvent = Frame:25 Name:FX_EntSproutButterflies
		End



		
		;------ Stunned anims

		AnimationState        = STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		
		;-------------------------------------- AFLAME states
		AnimationState        = AFLAME DYING SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME DYING
			Animation           = Die
				AnimationName     = RUTreeberd_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = USER_3 ;Panic prior to run. Used by FlammableUpdate
			Animation           = OnFire
				AnimationName     = RUTreeberd_RCTD
				AnimationMode      = ONCE
				AnimationBlendTime = 20
			End
				FXEvent	= Frame:54 Name:FX_EntRightFootStep	
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End


		;-------------------------------------------------- Attack states
		AnimationState        = FIRING_OR_PREATTACK_A AIM_NEAR
			Animation       = CloseRock
				AnimationName     = RUTreeberd_THRC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_A
			Animation       = FarRock
				AnimationName     = RUTreeberd_THRB
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = CloseFakeRockMad
				AnimationName     = RUTreeberd_GRBF
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = FarFakeRockMad
				AnimationName     = RUTreeberd_GRBE
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1
			Animation       = CloseFakeRock
				AnimationName     = RUTreeberd_GRBD
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1
			Animation       = FarFakeRock
				AnimationName     = RUTreeberd_GRBC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = MOVING FIRING_OR_PREATTACK_B WEAPONSET_ENRAGED
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRB
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_B
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRA
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = FIRING_OR_PREATTACK_B 
			Animation           = Punch
				AnimationName     = RUTreeberd_ATKA 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = Punt
				AnimationName     = RUTreeberd_ATKD 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = FrontKick
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunch
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				if CurDrawableIsCurrentTargetKindof("MONSTER") then
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("FrontKick")
					else
						return ("KirkPunch")
					end
				else
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("Punch")
					else
						return ("Punt")
					end
				end
			EndScript
		End
	
		AnimationState        = FIRING_OR_PREATTACK_C 
			Animation           = FrontKickOnBuilding
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunchOnBuilding
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUTreeBerd_MADA
				AnimationName		= RUTreeBerd_MADA 
				AnimationMode		= ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

  ;-----------------------
; Enraged movement is before Aflame, because if he can't find water to run too, he gets pissed instead of panicky.
   		AnimationState        = WEAPONSET_ENRAGED TURN_LEFT
   			Animation           = Walk
 				AnimationName     = RUTreeberd_TNL2 
   				AnimationMode     = LOOP
   				AnimationSpeedFactorRange = 1.1 1.1
   			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
   		End
   
   		AnimationState        = WEAPONSET_ENRAGED TURN_RIGHT
   			Animation           = Walk
 				AnimationName     = RUTreeberd_TNR2 
   				AnimationMode     = LOOP
   				AnimationSpeedFactorRange = 1.1 1.1
   			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
   		End

		AnimationState        = WEAPONSET_ENRAGED MOVING
			Animation           = AngryStompWalk
				AnimationName     = RUTreeberd_WLKC 
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:26 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
;-----------------------

		AnimationState        = AFLAME TURN_LEFT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNL 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNR 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME MOVING
			Animation           = Jump
				AnimationName     = RUTreeberd_MFDA 
				AnimationMode      = LOOP
				AnimationSpeedFactorRange = 0.5 0.5
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:4 Name:FX_EntLeftFootStep
			FXEvent	= Frame:18 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				CurDrawablePlaySound("EntRunFire")
		    EndScript
		End

		AnimationState        =  AFLAME WADING
			Animation           = Splash
				AnimationName     = RUTreeberd_SPLA  ; Splashing water on himself
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = AFLAME STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = DYING SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB2
				AnimationMode      = ONCE
				AnimationBlendTime = 0		;We need to go instantly from unpacking to packing.
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB1
				AnimationMode      = ONCE
				AnimationBlendTime = 20		
			End
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA2
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA1
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		; --------- Moving anims.

		AnimationState				= TURN_RIGHT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNR 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState				= TURN_LEFT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNL 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= MOVING
			StateName				= Moving
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
				if Prev == "Turn" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
			EndScript			
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:39 Name:FX_EntRightFootStep
			FXEvent	= Frame:79 Name:FX_EntLeftFootStep
			FXEvent	= Frame:129 Name:FX_EntRightFootStep
		End

 
 		AnimationState						= HIT_REACTION HIT_LEVEL_1
 			Animation						= Hit_Level_1_a
 				AnimationName				= RUTreeberd_HITA
 				AnimationMode				= ONCE
 			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 		
 		AnimationState						= WEAPONSET_ENRAGED
 			Animation						= AngryIdle
 				AnimationName				= RUTreeberd_IDLC
 				AnimationMode				= LOOP
 			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 		
		TransitionState = TRANS_Accelerate
			Animation = Transition
				AnimationName = RUTreeberd_ACLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.75 0.75
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop75
			Animation = Transition
				AnimationName = RUTreeberd_DCLC
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop50
			Animation = Transition
				AnimationName = RUTreeberd_DCLB
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop25
			Animation = Transition
				AnimationName = RUTreeberd_DCLD
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop00
			Animation = Transition
				AnimationName = RUTreeberd_DCLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End
	End
End

;------------------------------------------------------------------------------
ChildObject RohanEntBirch_Summoned RohanEntFir
	Draw = W3DScriptedModelDraw ModuleTag_01
	
	StaticModelLODMode = Yes

	WadingParticleSys = EntRipples
	WadingParticleSys = EntSplash
	  
	  OkToChangeModelColor = Yes
	  ExtraPublicBone = IMPACT
		ExtraPublicBone = ROCK

		DefaultModelConditionState
			Model               = RUEntBirch_SKN
			Skeleton			= RUTreeberd_SKL
			WeaponLaunchBone    = PRIMARY Firepoint
			WeaponLaunchBone    = SECONDARY Firepoint
		End
		
		;---------------------------------Burned model
   		ModelConditionState	 = WADING AFLAME
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
			ParticleSysBone     = BAT_HEAD TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_SPINE1 TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_PELVIS TreebeardSteam1 FollowBone:yes
			ParticleSysBone     = BAT_CALFR TreebeardSteam FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
			ParticleSysBone     = B_POINT1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_POINT1R TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1R TrBrdWaterDrips FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDR TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDL TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash4 FollowBone:yes

   		End

		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUTreeBerd_MADA
				AnimationName		= RUTreeBerd_MADA 
				AnimationMode		= ONCE
			End
		End

		;---------------------------------Burned model
   		ModelConditionState	 = BURNED
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState	 = BURNT_MODEL DYING
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
   		End
		
   		ModelConditionState   = BURNT_MODEL
   			Model               = RUEntBirchD_SKN
   			Skeleton            = RUTreeBerd_SKL
			

	;Final Fire
			
			ParticleSysBone     = BAT_HEAD TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HEAD TreebeardSmoke FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_SPINE1 TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_PELVIS TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardEmbers FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardFlare FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_CALFR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_HANDR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HANDL TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN


   		End
   		
 		
   		
		IdleAnimationState
			Animation = IDLA 
				AnimationName = RUTreeberd_IDLA ; Stand and breathe
				AnimationBlendTime  = 5
			End
			StateName = Idle
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.875 then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.625 then CurDrawableSetTransitionAnimState("TRANS_Stop75") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.375 then CurDrawableSetTransitionAnimState("TRANS_Stop50") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.125 then CurDrawableSetTransitionAnimState("TRANS_Stop25") return end
				if Prev == "Moving" then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
                if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
            ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeaves FollowBone: no
		End

 		AnimationState        = DYING DEATH_1
 			Animation           = Die
 				AnimationName     = RUTreeberd_DIEA
 				AnimationMode      = ONCE
 			End
 			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 
 
 		AnimationState        = DYING DEATH_2
 			Animation           = Die
 				AnimationName     = RUTreeberd_MOTA
 				AnimationMode      = ONCE_BACKWARDS
 			End
            Flags = START_FRAME_LAST
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 
		; -------- DEBATE ANIMS ---------------
		AnimationState   = JUST_BUILT
			StateName		= STATE_JustBuilt
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ;sprout animation
				AnimationMode = MANUAL ;; hold first frame
				AnimationBlendTime = 0
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState		= PREPARING MOVING
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		
		AnimationState		= PREPARING
			StateName			= STATE_Debate
			Animation           = Debate
				AnimationName     = RUTreeberd_MOTB  ;debate animations
				AnimationMode      = LOOP
				AnimationBlendTime = 30
				AnimationSpeedFactorRange = 0.7 1.2
			End
			Flags               = RANDOMSTART
			
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
		End
		TransitionState   = TRANS_Sprout
			Animation = Sprout
				AnimationName = RUTreeberd_MOTA  ; sprout animation
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End

						FXEvent	= Frame:25 Name:FX_EntSprout	
						FXEvent = Frame:25 Name:FX_EntSproutButterflies
		End



		
		;------ Stunned anims

		AnimationState        = STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		
		;-------------------------------------- AFLAME states
		AnimationState        = AFLAME DYING DEATH_1 SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME DYING DEATH_1
			Animation           = Die
				AnimationName     = RUTreeberd_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = USER_3 ;Panic prior to run. Used by FlammableUpdate
			Animation           = OnFire
				AnimationName     = RUTreeberd_RCTD
				AnimationMode      = ONCE
				AnimationBlendTime = 20
			End
				FXEvent	= Frame:54 Name:FX_EntRightFootStep	
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End


		;-------------------------------------------------- Attack states
		AnimationState        = FIRING_OR_PREATTACK_A AIM_NEAR
			Animation       = CloseRock
				AnimationName     = RUTreeberd_THRC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_A
			Animation       = FarRock
				AnimationName     = RUTreeberd_THRB
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = CloseFakeRockMad
				AnimationName     = RUTreeberd_GRBF
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1 WEAPONSET_ENRAGED
			Animation       = FarFakeRockMad
				AnimationName     = RUTreeberd_GRBE
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B AIM_NEAR WEAPONSET_TOGGLE_1
			Animation       = CloseFakeRock
				AnimationName     = RUTreeberd_GRBD
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0		;Without this, the visibility tracking comes from the old anim.  So the rock shows during the blend frames.
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = FIRING_OR_PREATTACK_B WEAPONSET_TOGGLE_1
			Animation       = FarFakeRock
				AnimationName     = RUTreeberd_GRBC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime	= 0
			End

			FXEvent	= Frame:47	Name: FX_EntRockGrab
			FXEvent	= Frame:87	Name: FX_EntRockYank

			FrameForPristineBonePositions = 175
			BeginScript
				CurDrawableShowSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = MOVING FIRING_OR_PREATTACK_B WEAPONSET_ENRAGED
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRB
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = MOVING FIRING_OR_PREATTACK_B
			Animation           = RunAndFire
				AnimationName       = RUTreeberd_ATRA
				AnimationMode       = LOOP
			End
		End
		
		AnimationState        = FIRING_OR_PREATTACK_B 
			Animation           = Punch
				AnimationName     = RUTreeberd_ATKA 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = Punt
				AnimationName     = RUTreeberd_ATKD 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = FrontKick
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunch
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				if CurDrawableIsCurrentTargetKindof("MONSTER") then
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("FrontKick")
					else
						return ("KirkPunch")
					end
				else
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("Punch")
					else
						return ("Punt")
					end
				end
			EndScript
		End
	
		AnimationState        = FIRING_OR_PREATTACK_C 
			Animation           = FrontKickOnBuilding
				AnimationName     = RUTreeberd_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = KirkPunchOnBuilding
				AnimationName     = RUTreeberd_ATKF 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUTreeBerd_MADA
				AnimationName		= RUTreeBerd_MADA 
				AnimationMode		= ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

  ;-----------------------
; Enraged movement is before Aflame, because if he can't find water to run too, he gets pissed instead of panicky.
   		AnimationState        = WEAPONSET_ENRAGED TURN_LEFT
   			Animation           = Walk
 				AnimationName     = RUTreeberd_TNL2 
   				AnimationMode     = LOOP
   				AnimationSpeedFactorRange = 1.1 1.1
   			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
   		End
   
   		AnimationState        = WEAPONSET_ENRAGED TURN_RIGHT
   			Animation           = Walk
 				AnimationName     = RUTreeberd_TNR2 
   				AnimationMode     = LOOP
   				AnimationSpeedFactorRange = 1.1 1.1
   			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
   		End

		AnimationState        = WEAPONSET_ENRAGED MOVING
			Animation           = AngryStompWalk
				AnimationName     = RUTreeberd_WLKC 
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:26 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
;-----------------------

		AnimationState        = AFLAME TURN_LEFT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNL 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUTreeberd_TRNR 
				AnimationMode     = LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME MOVING
			Animation           = Jump
				AnimationName     = RUTreeberd_MFDA 
				AnimationMode      = LOOP
				AnimationSpeedFactorRange = 0.5 0.5
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:4 Name:FX_EntLeftFootStep
			FXEvent	= Frame:18 Name:FX_EntRightFootStep
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				CurDrawablePlaySound("EntRunFire")
		    EndScript
		End

		AnimationState        =  AFLAME WADING
			Animation           = Splash
				AnimationName     = RUTreeberd_SPLA  ; Splashing water on himself
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = AFLAME STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUTreeberd_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED
			Animation           = Stun
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = AFLAME STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUTreeberd_GTPA
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState        = DYING DEATH_1 SPLATTED
			Animation           = DieSplat
				AnimationName     = RUTreeberd_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB2
				AnimationMode      = ONCE
				AnimationBlendTime = 0		;We need to go instantly from unpacking to packing.
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUTreeberd_GBB1
				AnimationMode      = ONCE
				AnimationBlendTime = 20		
			End
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = PACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA2
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		AnimationState        = UNPACKING
			Animation           = Pack
				AnimationName     = RUTreeberd_GBA1
				AnimationMode      = ONCE
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End

		; --------- Moving anims.

		AnimationState				= TURN_RIGHT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNR 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
		
		AnimationState				= TURN_LEFT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUTreeberd_TRNL 
				AnimationMode		= LOOP
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
		End
	
		AnimationState				= MOVING
			StateName				= Moving
			Animation				= Walk
				AnimationName		= RUTreeberd_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
				if Prev == "Turn" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
			EndScript			
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:39 Name:FX_EntRightFootStep
			FXEvent	= Frame:79 Name:FX_EntLeftFootStep
			FXEvent	= Frame:129 Name:FX_EntRightFootStep
		End

 
 		AnimationState						= HIT_REACTION HIT_LEVEL_1
 			Animation						= Hit_Level_1_a
 				AnimationName				= RUTreeberd_HITA
 				AnimationMode				= ONCE
 			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 		
 		AnimationState						= WEAPONSET_ENRAGED
 			Animation						= AngryIdle
 				AnimationName				= RUTreeberd_IDLC
 				AnimationMode				= LOOP
 			End
			BeginScript
				CurDrawableHideSubObjectPermanently("ROCK")
			EndScript
 		End
 		
		TransitionState = TRANS_Accelerate
			Animation = Transition
				AnimationName = RUTreeberd_ACLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.75 0.75
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop75
			Animation = Transition
				AnimationName = RUTreeberd_DCLC
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop50
			Animation = Transition
				AnimationName = RUTreeberd_DCLB
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop25
			Animation = Transition
				AnimationName = RUTreeberd_DCLD
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop00
			Animation = Transition
				AnimationName = RUTreeberd_DCLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End
	End

	KindOf = PRELOAD SELECTABLE CAN_CAST_REFLECTIONS MONSTER SCORE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT PATH_THROUGH_INFANTRY CAN_ATTACK_WALLS SCARY BIG_MONSTER SUMMONED; ARMY_SUMMARY

	IsTrainable = No
	CommandPoints = 0
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 120000
		MaxLifetime		= 120000
		DeathType		= FADED
	End	
End

;------------------------------------------------------------------------------
; aka Ent Ash
ObjectReskin RohanEntAsh RohanEntFir                
	; *** ART Parameters ***


	Draw = W3DScriptedModelDraw ModuleTag_01
	
	StaticModelLODMode = Yes

	WadingParticleSys = EntRipples
	WadingParticleSys = EntSplash

	  OkToChangeModelColor = Yes
	  ExtraPublicBone = IMPACT

		DefaultModelConditionState
			Model               = RUEntAsh_SKN
			Skeleton			      = RUEntAsh_SKL
			;WeaponLaunchBone    = PRIMARY Firepoint
		End
		
		;---------------------------------Burned model
   		ModelConditionState	 = WADING AFLAME
   			Model               = RUEntAshD_SKN
   			Skeleton            = RUEntAsh_SKL
			ParticleSysBone     = BAT_HEAD TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_SPINE1 TreebeardSteam FollowBone:yes
			ParticleSysBone     = BAT_PELVIS TreebeardSteam1 FollowBone:yes
			ParticleSysBone     = BAT_CALFR TreebeardSteam FollowBone:yes
			ParticleSysBone     = B_POINT1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_POINT1R TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1L TrBrdWaterDrips FollowBone:yes
			ParticleSysBone     = B_THUMB1R TrBrdWaterDrips FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterRipples FollowBone:no
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDR TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_HANDL TrBrdWaterSplash2 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash3 FollowBone:yes
;			ParticleSysBone     = BAT_SPINE1 TrBrdWaterSplash4 FollowBone:yes


   		End
		
		AnimationState				= INITIAL_ENRAGED
			StateName				= Enraged
			Animation				= RUEntAsh_MADA
				AnimationName		= RUEntAsh_MADA 
				AnimationMode		= ONCE
			End
		End

   		ModelConditionState   = BURNED
   			Model               = RUEntAshD_SKN
   			Skeleton            = RUEntAsh_SKL
   		End
   		
   		ModelConditionState   = BURNT_MODEL DYING
   			Model               = RUEntAshD_SKN
   			Skeleton            = RUEntAsh_SKL
   		End
   		
   		ModelConditionState   = BURNT_MODEL
   			Model               = RUEntAshD_SKN
   			Skeleton            = RUEntAsh_SKL
			

	;Final Fire
			
			ParticleSysBone     = BAT_HEAD TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HEAD TreebeardSmoke FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_SPINE1 TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_PELVIS TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardEmbers FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_PELVIS TreebeardFlare FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_CALFR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN

			ParticleSysBone     = BAT_HANDR TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN
			ParticleSysBone     = BAT_HANDL TreebeardFire FollowBone:yes FXTrigger:NONE Persist:SPAWN


   		End
   		
 		
   		
		IdleAnimationState
			Animation = IDLA 
				AnimationName = RUEntAsh_IDLA ; Stand and breathe
				AnimationBlendTime  = 5
			End
			StateName = Idle
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.875 then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.625 then CurDrawableSetTransitionAnimState("TRANS_Stop75") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.375 then CurDrawableSetTransitionAnimState("TRANS_Stop50") return end
				if Prev == "Moving" and CurDrawablePrevAnimFraction()>0.125 then CurDrawableSetTransitionAnimState("TRANS_Stop25") return end
				if Prev == "Moving" then CurDrawableSetTransitionAnimState("TRANS_Stop00") return end
                if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
            ParticleSysBone     = BAT_SPINE1 TreeBeardIdleLeaves FollowBone: no
		End

		; -------- DEBATE ANIMS ---------------
		AnimationState   = JUST_BUILT
			StateName		= STATE_JustBuilt
			Animation = Sprout
				AnimationName = RUEntAsh_MOTA  ;sprout animation
				AnimationMode = MANUAL ;; hold first frame
				AnimationBlendTime = 0
			End
		End
		
		
		AnimationState		= PREPARING
			StateName			= STATE_Debate
			Animation           = Debate
				AnimationName     = RUEntAsh_MOTB  ;debate animations
				AnimationMode      = LOOP
				AnimationBlendTime = 30
				AnimationSpeedFactorRange = 0.8 1.1
			End
			Flags               = RANDOMSTART
			
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "STATE_JustBuilt" then CurDrawableSetTransitionAnimState("TRANS_Sprout") end
			EndScript			
		End
		TransitionState   = TRANS_Sprout
			Animation = Sprout
				AnimationName = RUEntAsh_MOTA  ; sprout animation
				AnimationMode = ONCE
				AnimationBlendTime = 0
			End
			
						FXEvent	= Frame:25 Name:FX_EntSprout	
						FXEvent = Frame:25 Name:FX_EntSproutButterflies
		End



		
		;------ Stunned anims

		AnimationState        = STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUEntAsh_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
		End

		AnimationState        = STUNNED
			Animation           = Stun
				AnimationName     = RUEntAsh_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
		End

		AnimationState        = STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUEntAsh_GTPA
				AnimationMode      = ONCE
			End
		End

		
		;-------------------------------------- AFLAME states
		AnimationState        = AFLAME DYING SPLATTED
			Animation           = DieSplat
				AnimationName     = RUEntAsh_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
		End

		AnimationState        = AFLAME DYING
			Animation           = Die
				AnimationName     = RUEntAsh_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
		End
		
		AnimationState        = USER_3 ;Panic prior to run. Used by FlammableUpdate
			Animation           = OnFire
				AnimationName     = RUEntAsh_RCTA			; Hey, if you ever update this guy, please note that this is the one filename difference.  It is _RCTD on the others.
				AnimationMode      = ONCE
				AnimationBlendTime = 20
			End
				FXEvent	= Frame:54 Name:FX_EntRightFootStep	
		End


		AnimationState        = FIRING_OR_PREATTACK_C AFLAME
			Animation           = Attack
				AnimationName     = RUEntAsh_ATKC
				AnimationMode       = ONCE
				AnimationBlendTime = 0
				UseWeaponTiming		= Yes
			End
		End
	
		;-------------------------------------------------- Attack states
		AnimationState        = FIRING_OR_PREATTACK_A AIM_NEAR
			Animation       = CloseRock
				AnimationName     = RUEntAsh_THRC
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
		End

		AnimationState        = FIRING_OR_PREATTACK_A
			Animation       = FarRock
				AnimationName     = RUEntAsh_THRB
				AnimationMode       = ONCE
				UseWeaponTiming		= Yes
				AnimationBlendTime  = 0
			End

			FrameForPristineBonePositions = 39
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
		End

		AnimationState        = FIRING_OR_PREATTACK_B 
			Animation           = Punch
				AnimationName     = RUEntAsh_ATKA 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = Punt
				AnimationName     = RUEntAsh_ATKD 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			Animation           = ShoulderBlock
				AnimationName     = RUEntAsh_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			BeginScript
				if CurDrawableIsCurrentTargetKindof("MONSTER") then
					return ("ShoulderBlock")
				else
					if GetClientRandomNumberReal(0,1) > 0.50 then
						return ("Punch")
					else
						return ("Punt")
					end
				end
			EndScript
		End
	
		AnimationState        = FIRING_OR_PREATTACK_C 
			Animation           = ShoulderBlockForBuilding
				AnimationName     = RUEntAsh_ATKE 
				AnimationMode       = ONCE
				AnimationBlendTime = 5
				UseWeaponTiming		= Yes
			End
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
		End
	
;-----------------------
; Enraged is before Aflame, because if he can't find water to run too, he gets pissed instead of panicky.
		AnimationState        = WEAPONSET_ENRAGED TURN_LEFT
			Animation           = Walk
				AnimationName     = RUEntAsh_TRNL 
				AnimationMode     = LOOP
				AnimationSpeedFactorRange = 1.1 1.1
			End
		End

		AnimationState        = WEAPONSET_ENRAGED TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUEntAsh_TRNR 
				AnimationMode     = LOOP
				AnimationSpeedFactorRange = 1.1 1.1
			End
		End

		AnimationState        = WEAPONSET_ENRAGED MOVING
			Animation           = AngryStompWalk
				AnimationName     = RUEntAsh_WLKC 
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_EntLeftFootStep
			FXEvent	= Frame:26 Name:FX_EntRightFootStep
		End
;-----------------------

		AnimationState        = AFLAME TURN_LEFT
			Animation           = Walk
				AnimationName     = RUEntAsh_TRNL 
				AnimationMode     = LOOP
			End
		End

		AnimationState        = AFLAME TURN_RIGHT
			Animation           = Walk
				AnimationName     = RUEntAsh_TRNR 
				AnimationMode     = LOOP
			End
		End

		AnimationState        = AFLAME MOVING
			Animation           = Jump
				AnimationName     = RUEntAsh_MFDA 
				AnimationMode      = LOOP
				AnimationSpeedFactorRange = 0.5 0.5
				AnimationBlendTime  = 5
				Distance			= 50
			End
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:4 Name:FX_EntLeftFootStep
			FXEvent	= Frame:18 Name:FX_EntRightFootStep
			BeginScript
				CurDrawablePlaySound("EntRunFire")
		    EndScript
		End

		AnimationState        =  AFLAME WADING
			Animation           = Splash
				AnimationName     = RUEntAsh_SPLA  ; Splashing water on himself
				AnimationMode      = LOOP
				AnimationBlendTime  = 5
			End
		End
		
		AnimationState        = AFLAME STUNNED_FLAILING
			Animation           = StunFlail
				AnimationName     = RUEntAsh_FLYA
				AnimationMode      = LOOP
			End
			Flags               = RANDOMSTART
		End

		AnimationState        = AFLAME STUNNED
			Animation           = Stun
				AnimationName     = RUEntAsh_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
		End

		AnimationState        = AFLAME STUNNED_STANDING_UP
			Animation           = Stun
				AnimationName     = RUEntAsh_GTPA
				AnimationMode      = ONCE
			End
		End
		
		AnimationState        = DYING SPLATTED
			Animation           = DieSplat
				AnimationName     = RUEntAsh_LNDA
				AnimationMode      = ONCE
			End
				ParticleSysBone = BAT_SPINE1 TreebeardSplatDust1 FollowBone:Yes
		End

		AnimationState        = DYING
			Animation           = Die
				AnimationName     = RUEntAsh_DIEA
				AnimationMode      = ONCE
			End
			ParticleSysBone = BAT_SPINE1 TreebeardSplatDust FollowBone:Yes
		End

		AnimationState        = PACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUEntAsh_GRB2
				AnimationMode      = ONCE
				AnimationBlendTime = 0		;We need to go instantly from unpacking to packing.
			End
		End

		AnimationState        = UNPACKING GRAB_BUILDING_CHUNK
			Animation           = Pack
				AnimationName     = RUEntAsh_GRB1
				AnimationMode      = ONCE
				AnimationBlendTime = 20		
			End
			ParticleSysBone     = ParticleNode01 TreeBeardAttackLeavesFir
			ParticleSysBone	= BAT_HAND_R TrollRockBounceSmall FollowBone:no
			ParticleSysBone	= BAT_HAND_R TrollRockPickup FollowBone:no
		End

		AnimationState        = PACKING
			Animation           = Pack
				AnimationName     = RUEntAsh_GRC2
				AnimationMode      = ONCE
			End
		End

		AnimationState        = UNPACKING
			Animation           = Pack
				AnimationName     = RUEntAsh_GRC1
				AnimationMode      = ONCE
			End
		End

		; --------- Moving anims.

		AnimationState				= TURN_RIGHT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUEntAsh_TRNR 
				AnimationMode		= LOOP
			End
		End
		
		AnimationState				= TURN_LEFT
			StateName				= Turn
			Animation				= Walk
				AnimationName		= RUEntAsh_TRNL 
				AnimationMode		= LOOP
			End
		End
	
		AnimationState				= MOVING
			StateName				= Moving
			Animation				= Walk
				AnimationName		= RUEntAsh_WLKA 
				Distance			= 48.0
				AnimationMode		= LOOP
				AnimationBlendTime	= 5
			End
			BeginScript
				Prev = CurDrawablePrevAnimationState()
				if Prev == "Idle" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
				if Prev == "Turn" then CurDrawableSetTransitionAnimState("TRANS_Accelerate") end
			EndScript			
			Flags = MAINTAIN_FRAME_ACROSS_STATES
			FXEvent	= Frame:0 Name:FX_AshEntLeftFootStep
			FXEvent	= Frame:41 Name:FX_AshEntRightFootStep
		End

		TransitionState = TRANS_Accelerate
			Animation = Transition
				AnimationName = RUEntAsh_ACLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.75 0.75
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop75
			Animation = Transition
				AnimationName = RUEntAsh_DCLC
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop50
			Animation = Transition
				AnimationName = RUEntAsh_DCLB
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop25
			Animation = Transition
				AnimationName = RUEntAsh_DCLD
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End

		TransitionState = TRANS_Stop00
			Animation = Transition
				AnimationName = RUEntAsh_DCLA
				AnimationMode = ONCE
				AnimationSpeedFactorRange 0.66 0.66
				AnimationBlendTime = 5
			End
		End
	End
End

;--------




