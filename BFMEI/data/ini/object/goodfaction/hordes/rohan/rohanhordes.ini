;------------------------------------------------------------------------------
;
;	RohanHordes.ini
;
;------------------------------------------------------------------------------

Object RohanRohirrimHorde

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage		= BRStables_RohirrimPike
	SelectPortrait	= UPRohan_Rohirrimpike

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR EMOTION_CELEBRATING
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x1
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRURoh
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeRohanRohirrim
	
	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY	NormalMeleeHordeRangefinder		; Spear
	End

	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members

	BuildCost = ROHAN_ROHIRRIM_BUILDCOST			
	BuildTime = ROHAN_ROHIRRIM_BUILDTIME			
	VisionRange = ROHAN_ROHIRRIM_HORDE_VISION_RANGE
	CommandPoints = 20
		  
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
	CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 1 
	MinCrushVelocityPercent = 50% ; Has to be moving at at least 25% of full speed.
	CrushDecelerationPercent = 30% ; Lose 10 percent (100/5 horde members) of max velocity when crushing.
	CrushKnockback = 40  ; how hard we knock back crushed units.
	CrushZFactor = 1.0  ; How much we knock upwards.
		
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE  ARMY_SUMMARY;UNATTACKABLE 
	CommandSet = RohirrimHordeCommandSet
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate			= 500
		MaxCowerTime				= 5000
		MinCowerTime				= 3000
		AILuaEventsList				= CavalryFunctions  
		AttackPriority				= AttackPriority_Cavalry
	End

	;This module allows riderless horses to be replenished should they go
	;close to this stables.
	Behavior				= ReplenishUnitsBehavior ModuleTag_ReplenishUnitsBehavior01
		ReplenishDelay = 5000					;How often can I replenish a unit?
		ReplenishRadius = 120.0					;Only replenish needed units if they are this close.
		NoReplenishIfEnemyWithinRadius = 200.0f	;If enemies are this close, don't replenish!
		ReplenishStatii = RIDERLESS				;Only objects with this status can get replenished.
		ReplenishFXList = FX_MagicHit			;Triggers an FXList when unit is replenished (sound and/or particle system)
		ReplenishHordeMembersOnly = Yes
  		StartsActive = Yes
	End

	Behavior = HorseHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrim 5
		Slots = 5
		PassengerFilter = NONE +CAVALRY +RohanBanner
		ShowPips = No
		RandomOffset = X:3 Y:4
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanRohirrim	Pos:X:40.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:6 Y:0		Position:X:0 Y:25		Position:X:0 Y:-25		Position:X:-7 Y:50		Position:X:-7 Y:-50 

		; Normal formation
		ComboHorde = Target:RohanPeasantHorde		Result:RohanRohirrimPeasantComboHorde		InitiateVoice:RohirrimVoiceJoinAnybody 

		RanksToReleaseWhenAttacking = 1
		AlternateFormation = RohanRohirrimHordeWedgeFormation
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
    Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
 		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
 		TauntAndPointExcluded		=	NONE
		AfraidOf					=	NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil;Must be SCARY kindof as well.
		AlwaysAfraidOf				=	NONE +MordorBalrog +RohanOathbreaker +MordorSauron ;+MordorWitchKing +MordorWitchKingOnFellBeast
 		PointAt				=	NONE +MordorFellBeast +MordorWitchKingOnFellBeast 
 		HeroScanDistance		=	150
 		FearScanDistance		=	CAVALRY_FEAR_SCAN_RADIUS
 		
		AddEmotion					=	Terror_Base
		
 		AddEmotion					=	OVERRIDE Point_Base
 			Duration			=	2500
 		End
 		
 		AddEmotion					=	Taunt_Base
		AddEmotion					=	CheerIdle_Base
 		AddEmotion					=	CheerBusy_Base
 		
 		AddEmotion					=	OVERRIDE HeroCheerIdle_Base
			;StartFXList				=	RohirrimHeroCheerSound 			
 		End
 		AddEmotion					=	OVERRIDE HeroCheerBusy_Base
 			;StartFXList				=	RohirrimHeroCheerSound 			
 		End
		AddEmotion	=	Alert_Base
		
 	End		
    
	LocomotorSet
		Locomotor     = NormalCavalryHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_CAVALRY_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_RohanHorseShield Upgrade_TechnologyRohanHorseShield
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 12.0
	GeometryMinorRadius = 24.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End

ChildObject RohanRohirrimHorde_Summoned RohanRohirrimHorde
	IsTrainable = No
	CommandPoints = 0
	CommandSet = RohirrimHordeCommandSet_Summoned
	EquivalentTo = RohanRohirrimHorde
	
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE SUMMONED
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	; This one displays the timer, but the one in the uint does the work 
		MinLifetime		= 180000
		MaxLifetime		= 180000
		DeathType		= FADED
	End	
	Behavior = HorseHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrim_Summoned 5
		Slots = 5
		PassengerFilter = NONE +CAVALRY ;+RohanBanner
		ShowPips = No
		RandomOffset = X:3 Y:4
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
;		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
;		BannerCarrierPosition	= UnitType:RohanRohirrim	Pos:X:40.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo = RankNumber:1 UnitType:RohanRohirrim_Summoned Position:X:6 Y:0		Position:X:0 Y:25		Position:X:0 Y:-25		Position:X:-7 Y:50		Position:X:-7 Y:-50 

		; Normal formation
;		ComboHorde = Target:RohanPeasantHorde		Result:RohanRohirrimPeasantComboHorde		InitiateVoice:RohirrimVoiceJoinAnybody 

		RanksToReleaseWhenAttacking = 1
;		AlternateFormation = RohanRohirrimHordeWedgeFormation
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

End

ChildObject RohanRohirrimArcherHorde RohanRohirrimHorde

	DisplayName = OBJECT:HordeRohanRohirrimArchers

	ButtonImage = BRStables_Rohirrimarcher
	SelectPortrait	= UPRohan_Rohirrimarcher

	BuildCost = ROHAN_ROHIRRIM_ARCHER_BUILDCOST			
	BuildTime = ROHAN_ROHIRRIM_ARCHER_BUILDTIME

	WeaponSet
		Conditions	= None 
		Weapon		= PRIMARY	NormalMissileHordeRangefinder	; Bow
	End
	
	CommandSet = RohirrimArcherHordeCommandSet
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY ARCHER ;UNATTACKABLE 	

	Behavior = HorseHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrimArcher 5
		Slots = 5
		PassengerFilter = NONE +CAVALRY +RohanBanner
		ShowPips = No
		RandomOffset = X:3 Y:4
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanRohirrimArcher	Pos:X:30.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher Position:X:6 Y:0		Position:X:0 Y:25		Position:X:0 Y:-25		Position:X:-7 Y:50		Position:X:-7 Y:-50 
		
		; Normal formation		
;		ComboHorde = Target:RohanPeasantHorde		Result:RohanRohirrimArcherPeasantComboHorde		InitiateVoice:RohirrimVoiceJoinAnybody 

		RanksToReleaseWhenAttacking = 1
		AlternateFormation = RohanRohirrimArcherHordeWedgeFormation
	End
	
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes ATTACK_BUILDINGS
		MoodAttackCheckRate			= 500
		MaxCowerTime				= 5000
		MinCowerTime				= 3000
		AILuaEventsList				= CavalryFunctions  
		AttackPriority				= AttackPriority_Cavalry
;		Turret
;			TurretTurnRate			= 360		; turn rate, in degrees per sec
;			ControlledWeaponSlots	= PRIMARY
;		End
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanFireArrows Upgrade_TechnologyRohanFireArrows
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanRohirrimHordeWedgeFormation RohanRohirrimHorde

	; This is handled in RohanHorseWedge modifiers.  
	; For alternate formations, all data outside of the Horde Contain 
	; is ignored.  MinCrushVelocityPercent = 25% 

	Behavior = HorseHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrim 5
		Slots = 5
		PassengerFilter = NONE +CAVALRY +RohanBanner
		ShowPips = No
		ThisFormationIsTheMainFormation = No	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:7 Y:3
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanRohirrim	Pos:X:30.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo = RankNumber:1 UnitType:RohanRohirrim Position:X:0 Y:0		Position:X:-30 Y:30		Position:X:-30 Y:-30		Position:X:-60 Y:60		Position:X:-60 Y:-60 
		
		RanksToReleaseWhenAttacking = 1
		
		; Normal formation		
		ComboHorde = Target:RohanPeasantHorde		Result:RohanRohirrimPeasantComboHorde		InitiateVoice:RohirrimVoiceJoinAnybody 
		
		AlternateFormation = RohanRohirrimHorde
		AttributeModifiers = RohanHorseWegde
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanRohirrimArcherHordeWedgeFormation RohanRohirrimHorde

	; This is handled in RohanHorseWedge modifiers.  
	; For alternate formations, all data outside of the Horde Contain 
	; is ignored.  MinCrushVelocityPercent = 25% 

	Behavior = HorseHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrimArcher 5
		Slots = 5
		PassengerFilter = NONE +CAVALRY +RohanBanner
		ShowPips = No
		ThisFormationIsTheMainFormation = No	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:7 Y:3
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanRohirrimArcher	Pos:X:30.0 Y:0.0	; (DEFAULT) position of banner carrier for archer horde
		
		RankInfo = RankNumber:1 UnitType:RohanRohirrimArcher Position:X:0 Y:0		Position:X:-30 Y:30		Position:X:-30 Y:-30		Position:X:-60 Y:60		Position:X:-60 Y:-60 
		
		RanksToReleaseWhenAttacking = 1
		
		; Normal formation		
;		ComboHorde = Target:RohanPeasantHorde		Result:RohanRohirrimArcherPeasantComboHorde		InitiateVoice:RohirrimVoiceJoinAnybody 
		
		AlternateFormation = RohanRohirrimArcherHorde
		AttributeModifiers = RohanHorseWegde
	End
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanRohirrimPeasantComboHorde RohanRohirrimHorde

SelectPortrait = UPRohan_Army

	DisplayName = OBJECT:HordeRohanRohirrimPeasantCombo

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR SELECTED
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp7x6
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_7By6
		End
	End
	
	CommandPoints = 25	
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE COMBO_HORDE MELEE_HORDE ARMY_SUMMARY CAVALRY
	
	Behavior = HordeWorkerAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
		ComboLocomotorSet			= SET_COMBO
		AILuaEventsList				= InfantryFunctions  
		ComboLocoAttackDistance		= 100; If we are farther than this from an enemy, use combo locomotor.
		AttackPriority				= AttackPriority_Cavalry
		SpecialContactPoints		   = Repair
	End
	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrim 5
		InitialPayload = RohanPeasant 5
		Slots = 10
		PassengerFilter = ANY +INFANTRY +CAVALRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanPeasant		Pos:X:40.0 Y:0.0		; (DEFAULT) position of banner carrier for peasant horde
;		BannerCarrierPosition	= UnitType:RohanRohirrim	Pos:X:-12.5 Y:0.0		; position of banner carrier for rohirrim horde
		
		; Positions for 10
		RankInfo = RankNumber:1 UnitType:RohanPeasant	Position:X:20 Y:0	Position:X:20 Y:20		Position:X:20 Y:-20		Position:X:20 Y:40		Position:X:20 Y:-40 
		RankInfo = RankNumber:2 UnitType:RohanRohirrim	Position:X:-30 Y:0	Position:X:-30 Y:20		Position:X:-30 Y:-20	Position:X:-30 Y:40		Position:X:-30 Y:-40

		SplitHorde = SplitResult:RohanRohirrimHorde	UnitType:RohanRohirrim
		SplitHorde = SplitResult:RohanPeasantHorde	UnitType:RohanPeasant

		RanksThatStopAdvance = 1
		RanksToReleaseWhenAttacking = 1 2 
		RanksToJustFreeWhenAttacking = 1 2 
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
		SpecialPowerTemplate      = SpecialAbilitySplitHorde
	End

	; Behavior = RepairSpecialPower ModuleTag_RepairSPecialPower
	;	SpecialPowerTemplate      = SpecialRepairStructure
	; End		

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_CAVALRY_HORDE_SPEED
	End

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_COMBO
		Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
	End
	
	CommandSet = RohanRohirrimPeasantComboHordeCommandSet
	
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanHorseShield Upgrade_TechnologyRohanHorseShield
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality5
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 40.0
	GeometryMinorRadius = 40.0
	GeometryHeight = 20.0
	GeometryIsSmall = No	
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanRohirrimArcherPeasantComboHorde RohanRohirrimHorde

SelectPortrait = UPRohan_Army

	DisplayName = OBJECT:HordeRohanRohirrimArcherPeasantCombo

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR SELECTED
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp7x6
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_7By6
		End
	End
	
	CommandPoints = 25	
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE COMBO_HORDE MELEE_HORDE ARMY_SUMMARY CAVALRY ARCHER
	
	Behavior = HordeWorkerAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
		ComboLocomotorSet			= SET_COMBO
		AILuaEventsList				= InfantryFunctions  
		; ComboLocoAttackDistance		= 100; If we are farther than this from an enemy, use combo locomotor.
		AttackPriority				= AttackPriority_Cavalry
		SpecialContactPoints		   = Repair
	End
	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrimArcher 5
		InitialPayload = RohanPeasant 5
		Slots = 10
		PassengerFilter = ANY +INFANTRY +CAVALRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner											; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanPeasant			Pos:X:40.0 Y:0.0		; (DEFAULT) position of banner carrier for peasant horde
;		BannerCarrierPosition	= UnitType:RohanRohirrimArcher	Pos:X:-12.5 Y:0.0		; position of banner carrier for rohirrim horde
		
		; Positions for 10
		RankInfo = RankNumber:1 UnitType:RohanPeasant			Position:X:20 Y:0	Position:X:20 Y:20		Position:X:20 Y:-20		Position:X:20 Y:40		Position:X:20 Y:-40 
		RankInfo = RankNumber:2 UnitType:RohanRohirrimArcher	Position:X:-30 Y:0	Position:X:-30 Y:20		Position:X:-30 Y:-20	Position:X:-30 Y:40		Position:X:-30 Y:-40

		SplitHorde = SplitResult:RohanRohirrimArcherHorde	UnitType:RohanRohirrimArcher
		SplitHorde = SplitResult:RohanPeasantHorde			UnitType:RohanPeasant

		RanksThatStopAdvance = 1
		RanksToReleaseWhenAttacking = 1 2 
		RanksToJustFreeWhenAttacking = 1 2 
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
		SpecialPowerTemplate      = SpecialAbilitySplitHorde
	End

	; Behavior = RepairSpecialPower ModuleTag_RepairSPecialPower
	;	SpecialPowerTemplate      = SpecialRepairStructure
	; End		

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = 73
	End

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_COMBO
		Speed         = 30
	End
	
	CommandSet = RohanRohirrimArcherPeasantComboHordeCommandSet
	
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanFireArrows Upgrade_TechnologyRohanFireArrows
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 40.0
	GeometryMinorRadius = 40.0
	GeometryHeight = 20.0
	GeometryIsSmall = No	
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanRohirrimRoyalGuardComboHorde RohanRohirrimHorde

SelectPortrait = UPRohan_Army

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_7By6
		End
	End
	
	CommandPoints = 10	
	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRohirrim 5
		InitialPayload = RohanRoyalGuard 5
		Slots = 10
		PassengerFilter = ANY +INFANTRY +CAVALRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Positions for 10 (5 rohirrim, 5 royal guard)	
		RankInfo = RankNumber:1 UnitType:RohanRoyalGuard	Position:X:20 Y:0	Position:X:20 Y:20		Position:X:20 Y:-20		Position:X:20 Y:40		Position:X:20 Y:-40 
		RankInfo = RankNumber:2 UnitType:RohanRohirrim		Position:X:-20 Y:0	Position:X:-20 Y:20		Position:X:-20 Y:-20	Position:X:-20 Y:40		Position:X:-20 Y:-40

		RanksThatStopAdvance = 2
		RanksToReleaseWhenAttacking = 1 2
		RanksToJustFreeWhenAttacking = 1 2
	End

	Behavior = HordeWorkerAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building	
		AttackPriority				= 	AttackPriority_Cavalry	
		SpecialContactPoints		   = Repair
	End

	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_CAVALRY_HORDE_SPEED		
	End

	Geometry = BOX
	GeometryMajorRadius = 40.0
	GeometryMinorRadius = 40.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End

;////////////////////////////////////////////////////////////////////////////////
Object RohanArcherHorde		;YeomanArcher

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage		= BRArcheryRange_YeomanArchers
	SelectPortrait	= UPRohan_YeomanArcher

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRUYeo
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeRohanArcher
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMissileHordeRangefinder
	End
	
	CommandSet = RohanArcherHordeCommandSet

	; *** AUDIO Parameters ***
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


 	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0

	BuildCost = ROHAN_YEOMAN_BUILDCOST				
	BuildTime = ROHAN_YEOMAN_BUILDTIME				
	VisionRange = ROHAN_YEOMAN_HORDE_VISION_RANGE
	ShroudClearingRange = 161
	CommandPoints = 15
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building	
        AILuaEventsList				= InfantryFunctions  
        AttackPriority				= 	AttackPriority_Archer      
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanArcher 5
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		AlternateFormation = RohanArcherHordeSkirmishFormation

		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanArcher		Pos:X:20.0 Y:0.0		; (DEFAULT) position of banner carrier for archer horde
		
		; Positions for 5
		RandomOffset = X:6 Y:4
		RankInfo = RankNumber:1 UnitType:RohanArcher Position:X:0 Y:0	Position:X:0 Y:25		Position:X:0 Y:-25		Position:X:0 Y:50		Position:X:0 Y:-50 

		; Normal formation		
		ComboHorde = Target:RohanPeasantHorde	Result:RohanPeasantArcherComboHorde	InitiateVoice:YeomanArcherVoiceJoinPeasants
												;InitiateVoice:YeomanArcherVoiceJoinAnybody

		RanksToReleaseWhenAttacking = 1 

		; Example of Eva event for horde death
		;EvaEventLastMemberDeath = ArchersDie ; Play this Eva event when the last member dies
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil;Must be SCARY kindof as well.
		AlwaysAfraidOf				=	NONE +MordorBalrog +RohanOathbreaker +MordorSauron ;+MordorWitchKing +MordorWitchKingOnFellBeast
 		PointAt				=	NONE +MordorFellBeast +MordorWitchKingOnFellBeast 
		HeroScanDistance		=	150
		FearScanDistance		=	CAVALRY_FEAR_SCAN_RADIUS



		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=	UncontrollableFear_Base
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	
		
	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanFireArrows Upgrade_TechnologyRohanFireArrows
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End


;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanArcherHordeSkirmishFormation RohanArcherHorde
	; Note - for alternate formations, all info outside of the Contain Behavior module is ignored.
	; Any modifications need to be done via the Attribute Modifiers in the contain module.
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanArcher 5
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = No	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:7 Y:7
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanArcher	Pos:X:15.0 Y:0.0		; (DEFAULT) position of banner carrier
		
		RankInfo = RankNumber:1 UnitType:RohanArcher Position:X:0 Y:-40	Position:X:-25 Y:-25	Position:X:0 Y:0	Position:X:-25 Y:25	Position:X:0 Y:40 
		
		; Normal formation		
		ComboHorde = Target:RohanPeasantHorde	Result:RohanPeasantArcherComboHorde	InitiateVoice:YeomanArcherVoiceJoinPeasants
		
		RanksToReleaseWhenAttacking = 1
		AlternateFormation = RohanArcherHorde
		AttributeModifiers = RohanArcherSkirmish
	End
End



;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanPeasantArcherComboHorde RohanArcherHorde

SelectPortrait = UPRohan_Army

	DisplayName = OBJECT:HordeRohanPeasantArcherCombo

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_7By6
		End
	End
	
	CommandPoints = 15
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE COMBO_HORDE ARMY_SUMMARY ARCHER
	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 	
		InitialPayload = RohanPeasant 5
		InitialPayload = RohanArcher 5
		Slots = 10
		PassengerFilter = ANY +INFANTRY +CAVALRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)

		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanPeasant		Pos:X:30.0 Y:0.0		; (DEFAULT) position of banner carrier for peasant horde
;		BannerCarrierPosition	= UnitType:RohanArcher		Pos:X:-5.0 Y:0.0		; position of banner carrier for archer horde
		
		; Positions for 10 (5 archers, 5 peasant)	
		RankInfo = RankNumber:1 UnitType:RohanPeasant	Position:X:10 Y:0	Position:X:10 Y:15	Position:X:10 Y:-15	Position:X:10 Y:30	Position:X:10 Y:-30
		RankInfo = RankNumber:2 UnitType:RohanArcher	Position:X:-10 Y:0	Position:X:-10 Y:15	Position:X:-10 Y:-15	Position:X:-10 Y:30	Position:X:-10 Y:-30 


		SplitHorde = SplitResult:RohanArcherHorde	UnitType:RohanArcher
		SplitHorde = SplitResult:RohanPeasantHorde	UnitType:RohanPeasant

		RanksThatStopAdvance = 1
		RanksToReleaseWhenAttacking = 1 2 
		RanksToJustFreeWhenAttacking = 1 2 
	End

	Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
		SpecialPowerTemplate      = SpecialAbilitySplitHorde
	End

	; Behavior = RepairSpecialPower ModuleTag_RepairSPecialPower
	;	SpecialPowerTemplate      = SpecialRepairStructure
	; End		

	Behavior = HordeWorkerAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	= Yes
		MoodAttackCheckRate			= 500
		MaxCowerTime				= 5000
		MinCowerTime				= 3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
		AILuaEventsList				= InfantryFunctions  
		AttackPriority				= 	AttackPriority_Archer
		SpecialContactPoints		   = Repair
	End
	
 ;	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		;@@@MH TimeBetweenUpdates	= 3000		; Updates every 3 seconds
		;@@@MH AddEmotion			= Cheering	; Add the cheering emotion. 
		;@@@MH AddEmotion			= Cower		; Add the cower emotion	
		;@@@MH AddEmotion			= RunAwayAndPanic
		;@@@MH AddEmotion			= ThreatFromAbove
		;@@@MH AddEmotion			= Terror	
;	End		

	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED	
	End
	
	CommandSet = RohanPeasantArcherComboHordeCommandSet
	
	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanFireArrows Upgrade_TechnologyRohanFireArrows
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality4
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No	
End

;////////////////////////////////////////////////////////////////////////////////
Object RohanPeasantHorde
	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = BCFarm_Peasants
	SelectPortrait	= UPRohan_Peasant


	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRUPea
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeRohanPeasant
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End
	
	CommandSet = RohanPeasantHordeCommandSet

	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members

 	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0

	BuildCost = ROHAN_PEASANT_BUILDCOST				
	BuildTime = ROHAN_PEASANT_BUILDTIME				      
	VisionRange = ROHAN_PEASANT_VISION_RANGE 			
	CommandPoints = 10
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE DOZER ARMY_SUMMARY SWARM_DOZER ;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeWorkerAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
        AILuaEventsList				= InfantryFunctions	
        AttackPriority				= 	AttackPriority_Infantry
        SpecialContactPoints		   = Repair
	End

	Behavior = RepairSpecialPower ModuleTag_RepairSPecialPower
		SpecialPowerTemplate      = SpecialRepairStructure
	End		

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanPeasant 5
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:5 Y:5
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanPeasant		Pos:X:30.0 Y:0.0		; (DEFAULT) position of banner carrier for peasant horde
		
		; Positions for 5
		RankInfo = RankNumber:1 UnitType:RohanPeasant Position:X:0 Y:0	Position:X:0 Y:25		Position:X:0 Y:-25		Position:X:0 Y:50		Position:X:0 Y:-50 
		
		RanksToReleaseWhenAttacking = 1 

		; Normal formation		
		ComboHorde = Target:RohanRohirrimHorde			Result:RohanRohirrimPeasantComboHorde			InitiateVoice:PeasantMaleVoiceJoinHorsemen
;		ComboHorde = Target:RohanRohirrimArcherHorde	Result:RohanRohirrimArcherPeasantComboHorde		InitiateVoice:PeasantMaleVoiceJoinHorsemen
		ComboHorde = Target:RohanArcherHorde			Result:RohanPeasantArcherComboHorde				InitiateVoice:PeasantMaleVoiceJoinArchers

		; Alternate formation		
		ComboHorde = Target:RohanRohirrimHordeWedgeFormation		Result:RohanRohirrimPeasantComboHorde			InitiateVoice:PeasantMaleVoiceJoinHorsemen
;		ComboHorde = Target:RohanRohirrimArcherHordeWedgeFormation	Result:RohanRohirrimArcherPeasantComboHorde		InitiateVoice:PeasantMaleVoiceJoinHorsemen
		ComboHorde = Target:RohanArcherHordeSkirmishFormation		Result:RohanPeasantArcherComboHorde				InitiateVoice:PeasantMaleVoiceJoinArchers
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker

		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil;Must be SCARY kindof as well.
		AlwaysAfraidOf				=	NONE +MordorBalrog +RohanOathbreaker +MordorSauron ;+MordorWitchKing +MordorWitchKingOnFellBeast
 		PointAt				=	NONE +MordorFellBeast +MordorWitchKingOnFellBeast 
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS



		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=	UncontrollableFear_Base
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End	
		
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End

;////////////////////////////////////////////////////////////////////////////////
Object RohanRoyalGuardHorde

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x1
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRUHuo
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:Horde
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End
	
	CommandSet = RohanRoyalGuardHordeCommandSet


	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


	BuildCost = 50
	BuildTime = 5.0      
	VisionRange = 121
	CommandPoints = 5
		  
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
	CrushableLevel = 2  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 1 
	MinCrushVelocityPercent = 50 ; Has to be moving at at least 50% of full speed.
	CrushDecelerationPercent = 10 ; Lose 20 percent of max velocity when crushing.
	CrushKnockback = 40  ; how hard we knock back crushed units.
	CrushZFactor = 1.0  ; How much we knock upwards.
		
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT CAVALRY HORDE MELEE_HORDE ARMY_SUMMARY;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		AILuaEventsList				= CavalryFunctions  
	End

	Behavior = HorseHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanRoyalGuard 5
		Slots = 5
		PassengerFilter = NONE +CAVALRY
		ShowPips = No
		RandomOffset = X:7 Y:3
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		
		RankInfo = RankNumber:1 UnitType:RohanRoyalGuard Position:X:0 Y:0		Position:X:0 Y:20		Position:X:0 Y:-20		Position:X:0 Y:40		Position:X:0 Y:-40 

		ComboHorde = Target:RohanRohirrimHorde	Result:RohanRohirrimRoyalGuardComboHorde	InitiateVoice:RohirrimVoiceJoinAnybody
		
		RanksToReleaseWhenAttacking = 1
	End

    Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
 		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
 		TauntAndPointExcluded		=	NONE
		AfraidOf					=	NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil;Must be SCARY kindof as well.
		AlwaysAfraidOf				=	NONE +MordorBalrog +RohanOathbreaker +MordorSauron ;+MordorWitchKing +MordorWitchKingOnFellBeast
 		PointAt				=	NONE +MordorFellBeast +MordorWitchKingOnFellBeast 
 		HeroScanDistance		=	150
 		FearScanDistance		=	CAVALRY_FEAR_SCAN_RADIUS
 		
		AddEmotion			=	Terror_Base
 		AddEmotion			=	OVERRIDE Point_Base
 			Duration		=	2500
 		End
 		
 		AddEmotion			=	Taunt_Base
		AddEmotion			=	CheerIdle_Base
 		AddEmotion			=	CheerBusy_Base
 		
 		AddEmotion			=	OVERRIDE HeroCheerIdle_Base
			;StartFXList		=	RohirrimHeroCheerSound 			
 		End
 		AddEmotion			=	OVERRIDE HeroCheerBusy_Base
 			;StartFXList		=	RohirrimHeroCheerSound 			
 		End
		AddEmotion			=	Alert_Base
 		
 	End		


	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	LocomotorSet
		Locomotor     = NormalCavalryHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_CAVALRY_HORDE_SPEED		
	End

	Geometry = BOX
	GeometryMajorRadius = 12.0
	GeometryMinorRadius = 24.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End

;////////////////////////////////////////////////////////////////////////////////
;////////////////////////////////////////////////////////////////////////////////
;////////////////////////////////////////////////////////////////////////////////
;////////////////////////////////////////////////////////////////////////////////

;////////////////////////////////////////////////////////////////////////////////
Object RohanElvenWarriorHorde

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = BCElvenBarracks_ElvenWarriors
	SelectPortrait         = UPRohan_ElvenWarrior


	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_5By2
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeRohanElves
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    ElvenArcherMissileHordeRangefinder
	End
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1
		Weapon = PRIMARY	NormalMeleeHordeRangefinder
	End
	
	CommandSet = RohanElvenWarriorHordeCommandSet

	; *** AUDIO Parameters ***
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


 	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0

	BuildCost = ROHAN_ELVENWARRIOR_BUILDCOST			
	BuildTime = ROHAN_ELVENWARRIOR_BUILDTIME			
	VisionRange = ROHAN_ELVENWARRIOR_HORDE_VISION_RANGE
	ShroudClearingRange = 161
	CommandPoints = 20
		
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
        AILuaEventsList				= InfantryFunctions	
        AttackPriority				= 	AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanElvenWarrior 5
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanElvenWarrior	Pos:X:35.0 Y:0.0	; (DEFAULT) position of banner carrier for elven warrior horde
		
		; Positions for 5
		RankInfo = RankNumber:1 UnitType:RohanElvenWarrior Position:X:13 Y:0	Position:X:13 Y:25		Position:X:13 Y:-25		Position:X:13 Y:50		Position:X:13 Y:-50 
		
		RanksToReleaseWhenAttacking = 1 
		ComboHorde = Target:RohanElvenWarriorHorde		Result:RohanElvenWarriorDoubleHorde	InitiateVoice:ElvenWarriorVoiceJoinElves
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
	
	Behavior = StealthUpdate StealthUpdateModuleTag
		StealthDelay						= 500         ; msec
		FriendlyOpacityMin					= STEALTH_FRIENDLY_OPACITY_MIN
		FriendlyOpacityMax					= STEALTH_FRIENDLY_OPACITY_MAX	
		PulseFrequency						= 750   ; msec
		StealthForbiddenConditions			= AWAY_FROM_TREES ATTACKING
		OrderIdleEnemiesToAttackMeUponReveal= Yes
		DetectedByAnyoneRange				= 120
		RevealWeaponSets					= CLOSE_RANGE CONTESTING_BUILDING
		VoiceMoveToStealthyArea				= ElvenWarriorVoiceMoveForest
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil;Must be SCARY kindof as well.
		AlwaysAfraidOf				=	NONE +MordorBalrog +RohanOathbreaker +MordorSauron ;+MordorWitchKing +MordorWitchKingOnFellBeast
 		PointAt				=	NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
		HeroScanDistance		=	150
		FearScanDistance		=	ARCHER_FEAR_SCAN_RADIUS



		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=	UncontrollableFear_Base
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End			

	
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_FAST_HORDE_SPEED		
	End

	Behavior = ProductionUpdate ProductionUpdateModuleTag
		GiveNoXP = Yes
	End

	Behavior = LevelUpUpgrade ModuleTag_BasicTraining
		TriggeredBy = Upgrade_RohanBasicTraining Upgrade_TechnologyRohanBasicTraining
		RequiresAllTriggers = Yes
		LevelsToGain = 1
		LevelCap = 2
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality
		TriggeredBy = Upgrade_RohanHeavyArmor Upgrade_TechnologyRohanHeavyArmor
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality2
		TriggeredBy = Upgrade_RohanForgedBlades Upgrade_TechnologyRohanForgedBlades
		RequiresAllTriggers = Yes
	End
	
	Behavior = StatusBitsUpgrade ModuleTag_ProductionLegality3
		TriggeredBy = Upgrade_RohanFireArrows Upgrade_TechnologyRohanFireArrows
		RequiresAllTriggers = Yes
	End
	
	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End

;////////////////////////////////////////////////////////////////////////////////
ChildObject RohanElvenWarriorHorde_Summoned RohanElvenWarriorHorde
	IsTrainable = No
	CommandPoints = 0
	CommandSet = RohanElvenWarriorHordeCommandSet_Summoned
	EquivalentTo = RohanElvenWarriorHorde

	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER MELEE_HORDE SUMMONED
	
	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
	; This one displays the timer, but the one in the uint does the work 
		MinLifetime		= 180000
		MaxLifetime		= 180000
		DeathType		= FADED
	End	
	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanElvenWarrior_Summoned 5
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		
		; Banner Carrier info		
;		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
;		BannerCarrierPosition	= UnitType:RohanElvenWarrior	Pos:X:35.0 Y:0.0	; (DEFAULT) position of banner carrier for elven warrior horde
		
		; Positions for 5
		RankInfo = RankNumber:1 UnitType:RohanElvenWarrior_Summoned Position:X:13 Y:0	Position:X:13 Y:25		Position:X:13 Y:-25		Position:X:13 Y:50		Position:X:13 Y:-50 
		
		RanksToReleaseWhenAttacking = 1 
;		ComboHorde = Target:RohanElvenWarriorHorde		Result:RohanElvenWarriorDoubleHorde	InitiateVoice:ElvenWarriorVoiceJoinElves
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End
	
End

;////////////////////////////////////////////////////////////////////////////////

ChildObject RohanElvenWarriorDoubleHorde RohanElvenWarriorHorde
	
	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_5By2
		End
	End
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMissileHordeRangefinder
	End
	
	CommandSet = RohanElvenWarriorDoubleHordeCommandSet

	DisplayName = OBJECT:HordeRohanElvesCombo

	BuildCost = 1000
	BuildTime = 30.0
	VisionRange = 320
	ShroudClearingRange = SHROUD_CLEAR_STANDARD
	CommandPoints = 30
		
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY COMBO_HORDE ARCHER ;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
		AILuaEventsList				= InfantryFunctions  
		AttackPriority				= 	AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanElvenWarrior 10
		Slots = 10
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		RankSplit = Yes
		SplitHordeNumber = 5
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:RohanElvenWarrior	Pos:X:50.0 Y:0.0	; (DEFAULT) position of banner carrier for elven warrior horde
		
		; Positions for 10
		RankInfo = RankNumber:1 UnitType:RohanElvenWarrior	Position:X:30 Y:0	Position:X:30 Y:25		Position:X:30 Y:-25		Position:X:30 Y:50		Position:X:30 Y:-50  GrantedWeaponCondition:WEAPONSET_TOGGLE_1
		RankInfo = RankNumber:2 UnitType:RohanElvenWarrior	Position:X:10 Y:0	Position:X:10 Y:25		Position:X:10 Y:-25		Position:X:10 Y:50		Position:X:10 Y:-50  RevokedWeaponCondition:WEAPONSET_TOGGLE_1

		SplitHorde = SplitResult:RohanElvenWarriorHorde	UnitType:RohanElvenWarrior RankNumber:1
		SplitHorde = SplitResult:RohanElvenWarriorHorde	UnitType:RohanElvenWarrior RankNumber:2
		
		RanksToReleaseWhenAttacking = 1 2 
		MeleeAttackLeashDistance = 25; How far the hordes can move from the center of the horde when melee attacking.
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

	Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
		SpecialPowerTemplate      = SpecialAbilitySplitHorde
	End
	
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_FAST_HORDE_SPEED		
	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No

End

;////////////////////////////////////////////////////////////////////////////////
Object LAElvenWarriorHorde

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = BCElvenBarracks_ElvenWarriors
	SelectPortrait         = UPRohan_ElvenWarrior


	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_5By2
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeRohanElves
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    GoodArcherMissileHordeRangefinder
	End
	WeaponSet
		Conditions = WEAPONSET_TOGGLE_1
		Weapon = PRIMARY	NormalMeleeHordeRangefinder
	End
	
	CommandSet = RohanElvenWarriorHordeCommandSet

	; *** AUDIO Parameters ***
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


 	CrushableLevel = 0  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 0

	BuildCost = ROHAN_ELVENWARRIOR_BUILDCOST			
	BuildTime = ROHAN_ELVENWARRIOR_BUILDTIME			
	VisionRange = ROHAN_ELVENWARRIOR_HORDE_VISION_RANGE
	ShroudClearingRange = 161
	CommandPoints = 20
		
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY MELEE_HORDE;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS STEALTHED
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
        AILuaEventsList				= InfantryFunctions	
        AttackPriority				= 	AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = LAElvenWarrior 5
		Slots = 5
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		AlternateFormation = LAElvenWarriorLineFormation
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:LAElvenWarrior	Pos:X:35.0 Y:0.0	; (DEFAULT) position of banner carrier for elven warrior horde
		
		; Positions for 5
		RankInfo = RankNumber:1 UnitType:LAElvenWarrior Position:X:13 Y:0	Position:X:13 Y:25		Position:X:13 Y:-25		Position:X:13 Y:50		Position:X:13 Y:-50 
		
		RanksToReleaseWhenAttacking = 1 
	End
	
	Behavior = StealthUpdate StealthUpdateModuleTag
		StealthDelay						= 500         ; msec
		FriendlyOpacityMin					= STEALTH_FRIENDLY_OPACITY_MIN
		FriendlyOpacityMax					= STEALTH_FRIENDLY_OPACITY_MAX
		PulseFrequency						= 750   ; msec
		StealthForbiddenConditions			= AWAY_FROM_TREES ATTACKING
		OrderIdleEnemiesToAttackMeUponReveal= Yes
		DetectedByAnyoneRange				= 120
		RevealWeaponSets					= CLOSE_RANGE CONTESTING_BUILDING
		VoiceMoveToStealthyArea				= ElvenWarriorVoiceMoveForest
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
 	Behavior = EmotionTrackerUpdate	Module_EmotionTracker
		TauntAndPointDistance		=	INFANTRY_TAUNT_POINT_RADIUS		; max distance to taunted/pointed objet
		TauntAndPointUpdateDelay	=	1000	; how often scan (milliseconds)
		TauntAndPointExcluded		=	NONE
		AfraidOf					=	NONE +GondorGwaihir +RohanTreeBerd +RohanEntFir +RohanEntAsh +RohanEntBirch +MordorCaveTroll +MordorMountainTroll +MordorDrummerTroll +MordorFellBeast +MordorWitchKingOnFellBeast +MordorMumakil;Must be SCARY kindof as well.
		AlwaysAfraidOf				=	NONE +MordorBalrog +RohanOathbreaker +MordorSauron ;+MordorWitchKing +MordorWitchKingOnFellBeast
 		PointAt				=	NONE +MordorFellBeast +MordorWitchKingOnFellBeast +GondorGwaihir
		HeroScanDistance		=	150
		FearScanDistance		=	INFANTRY_FEAR_SCAN_RADIUS



		AddEmotion	=	Terror_Base
		AddEmotion	=	Doom_Base
		AddEmotion	=	UncontrollableFear_Base
		AddEmotion	=	FearIdle_Base
		AddEmotion	=	FearBusy_Base
		AddEmotion	=	Point_Base
		AddEmotion	=	Taunt_Base	
		AddEmotion	=	CheerIdle_Base
		AddEmotion	=	CheerBusy_Base
		AddEmotion	=	HeroCheerIdle_Base
		AddEmotion	=	HeroCheerBusy_Base
		AddEmotion	=	Alert_Base
	End			

	
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_FAST_HORDE_SPEED		
	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End

;////////////////////////////////////////////////////////////////////////////////

ChildObject LAElvenWarriorDoubleHorde LAElvenWarriorHorde
	
	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeTemp_5By2
		End
	End
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMissileHordeRangefinder
	End
	
	CommandSet = RohanElvenWarriorDoubleHordeCommandSet

	DisplayName = OBJECT:HordeRohanElvesCombo

	BuildCost = 1000
	BuildTime = 30.0
	VisionRange = 320
	ShroudClearingRange = SHROUD_CLEAR_STANDARD
	CommandPoints = 40
		
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 2 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARMY_SUMMARY COMBO_HORDE ;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
		AILuaEventsList				= InfantryFunctions  
		AttackPriority				= 	AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = LAElvenWarrior 10
		Slots = 10
		PassengerFilter = NONE +INFANTRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:1 Y:1
		RankSplit = Yes
		SplitHordeNumber = 5
		
		; Banner Carrier info		
		BannerCarriersAllowed	= RohanBanner										; types of units that are allowed as banner carriers
		BannerCarrierPosition	= UnitType:LAElvenWarrior	Pos:X:35.0 Y:0.0	; (DEFAULT) position of banner carrier for elven warrior horde
		
		; Positions for 10
		RankInfo = RankNumber:1 UnitType:LAElvenWarrior	Position:X:30 Y:0	Position:X:30 Y:25		Position:X:30 Y:-25		Position:X:30 Y:50		Position:X:30 Y:-50  GrantedWeaponCondition:WEAPONSET_TOGGLE_1
		RankInfo = RankNumber:2 UnitType:LAElvenWarrior	Position:X:10 Y:0	Position:X:10 Y:25		Position:X:10 Y:-25		Position:X:10 Y:50		Position:X:10 Y:-50  RevokedWeaponCondition:WEAPONSET_TOGGLE_1

		SplitHorde = SplitResult:LAElvenWarriorHorde	UnitType:LAElvenWarrior RankNumber:1
		SplitHorde = SplitResult:LAElvenWarriorHorde	UnitType:LAElvenWarrior RankNumber:2
		
		RanksToReleaseWhenAttacking = 1 2 
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End

	Behavior = SplitHordeSpecialPower ModuleTag_SplitHorde
		SpecialPowerTemplate      = SpecialAbilitySplitHorde
	End
	
	LocomotorSet
		Locomotor     = NormalMeleeHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_FAST_HORDE_SPEED		
	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No

End



;////////////////////////////////////////////////////////////////////////////////
Object RohanOathbreakerHorde

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRUOat
		End
	End
	
	SelectPortrait         = UPRohan_OathBreakers
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeOathBreakers
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    OathbreakerSword ; NormalMeleeHordeRangefinder
;		Weapon = PRIMARY    NormalMeleeHordeRangefinder
	End
	
	CommandSet = RohanOathbreakerHordeCommandSet

	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


	BuildCost = 0 ;not build just spawned
	BuildTime = 0       
	VisionRange = 500
	CommandPoints = 50 
	
	; AOD can crush anything.
	CrushableLevel = 4  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 5 
	MinCrushVelocityPercent = 0% ; Always crushes
	CrushDecelerationPercent = 0% ; Lose 0 percent of max velocity when crushing.
	CrushKnockback = 0  ; Don't knock back.
	CrushZFactor = 100.0  ; How much we knock upwards.

    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE MELEE_HORDE NO_FORMATION_MOVEMENT ARMY_OF_DEAD SCARY SUMMONED ;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		AttackPriority				= 	DefaultAttackPriority
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 45000
		MaxLifetime		= 45000
	End	

	Behavior = AODHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanOathbreaker 40
		Slots = 40
		PassengerFilter = ANY +INFANTRY +CAVALRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:0 Y:0 ; X:25 Y:25
		
		; AOD sine wave movement.
		FrequencyScale = 0.3; // how fast they move left to right.
		FrequencyRandomness = 0.3; how random - 0==no randomness, 1.0 = very random.
		AmplitudeScale = 20; how far they move left to right.
		AmplitudeRandomness = 0.4; how random - 0==no randomness, 1.0 = very random.
		StillAmplitude = 0.10; // how much they move left to right when not moving. 0==none, 1.0==full movement.

		; z movement.
		FrequencyScaleZ = 0.2; // how fast they move up&down.
		FrequencyRandomnessZ = 0.4; how random - 0==no randomness, 1.0 = very random.
		AmplitudeScaleZ = 4; how far they up and down.
		AmplitudeRandomnessZ = 0.2; how random - 0==no randomness, 1.0 = very random.
		StillAmplitudeZ = 0.15; // how much they move up & down when not moving. 0==none, 1.0==full movement.
		
		; Horde flowing up over large units it kills.
		LargeUnitHeightFactor = 0.85 ; Start with this * the object's geometry height.
		LargeUnitMinHeight = 20.0; Go up at least this amount.
		LargeUnitMaxHeight = 300.0; Go up at no more than amount.
		LargeUnitTimeout = 12000; How long the horde flows up over the unit, ms.  4000==4 seconds.
		LargeUnitTailOff = 2.0f; How quickly the units drop back to the ground.
		
		; Oath fulfilled behavior.
;E3 No up		OathFulfilledZFactor = 0.5 ; How fast they rise up after oath is fulfilled.
		ScatterSpeedFactor = 0.4; How fast they scatter.
		ScatterRandomness = 0.1; How random the scatter speed is.
		
		; Positions for 40
		RankInfo = RankNumber:1 UnitType:RohanOathbreaker	Position:X:45			Y:0	Position:X:45 Y:90		Position:X:45 Y:-45		;Position:X:45 Y:45	
		RankInfo = RankNumber:6 UnitType:RohanOathbreaker Position:X:45 Y:45	
		RankInfo = RankNumber:2 UnitType:RohanOathbreaker	Position:X:0			Y:0	Position:X:0 Y:45		Position:X:0 Y:90		;Position:X:0 Y:-45			
		RankInfo = RankNumber:7 UnitType:RohanOathbreaker Position:X:0 Y:-45	
		RankInfo = RankNumber:3 UnitType:RohanOathbreaker	Position:X:-45 Y:0	Position:X:-45 Y:45			Position:X:-45 Y:-45	;Position:X:-45 Y:90		
		RankInfo = RankNumber:8 UnitType:RohanOathbreaker Position:X:-45 Y:90	
		RankInfo = RankNumber:4 UnitType:RohanOathbreaker	Position:X:-91 Y:45	Position:X:-91 Y:-45		Position:X:-91 Y:90		;Position:X:-91 Y:0		
		RankInfo = RankNumber:9 UnitType:RohanOathbreaker Position:X:-91 Y:0	
		RankInfo = RankNumber:5 UnitType:RohanOathbreaker	Position:X:-135 Y:0	Position:X:-135 Y:45			Position:X:-135 Y:-45	Position:X:-135 Y:90		

		RankInfo = RankNumber:10 UnitType:RohanOathbreaker	Position:X:-180			Y:0	Position:X:-180 Y:90		Position:X:-180 Y:-45		;Position:X:-180 Y:45	
		RankInfo = RankNumber:15 UnitType:RohanOathbreaker Position:X:-180 Y:45	
		RankInfo = RankNumber:11 UnitType:RohanOathbreaker	Position:X:-225			Y:0	Position:X:-225 Y:45		Position:X:-225 Y:90		;Position:X:-225 Y:-45			
		RankInfo = RankNumber:16 UnitType:RohanOathbreaker Position:X:-225 Y:-45	
		RankInfo = RankNumber:12 UnitType:RohanOathbreaker	Position:X:-270 Y:0	Position:X:-270 Y:45			Position:X:-270 Y:-45	;Position:X:-270 Y:90		
		RankInfo = RankNumber:17 UnitType:RohanOathbreaker Position:X:-270 Y:90	
		RankInfo = RankNumber:13 UnitType:RohanOathbreaker	Position:X:-315 Y:45	Position:X:-315 Y:-45		Position:X:-315 Y:90		;Position:X:-315 Y:0		
		RankInfo = RankNumber:18 UnitType:RohanOathbreaker Position:X:-315 Y:0	
		RankInfo = RankNumber:14 UnitType:RohanOathbreaker	Position:X:-360 Y:0	Position:X:-360 Y:45			Position:X:-360 Y:-45	Position:X:-360 Y:90		
		; Positions for 20
		;RankInfo = RankNumber:1 UnitType:RohanOathbreaker	Position:X:45			Y:0	Position:X:45 Y:90		Position:X:45 Y:-45		;Position:X:45 Y:45	
		;RankInfo = RankNumber:6 UnitType:RohanOathbreakersCavalry Position:X:45 Y:45	
		;RankInfo = RankNumber:2 UnitType:RohanOathbreaker	Position:X:0			Y:0	Position:X:0 Y:45		Position:X:0 Y:90		;Position:X:0 Y:-45			
		;RankInfo = RankNumber:7 UnitType:RohanOathbreakersCavalry Position:X:0 Y:-45	
		;RankInfo = RankNumber:3 UnitType:RohanOathbreaker	Position:X:-45 Y:0	Position:X:-45 Y:45			Position:X:-45 Y:-45	;Position:X:-45 Y:90		
		;RankInfo = RankNumber:8 UnitType:RohanOathbreakersCavalry Position:X:-45 Y:90	
		;RankInfo = RankNumber:4 UnitType:RohanOathbreaker	Position:X:-91 Y:45	Position:X:-91 Y:-45		Position:X:-91 Y:90		;Position:X:-91 Y:0		
		;RankInfo = RankNumber:9 UnitType:RohanOathbreakersCavalry Position:X:-91 Y:0	
		;RankInfo = RankNumber:5 UnitType:RohanOathbreaker	Position:X:-135 Y:0	Position:X:-135 Y:45			Position:X:-135 Y:-45	Position:X:-135 Y:90		

		; Positions for 10
		; RankInfo = RankNumber:1 UnitType:RohanOathbreaker Position:X:10 Y:0	Position:X:10 Y:20		Position:X:10 Y:-20		Position:X:10 Y:40		Position:X:10 Y:-40 
		; RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-10 Y:0	Position:X:-10 Y:20		Position:X:-10 Y:-20	Position:X:-10 Y:40		Position:X:-10 Y:-40 
		
		RanksToReleaseWhenAttacking = 1 2 
		
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = OathbreakersFadeAwayBehavior ModuleTag_05
		FadeOutTime   = 999999 ; Hordes don't fade out, members do.
	End

  Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
  End
	

	LocomotorSet
		Locomotor     = AODHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = 65
	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 10.0
	GeometryIsSmall = No
End

;////////////////////////////////////////////////////////////////////////////////
Object RohanOathbreakerHordeSmall ; used for Aragorn's oathbreaker summon skill

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRUOat
		End
	End
	
	SelectPortrait         = UPRohan_OathBreakers
	Side = Rohan
	IsTrainable = No
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:HordeOathBreakers
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    OathbreakerSword ; NormalMeleeHordeRangefinder
	End
	
	CommandSet = RohanOathbreakerHordeSmallCommandSet

	; *** AUDIO Parameters ***;
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


	BuildCost = 700
	BuildTime = 20.0 ;5.0      
	VisionRange = 500
	CommandPoints = 7
	
	; AOD can crush anything.
	CrushableLevel = 4  ;What am I?:        0 = for infantry, 1 = for trees, 2 = general vehicles
	CrusherLevel = 5 
	MinCrushVelocityPercent = 0% ; Always crushes
	CrushDecelerationPercent = 0% ; Lose 0 percent of max velocity when crushing.
	CrushKnockback = 0  ; Don't knock back.
	CrushZFactor = 100.0  ; How much we knock upwards.

    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE NO_FORMATION_MOVEMENT ARMY_OF_DEAD SCARY SUMMONED ;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle	=	Yes ATTACK_BUILDINGS
		MoodAttackCheckRate			=	500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		AttackPriority				= 	DefaultAttackPriority
	End

	Behavior = LifetimeUpdate ModuleTag_LifetimeUpdate
		MinLifetime		= 45000
		MaxLifetime		= 45000
	End	

	Behavior = AODHordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanOathbreaker 16 ;7
		;InitialPayload = RohanOathbreakersCavalry 8
		Slots = 16 ;7
		PassengerFilter = ANY +INFANTRY +CAVALRY
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:0 Y:0 ; X:25 Y:25
		
		; AOD sine wave movement.
		FrequencyScale = 0.3; // how fast they move left to right.
		FrequencyRandomness = 0.3; how random - 0==no randomness, 1.0 = very random.
		AmplitudeScale = 20; how far they move left to right.
		AmplitudeRandomness = 0.4; how random - 0==no randomness, 1.0 = very random.
		StillAmplitude = 0.10; // how much they move left to right when not moving. 0==none, 1.0==full movement.

		; z movement.
		FrequencyScaleZ = 0.2; // how fast they move up&down.
		FrequencyRandomnessZ = 0.4; how random - 0==no randomness, 1.0 = very random.
		AmplitudeScaleZ = 4; how far they up and down.
		AmplitudeRandomnessZ = 0.2; how random - 0==no randomness, 1.0 = very random.
		StillAmplitudeZ = 0.15; // how much they move up & down when not moving. 0==none, 1.0==full movement.
		
		; Horde flowing up over large units it kills.
		LargeUnitHeightFactor = 0.85 ; Start with this * the object's geometry height.
		LargeUnitMinHeight = 20.0; Go up at least this amount.
		LargeUnitMaxHeight = 300.0; Go up at no more than amount.
		LargeUnitTimeout = 12000; How long the horde flows up over the unit, ms.  4000==4 seconds.
		LargeUnitTailOff = 2.0f; How quickly the units drop back to the ground.
		
		; Oath fulfilled behavior.
;E3 No up		OathFulfilledZFactor = 0.5 ; How fast they rise up after oath is fulfilled.
		ScatterSpeedFactor = 0.4; How fast they scatter.
		ScatterRandomness = 0.1; How random the scatter speed is.
		
		; Positions for 10
		RankInfo = RankNumber:1 UnitType:RohanOathbreaker Position:X:10 Y:0	Position:X:10 Y:30		Position:X:10 Y:-30		Position:X:10 Y:60		;Position:X:10 Y:-60 
		RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-10 Y:0	Position:X:-10 Y:30		Position:X:-10 Y:-30		Position:X:-10 Y:60		;Position:X:-10 Y:-60 
		RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-30 Y:0	Position:X:-30 Y:30		Position:X:-30 Y:-30		Position:X:-30 Y:60		;Position:X:-30 Y:-60 
		RankInfo = RankNumber:2 UnitType:RohanOathbreaker Position:X:-50 Y:0	Position:X:-50 Y:30		Position:X:-50 Y:-30		Position:X:-50 Y:60		;Position:X:-50 Y:-60 		
		RanksToReleaseWhenAttacking = 1 2 3 4
		
		;ComboHorde = Target:GondorArcherHorde Result:GondorFighterArcherComboHorde 
		;AlternateFormation = GondorFighterHordeWedge
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	Behavior = OathbreakersFadeAwayBehavior ModuleTag_05
		FadeOutTime   = 999999 ; Hordes don't fade out, members do.
	End

	Behavior = CommandButtonHuntUpdate ModuleTag_CommandButtonHuntUpdate
	End	

	LocomotorSet
		Locomotor     = AODHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = 65
	End

	Geometry = BOX
	GeometryMajorRadius = 15.0
	GeometryMinorRadius = 15.0
	GeometryHeight = 10.0
	GeometryIsSmall = No
End








;////////////////////////////////////////////////////////////////////////////////
Object RohanHobbitHorde

	; This is required for garrisoned objects - please put in all objects.
	ButtonImage = BRArcheryRange_YeomanArchers

	Draw = W3DScriptedModelDraw ModuleTag_W3DModelDraw
	    DependencySharedModelFlags = EMOTION_ALERT EMOTION_MORALE_HIGH EMOTION_MORALE_LOW EMOTION_AFRAID EMOTION_COWER SELECTED EMOTION_TERROR
		DefaultModelConditionState
			Model = None ;InvisHrdeTmp5x2
		End
		ModelConditionState = HORDE_EMPTY
			Model = None
		End		
		
		ModelConditionState = WORLD_BUILDER
			Model = HordeMarkRUYeo
		End
	End
	
	Side = Rohan
	EditorSorting = UNIT
	EmotionRange = 240
	DisplayName = OBJECT:Horde
	
	WeaponSet
		Conditions = None 
		Weapon = PRIMARY    NormalMissileHordeRangefinder
	End
	
	CommandSet = RohanHobbitHordeCommandSet

	; *** AUDIO Parameters ***
	; Note: Don't put voice parameters here -- they will be ignored. Voice play requests
	; are always passed through to members


	BuildCost = 800
	BuildTime = 25.0
	VisionRange = 300
	ShroudClearingRange = 161
	CommandPoints = 4
	
	FormationWidth = 2 ; Width it occupies in formations. Current choices are 1 or 2.
	FormationDepth = 1 ; Depth it occupies in formations. Current choices are 1 or 2.
	
    TransportSlotCount = 1
	KindOf = SELECTABLE CAN_ATTACK ATTACK_NEEDS_LINE_OF_SIGHT INFANTRY HORDE ARCHER ARMY_SUMMARY;UNATTACKABLE 
	
	Body = ImmortalBody ModuleTag_ImmortalBody
		MaxHealth = 1
	End
	
	Behavior = HordeAIUpdate ModuleTag_HordeAIUpdate
		AutoAcquireEnemiesWhenIdle = Yes ATTACK_BUILDINGS
		MoodAttackCheckRate        = 500
		MaxCowerTime				=	5000
		MinCowerTime				=	3000
		CanAttackWhileContained    = Yes  ; Can fire out of garrisoned building		
		AttackPriority				= 	AttackPriority_Archer
	End

	Behavior = HordeContain ModuleTag_HordeContain
		ObjectStatusOfContained = 
		InitialPayload = RohanFrodo 1
		InitialPayload = RohanSam 1
		InitialPayload = RohanMerry 1
		InitialPayload = RohanPippin 1
		Slots = 4
		PassengerFilter = NONE +HOBBIT
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:5 Y:5

		;LeadersAllowed = GondorArcher
		;LeaderPosition   = X:60.0 Y:0.0 Z:0.0
		;LeaderRank		= 0
		RankInfo = RankNumber:1 UnitType:RohanFrodo Position:X:20 Y:0
		RankInfo = RankNumber:2 UnitType:RohanSam Position:X:20 Y:30
		RankInfo = RankNumber:3 UnitType:RohanMerry Position:X:-15 Y:0
		RankInfo = RankNumber:4 UnitType:RohanPippin Position:X:-15 Y:30
		
		RanksToReleaseWhenAttacking = 1 2 3 4
	End

	Behavior = PhysicsBehavior ModuleTag_PhysicsBehavior
		GravityMult = 1.0
	End
	
	LocomotorSet
		Locomotor     = NormalRangedHordeLocomotor
		Condition     = SET_NORMAL
		Speed         = NORMAL_GOOD_INFANTRY_HORDE_SPEED	
	End

	Geometry = BOX
	GeometryMajorRadius = 20.0
	GeometryMinorRadius = 20.0
	GeometryHeight = 20.0
	GeometryIsSmall = No
End


ChildObject RohanHobbitHordeFrodoSam RohanHobbitHorde

  CommandPoints = 2
	
  Behavior = HordeContain ModuleTag_HordeContain
    ObjectStatusOfContained = 
		InitialPayload = RohanFrodo 1
		InitialPayload = RohanSam 1
		Slots = 2
		PassengerFilter = NONE +HOBBIT
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:5 Y:5

		;LeadersAllowed = GondorArcher
		;LeaderPosition   = X:60.0 Y:0.0 Z:0.0
		;LeaderRank		= 0
		RankInfo = RankNumber:1 UnitType:RohanFrodo Position:X:20 Y:0
		RankInfo = RankNumber:2 UnitType:RohanSam Position:X:20 Y:30
		RanksToReleaseWhenAttacking = 1 2
	End
End

ChildObject RohanHobbitHordeMerryPippin RohanHobbitHorde

  CommandPoints = 2

  Behavior = HordeContain ModuleTag_HordeContain
    ObjectStatusOfContained = 
		InitialPayload = RohanMerry 1
		InitialPayload = RohanPippin 1
		Slots = 2
		PassengerFilter = NONE +HOBBIT
		ShowPips = No
		ThisFormationIsTheMainFormation = Yes	;Used to determine which armorset to use (and anything else we want!)
		RandomOffset = X:5 Y:5

		;LeadersAllowed = GondorArcher
		;LeaderPosition   = X:60.0 Y:0.0 Z:0.0
		;LeaderRank		= 0
		RankInfo = RankNumber:1 UnitType:RohanMerry Position:X:20 Y:0
		RankInfo = RankNumber:2 UnitType:RohanPippin Position:X:20 Y:30
		RanksToReleaseWhenAttacking = 1 2
	End
End

